[
  {
    "__docId__": 0,
    "kind": "file",
    "name": "js/base/runtime.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\nimport os from 'os'\r\n\r\n// COMMON IMPORTS\r\nimport T                   from 'devapt-core-common/dist/js/utils/types'\r\nimport {SOURCE_LOCAL_FILE} from 'devapt-core-common/dist/js/datas/providers/json_provider'\r\nimport Context             from 'devapt-core-common/dist/js/base/context'\r\nimport RuntimeBase         from 'devapt-core-common/dist/js/base/runtime_base'\r\nimport topology_registry   from 'devapt-core-common/dist/js/topology/registry/index'\r\nimport {register_runtime}  from 'devapt-core-common/dist/js/base/runtime'\r\n\r\n// SERVER IMPORTS\r\nimport Transaction         from './transaction'\r\nimport Security from './security'\r\nimport * as exec from '../runtime/index'\r\n\r\n\r\nlet context = 'server/base/runtime'\r\n\r\n\r\n\r\nconst logger_console_file = 'devapt-core-common/dist/js/loggers/logger_console'\r\n\r\n/**\r\n * DEFAULT RUNTIME SETTINGS\r\n */\r\nconst default_settings = {\r\n\t'is_master':false,\r\n\t'name': null,\r\n\r\n\t'master':{\r\n\t\t'name': null,\r\n\t\t'host':'localhost',\r\n\t\t'port':5000\r\n\t},\r\n\t\r\n\t'settings_provider': {\r\n\t\t'source':SOURCE_LOCAL_FILE,\r\n\t\t'relative_path':'apps/world.json'\r\n\t}\r\n}\r\n\r\n\r\n\r\n/**\r\n * @file Runtime class - main library interface.\r\n * \r\n * @author Luc BORIES\r\n * \r\n * @license Apache-2.0\r\n */\r\nclass Runtime extends RuntimeBase\r\n{\r\n\t/**\r\n\t * Create a Runtime instance.\r\n\t * @extends RuntimeBase\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper(context)\r\n\t\t\r\n\t\t// SET DEFAULT ATTRIBUTES VALUES\r\n\t\tthis.is_server_runtime = true\r\n\t\tthis.is_master = false\r\n\t\tthis.uid = os.hostname() + '_' + process.pid\r\n\t\t\r\n\t\tthis.node = null\r\n\t\t\r\n\t\tthis.plugins_factory = undefined\r\n\t\tthis.context = new Context(this)\r\n\t\tthis.security_mgr = new Security(this, context, { 'logger_manager':this.get_logger_manager() } )\r\n\t\t\r\n\t\tthis._state_store = topology_registry\r\n\t\tthis.topology_registry = topology_registry\r\n\t\tthis.defined_world_topology = undefined\r\n\t\tthis.deployed_local_topology= undefined\r\n\r\n\t\tthis.socketio_servers = {}\r\n\t\t\r\n\t\tthis.info('Runtime is created')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get runtime node.\r\n\t * \r\n\t * @returns {Node}\r\n\t */\r\n\tget_node()\r\n\t{\r\n\t\treturn this.node\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get runtime unique identifier.\r\n\t * \r\n\t * @returns {string}\r\n\t */\r\n\tget_uid()\r\n\t{\r\n\t\treturn this.uid\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get topology runtime singleton.\r\n\t * \r\n\t * @returns {object}\r\n\t */\r\n\tget_registry()\r\n\t{\r\n\t\treturn this.topology_registry\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get defined topology runtime singleton.\r\n\t * \r\n\t * @returns {TopologyDefineWorld} - defined world topology.\r\n\t */\r\n\tget_defined_topology()\r\n\t{\r\n\t\treturn this.defined_world_topology\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get deployed topology runtime singleton.\r\n\t * \r\n\t * @returns {TopologyDeployLocalNode} - deployed local node topology.\r\n\t */\r\n\tget_deployed_topology()\r\n\t{\r\n\t\treturn this.deployed_local_topology\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load runtime settings.\r\n\t * \r\n\t * @param {object} arg_settings - runtime settings.\r\n\t * \r\n\t * @returns {object} promise\r\n\t */\r\n\tload(arg_settings)\r\n\t{\r\n\t\tconst self = this\r\n\r\n\t\t// MERGE DEFAULT AND RUNTIME SETTINGS\r\n\t\tdefault_settings.runtime = this\r\n\t\targ_settings.runtime = this\r\n\t\tthis.$settings = fromJS( Object.assign(default_settings, arg_settings) )\r\n\t\t// console.log(context + ':load:runtime.$settings', this.$settings)\r\n\r\n\t\t// SET DEFAULT LOGGER\r\n\t\tconst trace_stages_enabled = this.$settings.getIn(['trace', 'stages', 'enabled'], false)\r\n\t\tlet console_logger_index = undefined\r\n\t\tlet console_logger_uid = undefined\r\n\t\tif ( trace_stages_enabled )\r\n\t\t{\r\n\t\t\tconst LoggerConsole = require(logger_console_file).default\r\n\r\n\t\t\t// console.log(context + ':load:add console logger')\r\n\t\t\t\r\n\t\t\tconst console_settings = {\r\n\t\t\t\tenabled:true\r\n\t\t\t}\r\n\t\t\tconst logger = new LoggerConsole(true, console_settings)\r\n\t\t\tconsole_logger_uid = logger.uid\r\n\t\t\tthis._logger_manager.loggers.push(logger)\r\n\t\t\tconsole_logger_index = this._logger_manager.loggers.length - 1\r\n\t\t\t// console.log(context + ':load:add console logger index=' + console_logger_index)\r\n\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\r\n\t\t// TRACES ARE ACTIVE IF ENABLED\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('load')\r\n\t\t\r\n\t\tthis.is_master = this.get_setting('is_master', false)\r\n\t\t// console.log(context + ':load:is_master', this.is_master)\r\n\t\t\r\n\t\tconst stage0 = new exec.RuntimeStage0Executable(this._logger_manager)\r\n\t\tconst stage1 = new exec.RuntimeStage1Executable(this._logger_manager)\r\n\t\tconst stage2 = new exec.RuntimeStage2Executable(this._logger_manager)\r\n\t\tconst stage3 = new exec.RuntimeStage3Executable(this._logger_manager)\r\n\t\tconst execs = [stage0, stage1, stage2, stage3]\r\n\r\n\t\tconst tx = new Transaction('runtime', 'startup', 'loading', { runtime:this, logger_manager:this._logger_manager }, execs, Transaction.SEQUENCE)\r\n\t\t// console.log(context + ':load:before tx new')\r\n\r\n\t\ttx.prepare({runtime:this, logger_manager:this._logger_manager})\r\n\t\t// console.log(context + ':load:after tx prepare')\r\n\r\n\t\tconst tx_promise = tx.execute(null)\r\n\t\t// console.log(context + ':load:after tx execute')\r\n\r\n\t\tif (console_logger_index >= 0)\r\n\t\t{\r\n\t\t\t// console.log(context + ':load:remove runtime loading console logger')\r\n\t\t\ttx_promise.then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tif (self.get_logger_manager().loggers.length > console_logger_index && self.get_logger_manager().loggers[console_logger_index].get_uid() == console_logger_uid)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.log(context + ':load:remove console logger at ' + console_logger_index)\r\n\t\t\t\t\t\tself.get_logger_manager().loggers.splice(console_logger_index, 1)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('load')\r\n\t\tthis.separate_level_1()\r\n\t\treturn tx_promise\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Get security object.\r\n\t * @returns {Security}\r\n\t */\r\n\tsecurity()\r\n\t{\r\n\t\tassert( T.isObject(this.security_mgr) && this.security_mgr.is_security, context + ':bad security object')\r\n\t\treturn this.security_mgr\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get plugins factory object.\r\n\t * @returns {PluginsFactory}\r\n\t */\r\n\tget_plugins_factory()\r\n\t{\r\n\t\tassert( T.isObject(this.plugins_factory) && this.plugins_factory.is_plugins_factory, context + ':bad plugins factory object')\r\n\t\treturn this.plugins_factory\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Register and configure a socketio server.\r\n\t * \r\n\t * @param {string} arg_server_name - bound server name.\r\n\t * @param {object} arg_socketio - socketio server.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tadd_socketio(arg_server_name, arg_socketio)\r\n\t{\r\n\t\tconst self = this\r\n\t\tassert( T.isString(arg_server_name), context + ':add_socketio:bad server name')\r\n\t\tassert( T.isObject(arg_socketio) && arg_socketio.emit && arg_socketio.on, context + ':add_socketio:bad socketio server')\r\n\t\t\r\n\t\tself.socketio_servers[arg_server_name] = arg_socketio\r\n\t\t\r\n\t\targ_socketio.on('connection',\r\n\t\t\tfunction (socket)\r\n\t\t\t{\r\n\t\t\t\tconsole.info(context + ':add_socketio:new connection on /')\r\n\t\t\t\t\r\n\t\t\t\t// ROOT\r\n\t\t\t\tsocket.on('disconnect',\r\n\t\t\t\t\tfunction()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.info(context + ':add_socketio:new disconnection on /')\r\n\t\t\t\t\t\tself.on_socketio_disconnect()\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t\r\n\t\t\t\tself.on_socketio_connect(arg_socketio, socket)\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * On socketio server connect event.\r\n\t * @param {object} arg_socketio - socketio server.\r\n\t * @param {object} arg_socket - client socket.\r\n\t * @returns {nothing}\r\n\t */\r\n\ton_socketio_connect(arg_socketio, arg_socket)\r\n\t{\r\n\t\tassert( T.isObject(arg_socketio) && arg_socketio.emit && arg_socketio.on, context + ':on_socketio_connect:bad socketio server')\r\n\t\tassert( T.isObject(arg_socket) && arg_socket.emit && arg_socket.on, context + ':on_socketio_connect:bad socketio socket client')\r\n\r\n\t\t// const self = this\r\n\t\tconsole.info(context + ':on_socketio_connect:socket connected')\r\n\t\t\r\n\t\targ_socket.emit('welcome on /', { from: 'server runtime' })\r\n\t\t\r\n\t\t// ON PING\r\n\t\t// arg_socket.on('ping',\r\n\t\t// \tfunction(data)\r\n\t\t// \t{\r\n\t\t// \t\tconsole.info(context + ':on_socketio_connect:socket receives ping', data)\r\n\t\t// \t\targ_socket.emit('pong', { from: 'server runtime' })\r\n\t\t// \t}\r\n\t\t// )\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * On socketio server disconnect event.\r\n\t * @returns {nothing}\r\n\t */\r\n\ton_socketio_disconnect()\r\n\t{\r\n\t\tconsole.info(context + ':on_socketio_disconnect:socket disconnected')\r\n\t}\r\n}\r\n\r\n\r\nlet runtime_singleton = new Runtime()\r\nregister_runtime(runtime_singleton)\r\n\r\nexport default runtime_singleton\r\n",
    "static": true,
    "longname": "js/base/runtime.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 1,
    "kind": "variable",
    "name": "context",
    "memberof": "js/base/runtime.js",
    "static": true,
    "longname": "js/base/runtime.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/runtime.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 2,
    "kind": "variable",
    "name": "logger_console_file",
    "memberof": "js/base/runtime.js",
    "static": true,
    "longname": "js/base/runtime.js~logger_console_file",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/runtime.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 3,
    "kind": "variable",
    "name": "default_settings",
    "memberof": "js/base/runtime.js",
    "static": true,
    "longname": "js/base/runtime.js~default_settings",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/runtime.js",
    "importStyle": null,
    "description": "DEFAULT RUNTIME SETTINGS",
    "lineNumber": 29,
    "type": {
      "types": [
        "{\"is_master\": *, \"name\": *, \"master\": *, \"settings_provider\": *}"
      ]
    }
  },
  {
    "__docId__": 4,
    "kind": "class",
    "name": "Runtime",
    "memberof": "js/base/runtime.js",
    "static": true,
    "longname": "js/base/runtime.js~Runtime",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/base/runtime.js",
    "importStyle": null,
    "description": "",
    "lineNumber": 54,
    "pseudoExport": true,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Runtime class - main library interface."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/runtime_base~RuntimeBase"
    ]
  },
  {
    "__docId__": 5,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#constructor",
    "access": null,
    "description": "Create a Runtime instance.",
    "lineNumber": 62,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "RuntimeBase"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 6,
    "kind": "member",
    "name": "is_server_runtime",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#is_server_runtime",
    "access": null,
    "description": null,
    "lineNumber": 67,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 7,
    "kind": "member",
    "name": "is_master",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#is_master",
    "access": null,
    "description": null,
    "lineNumber": 68,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 8,
    "kind": "member",
    "name": "uid",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#uid",
    "access": null,
    "description": null,
    "lineNumber": 69,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 9,
    "kind": "member",
    "name": "node",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#node",
    "access": null,
    "description": null,
    "lineNumber": 71,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 10,
    "kind": "member",
    "name": "plugins_factory",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#plugins_factory",
    "access": null,
    "description": null,
    "lineNumber": 73,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 11,
    "kind": "member",
    "name": "context",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#context",
    "access": null,
    "description": null,
    "lineNumber": 74,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 12,
    "kind": "member",
    "name": "security_mgr",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#security_mgr",
    "access": null,
    "description": null,
    "lineNumber": 75,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 13,
    "kind": "member",
    "name": "_state_store",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#_state_store",
    "access": null,
    "description": null,
    "lineNumber": 77,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 14,
    "kind": "member",
    "name": "topology_registry",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#topology_registry",
    "access": null,
    "description": null,
    "lineNumber": 78,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 15,
    "kind": "member",
    "name": "defined_world_topology",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#defined_world_topology",
    "access": null,
    "description": null,
    "lineNumber": 79,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 16,
    "kind": "member",
    "name": "deployed_local_topology",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#deployed_local_topology",
    "access": null,
    "description": null,
    "lineNumber": 80,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 17,
    "kind": "member",
    "name": "socketio_servers",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#socketio_servers",
    "access": null,
    "description": null,
    "lineNumber": 82,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 18,
    "kind": "method",
    "name": "get_node",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_node",
    "access": null,
    "description": "Get runtime node.",
    "lineNumber": 94,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Node"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 19,
    "kind": "method",
    "name": "get_uid",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_uid",
    "access": null,
    "description": "Get runtime unique identifier.",
    "lineNumber": 106,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 20,
    "kind": "method",
    "name": "get_registry",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_registry",
    "access": null,
    "description": "Get topology runtime singleton.",
    "lineNumber": 118,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 21,
    "kind": "method",
    "name": "get_defined_topology",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_defined_topology",
    "access": null,
    "description": "Get defined topology runtime singleton.",
    "lineNumber": 130,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{TopologyDefineWorld} - defined world topology."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "TopologyDefineWorld"
      ],
      "spread": false,
      "description": "defined world topology."
    }
  },
  {
    "__docId__": 22,
    "kind": "method",
    "name": "get_deployed_topology",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_deployed_topology",
    "access": null,
    "description": "Get deployed topology runtime singleton.",
    "lineNumber": 142,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{TopologyDeployLocalNode} - deployed local node topology."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "TopologyDeployLocalNode"
      ],
      "spread": false,
      "description": "deployed local node topology."
    }
  },
  {
    "__docId__": 23,
    "kind": "method",
    "name": "load",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#load",
    "access": null,
    "description": "Load runtime settings.",
    "lineNumber": 156,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} promise"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "runtime settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "promise"
    }
  },
  {
    "__docId__": 24,
    "kind": "member",
    "name": "$settings",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#$settings",
    "access": null,
    "description": null,
    "lineNumber": 163,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 25,
    "kind": "member",
    "name": "is_master",
    "memberof": "js/base/runtime.js~Runtime",
    "static": false,
    "longname": "js/base/runtime.js~Runtime#is_master",
    "access": null,
    "description": null,
    "lineNumber": 192,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 26,
    "kind": "method",
    "name": "security",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#security",
    "access": null,
    "description": "Get security object.",
    "lineNumber": 235,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Security}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Security"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 27,
    "kind": "method",
    "name": "get_plugins_factory",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#get_plugins_factory",
    "access": null,
    "description": "Get plugins factory object.",
    "lineNumber": 246,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{PluginsFactory}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "PluginsFactory"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 28,
    "kind": "method",
    "name": "add_socketio",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#add_socketio",
    "access": null,
    "description": "Register and configure a socketio server.",
    "lineNumber": 262,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_server_name",
        "description": "bound server name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socketio",
        "description": "socketio server."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 29,
    "kind": "method",
    "name": "on_socketio_connect",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#on_socketio_connect",
    "access": null,
    "description": "On socketio server connect event.",
    "lineNumber": 296,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socketio",
        "description": "socketio server."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socket",
        "description": "client socket."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 30,
    "kind": "method",
    "name": "on_socketio_disconnect",
    "memberof": "js/base/runtime.js~Runtime",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/runtime.js~Runtime#on_socketio_disconnect",
    "access": null,
    "description": "On socketio server disconnect event.",
    "lineNumber": 321,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 31,
    "kind": "variable",
    "name": "runtime_singleton",
    "memberof": "js/base/runtime.js",
    "static": true,
    "longname": "js/base/runtime.js~runtime_singleton",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/base/runtime.js",
    "importStyle": "runtime_singleton",
    "description": null,
    "lineNumber": 331,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "js/base/runtime.js~Runtime"
      ]
    }
  },
  {
    "__docId__": 32,
    "kind": "file",
    "name": "js/base/security.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\nimport T         from 'devapt-core-common/dist/js/utils/types'\r\nimport Errorable from 'devapt-core-common/dist/js/base/errorable'\r\n\r\n// SERVER IMPORTS\r\nimport AuthenticationManager from '../security/authentication_manager'\r\nimport AuthorizationManager from '../security/authorization_manager'\r\n\r\n\r\nconst context = 'server/base/security'\r\n\r\n\r\n\r\n/**\r\n * @file Security class - main security features wrapper.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class Security extends Errorable\r\n{\r\n\t/**\r\n\t * Create a Security instance.\r\n\t * @extends Errorable\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime.\r\n\t * @param {string} arg_log_context - trace logging context string.\r\n\t * @param {object} arg_settings - runtime settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_log_context, arg_settings)\r\n\t{\r\n\t\tconst logger_manager = (arg_settings && arg_settings.logger_manager) ? arg_settings.logger_manager : undefined\r\n\t\tsuper(arg_log_context ? arg_log_context : context, logger_manager)\r\n\t\t\r\n\t\tthis.is_security = true\r\n\t\t\r\n\t\tthis.authentication_manager = new AuthenticationManager(arg_runtime, context + '.authentication', logger_manager)\r\n\t\tthis.authorization_manager = new AuthorizationManager(arg_runtime, context + '.authorization', logger_manager)\r\n\t\t\r\n\t\tif (arg_settings)\r\n\t\t{\r\n\t\t\tconst logger_manager_only = Object.keys(arg_settings).length == 1 && arg_settings.logger_manager\r\n\t\t\tif ( ! logger_manager_only)\r\n\t\t\t{\r\n\t\t\t\tif ( ! arg_settings.has )\r\n\t\t\t\t{\r\n\t\t\t\t\targ_settings = fromJS(arg_settings)\r\n\t\t\t\t}\r\n\t\t\t\tthis.load(arg_settings)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security settings.\r\n\t * \r\n\t * @param {object} arg_settings - runtime settings (Immutable object).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload(arg_settings)\r\n\t{\r\n\t\tthis.enter_group('load')\r\n\t\t// this.debug('settings', arg_settings)\r\n\r\n\t\t// console.log(context + '.load:arg_settings', arg_settings)\r\n\t\t\r\n\t\tassert(T.isObject(arg_settings), context + ':bad settings object')\r\n\t\tassert(T.isFunction(arg_settings.has), context + ':bad settings immutable')\r\n\t\tassert(arg_settings.has('authentication'), context + ':bad settings.authentication')\r\n\t\tassert(arg_settings.has('authorization'), context + ':bad settings.authorization')\r\n\t\t\r\n\t\tconst authentication = arg_settings.get('authentication')\r\n\t\tconst authorization = arg_settings.get('authorization')\r\n\t\t\r\n\t\tthis.is_readonly = arg_settings.get('is_readonly')\r\n\t\t\r\n\t\tthis.authentication_manager.load(authentication)\r\n\t\tthis.authorization_manager.load(authorization)\r\n\t\t/*\r\n\t\t\r\n\t\t\tTODO\r\n\t\t\thttps://gist.github.com/danwit/e0a7c5ad57c9ce5659d2\r\n\t\t\thttps://github.com/OptimalBits/node_acl\r\n\t\t\thttp://www.hamiltonchapman.com/blog/2014/3/25/user-accounts-using-sequelize-and-passport-in-nodejs\r\n\t\t*/\r\n\r\n\t\tthis.leave_group('load')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get authentication plugins manager.\r\n\t * \r\n\t * @returns {object} - a PluginsManager instance\r\n\t */\r\n\tget_authentication_manager()\r\n\t{\r\n\t\treturn this.authentication_manager\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get authorization plugins manager.\r\n\t * \r\n\t * @returns {object} - a PluginsManager instance.\r\n\t */\r\n\tget_authorization_manager()\r\n\t{\r\n\t\treturn this.authorization_manager\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get authentication plugins manager.\r\n\t * \r\n\t * @returns {object} - a PluginsManager instance.\r\n\t */\r\n\tauthentication()\r\n\t{\r\n\t\tassert( T.isObject(this.authentication_manager) && this.authentication_manager.is_authentication_manager, context + ':bad authentication_manager object')\r\n\t\treturn this.authentication_manager\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with giving credentials.\r\n\t * \r\n\t * @param {Credentials} arg_credentials - credentials object.\r\n\t * \r\n\t * @returns {Promise} - a promise of boolean.\r\n\t */\r\n\tauthenticate(arg_credentials)\r\n\t{\r\n\t\tthis.enter_group('authenticate')\r\n\t\t\r\n\t\tconst auth_mgr = this.authentication()\r\n\t\t\r\n\t\tlet promise = Promise.resolve(true)\r\n\t\tif (auth_mgr.authentication_is_enabled)\r\n\t\t{\r\n\t\t\tpromise = auth_mgr.authenticate(arg_credentials)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('authenticate')\r\n\t\treturn promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get authorization plugins manager.\r\n\t * \r\n\t * @returns {object} - a PluginsManager instance.\r\n\t */\r\n\tauthorization()\r\n\t{\r\n\t\tassert( T.isObject(this.authorization_manager) && this.authorization_manager.is_authorization_manager, context + ':bad authorization_manager object')\r\n\t\treturn this.authorization_manager\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with giving credentials.\r\n\t * \r\n\t * @param {object} arg_permission - permission plain object.\r\n\t * @param {object} arg_credentials - credentials object.\r\n\t * \r\n\t * @returns {Promise} - a promise of boolean.\r\n\t */\r\n\tauthorize(arg_permission, arg_credentials)\r\n\t{\r\n\t\tthis.enter_group('authorize')\r\n\t\t\r\n\t\tconst auth_mgr = this.authorization()\r\n\r\n\t\tlet promise = Promise.resolve(true)\r\n\t\tif (auth_mgr.authorization_is_enabled)\r\n\t\t{\r\n\t\t\tpromise = auth_mgr.authorize(arg_permission, arg_credentials)\r\n\t\t}\r\n\r\n\t\t// const promise = this.authorization().authorize(arg_permission, arg_credentials)\r\n\t\t\r\n\t\tthis.leave_group('authorize')\r\n\t\treturn promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\t// PREDEFINED ERRORS\r\n\t\r\n\t/**\r\n\t * Error wrapper - on bad user.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_user()\r\n\t{\r\n\t\tthis.error('bad user')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - on bad credentials.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_credentials()\r\n\t{\r\n\t\tthis.error('bad credentials')\r\n\t}\r\n}\r\n\r\n/*\r\n\tEXAMPLE OF CONFIGURATION\r\n\t\r\n\t\"security\":{\r\n\t\t\"is_readonly\":false,\r\n\t\t\r\n\t\t\"connexions\":[\"connexions.json\"],\r\n\t\t\r\n\t\t\"authentication\": {\r\n\t\t\t\"enabled\":true,\r\n\t\t\t\r\n\t\t\t\"expiration\":60,\r\n\t\t\t\"secret\":\"APPPPPPP449++((éç(à\",\r\n\t\t\t\r\n\t\t\t\"mode\":\"database\",\r\n\t\t\t\"model\":\"MODEL_AUTH_USERS\",\r\n\t\t\t\"username\":\"login\",\r\n\t\t\t\"password\":\"password\",\r\n\t\t\t\r\n\t\t\t\"alt\": {\r\n\t\t\t\t\"mode\":\"jsonfile\",\r\n\t\t\t\t\"file\":\"users.json\",\r\n\t\t\t\t\r\n\t\t\t\t\"login\":\"demo\",\r\n\t\t\t\t\"password\":\"demo\"\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t\"authorization\": {\r\n\t\t\t\"enabled\":true,\r\n\t\t\t\"mode\":\"database\",\r\n\t\t\t\r\n\t\t\t\"model\":\"MODEL_AUTH_USERS_ROLES\",\r\n\t\t\t\"role\":\"label\",\r\n\t\t\t\"username\":\"users_login\",\r\n\t\t\t\r\n\t\t\t\"alt\": {\r\n\t\t\t\t\"mode\":\"jsonfile\",\r\n\t\t\t\t\"file\":\"users.json\"\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t\"roles\":{\r\n\t\t\t\t\"*\": {\r\n\t\t\t\t\t\"list_resources\":\"ROLE_RESOURCES_LIST\",\r\n\t\t\t\t\t\"get_resource\":\"ROLE_RESOURCE_GET\"\r\n\t\t\t\t},\r\n\t\t\t\t\"views\": {\r\n\t\t\t\t\t\"list_resources\":\"ROLE_RESOURCES_LIST\",\r\n\t\t\t\t\t\"get_resource\":\"ROLE_RESOURCE_GET\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n*/\r\n\r\n\r\n/*\r\n\tAUTHENTICATION\r\n\t\r\n\t\t\"authentication\": {\r\n\t\t\t\"enabled\":true,\r\n\t\t\t\r\n\t\t\t\"expiration\":60,\r\n\t\t\t\"secret\":\"APPPPPPP449++((éç(à\",\r\n\t\t\t\r\n\t\t\t\"mode\":\"database\",\r\n\t\t\t\"model\":\"MODEL_AUTH_USERS\",\r\n\t\t\t\"username\":\"login\",\r\n\t\t\t\"password\":\"password\",\r\n\t\t\t\r\n\t\t\t\"alt\": {\r\n\t\t\t\t\"mode\":\"jsonfile\",\r\n\t\t\t\t\"file\":\"users.json\",\r\n\t\t\t\t\r\n\t\t\t\t\"login\":\"demo\",\r\n\t\t\t\t\"password\":\"demo\"\r\n\t\t\t}\r\n\t\t},\r\n\t\r\n\t\"authentication\":\r\n\t\tmandatories:\"enabled\", \"mode\"\r\n\t\tmode:\r\n\t\t\tdatabase:\r\n\t\t\t\tmodel:mandatory\r\n\t\t\t\tusername:mandatory\r\n\t\t\t\tpassword:mandatory\r\n\t\t\tjsonfile:\r\n\t\t\t\tfile:mandatory\r\n\t\t\t\tusername:mandatory\r\n\t\t\t\tpassword:mandatory\r\n\t\t\r\n*/",
    "static": true,
    "longname": "js/base/security.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 33,
    "kind": "variable",
    "name": "context",
    "memberof": "js/base/security.js",
    "static": true,
    "longname": "js/base/security.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/security.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 34,
    "kind": "class",
    "name": "Security",
    "memberof": "js/base/security.js",
    "static": true,
    "longname": "js/base/security.js~Security",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/base/security.js",
    "importStyle": "Security",
    "description": "",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Security class - main security features wrapper."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/errorable~Errorable"
    ]
  },
  {
    "__docId__": 35,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#constructor",
    "access": null,
    "description": "Create a Security instance.",
    "lineNumber": 35,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Errorable"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace logging context string."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "runtime settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 36,
    "kind": "member",
    "name": "is_security",
    "memberof": "js/base/security.js~Security",
    "static": false,
    "longname": "js/base/security.js~Security#is_security",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 37,
    "kind": "member",
    "name": "authentication_manager",
    "memberof": "js/base/security.js~Security",
    "static": false,
    "longname": "js/base/security.js~Security#authentication_manager",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 38,
    "kind": "member",
    "name": "authorization_manager",
    "memberof": "js/base/security.js~Security",
    "static": false,
    "longname": "js/base/security.js~Security#authorization_manager",
    "access": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 39,
    "kind": "method",
    "name": "load",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#load",
    "access": null,
    "description": "Load security settings.",
    "lineNumber": 67,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "runtime settings (Immutable object)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 40,
    "kind": "member",
    "name": "is_readonly",
    "memberof": "js/base/security.js~Security",
    "static": false,
    "longname": "js/base/security.js~Security#is_readonly",
    "access": null,
    "description": null,
    "lineNumber": 82,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 41,
    "kind": "method",
    "name": "get_authentication_manager",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#get_authentication_manager",
    "access": null,
    "description": "Get authentication plugins manager.",
    "lineNumber": 104,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a PluginsManager instance"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a PluginsManager instance"
    }
  },
  {
    "__docId__": 42,
    "kind": "method",
    "name": "get_authorization_manager",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#get_authorization_manager",
    "access": null,
    "description": "Get authorization plugins manager.",
    "lineNumber": 116,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a PluginsManager instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a PluginsManager instance."
    }
  },
  {
    "__docId__": 43,
    "kind": "method",
    "name": "authentication",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#authentication",
    "access": null,
    "description": "Get authentication plugins manager.",
    "lineNumber": 128,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a PluginsManager instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a PluginsManager instance."
    }
  },
  {
    "__docId__": 44,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#authenticate",
    "access": null,
    "description": "Authenticate a user with giving credentials.",
    "lineNumber": 143,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of boolean."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Credentials"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "credentials object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of boolean."
    }
  },
  {
    "__docId__": 45,
    "kind": "method",
    "name": "authorization",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#authorization",
    "access": null,
    "description": "Get authorization plugins manager.",
    "lineNumber": 166,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a PluginsManager instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a PluginsManager instance."
    }
  },
  {
    "__docId__": 46,
    "kind": "method",
    "name": "authorize",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#authorize",
    "access": null,
    "description": "Authenticate a user with giving credentials.",
    "lineNumber": 182,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of boolean."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_permission",
        "description": "permission plain object."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "credentials object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of boolean."
    }
  },
  {
    "__docId__": 47,
    "kind": "method",
    "name": "error_bad_user",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#error_bad_user",
    "access": null,
    "description": "Error wrapper - on bad user.",
    "lineNumber": 210,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 48,
    "kind": "method",
    "name": "error_bad_credentials",
    "memberof": "js/base/security.js~Security",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/security.js~Security#error_bad_credentials",
    "access": null,
    "description": "Error wrapper - on bad credentials.",
    "lineNumber": 221,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 49,
    "kind": "file",
    "name": "js/base/transaction.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T         from 'devapt-core-common/dist/js/utils/types'\r\nimport Instance  from 'devapt-core-common/dist/js/base/instance'\r\n\r\n// SERVER INSTANCE\r\nimport MetricDuration from '../metrics/metric_duration'\r\n\r\n\r\nconst context = 'common/base/transaction'\r\n\r\n\r\n\r\nconst TYPE_SEQUENCE  = 'SEQUENCE'\r\nconst TYPE_EVERY  = 'EVERY'\r\nconst TYPE_ONE  = 'ONE'\r\n\r\nconst STATUS_CREATED  = 'CREATED'\r\nconst STATUS_PREPARED = 'PREPARED'\r\nconst STATUS_EXEC_OK  = 'EXEC_OK'\r\nconst STATUS_EXEC_KO  = 'EXEC_KO'\r\n\r\n\r\n\r\n/**\r\n * @file Transaction class to manage grouped executions with commit/rollback features.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class Transaction extends Instance\r\n{\r\n\t/**\r\n\t * Create a Transaction. Set status to CREATED.\r\n\t * @extends Instance\r\n\t * @param {string} arg_app_name - application name.\r\n\t * @param {string} arg_svc_name - service name.\r\n\t * @param {string} arg_tx_name - transaction name.\r\n\t * @param {object} arg_settings - settings\r\n\t * @param {Array} arg_executables - executables array (optional)\r\n\t * @param {string} arg_type - transaction type (optional)\r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_app_name, arg_svc_name, arg_tx_name, arg_settings, arg_executables, arg_type)\r\n\t{\r\n\t\tsuper('transactions', 'Transaction', arg_tx_name, arg_settings, context)\r\n\t\t\r\n\t\tthis.is_transaction = true\r\n\t\t\r\n\t\tif (arg_executables)\r\n\t\t{\r\n\t\t\tthis.set_executables(arg_executables)\r\n\t\t}\r\n\t\t\r\n\t\tthis.set_type(arg_type)\r\n\t\t\r\n\t\tthis.metric_duration = new MetricDuration() \r\n\t\tthis.metrics = [this.metric_duration]\r\n\t\t// this.metrics = []\r\n\t\t\r\n\t\tthis.status = STATUS_CREATED\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Set transaction executables.\r\n\t * @param {Array} arg_executables - executables instances array.\r\n\t * @returns {nothing}\r\n\t */\r\n\tset_executables(arg_executables)\r\n\t{\r\n\t\t// ASSUME AN ARRAY\r\n\t\tthis.executables = T.isArray(arg_executables) ? arg_executables : [arg_executables]\r\n\t\t\r\n\t\t// CHECK ARRAY ITEMS\r\n\t\tthis.executables.forEach(\r\n\t\t\t(executable, index) => {\r\n\t\t\t\tassert( T.isObject(executable) && executable.is_executable, context + ':bad executable type at [' + index + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Set the transaction type. Value should be choosen from the list:EVERY,SEQUENCE,ONE\r\n\t *\t  * EVERY: transaction is finished when all executables are finished without order.\r\n\t *\t  * SEQUENCE: transaction is finished when all executables are finished in a ordered sequence.\r\n\t *\t  * ONE: transaction is finished when an executable finished without waiting other executables.\r\n\t * @param {string} arg_type - transaction type value.\r\n\t * @returns {nothing}\r\n\t */\r\n\tset_type(arg_type)\r\n\t{\r\n\t\tif ( ! T.isString(arg_type) )\r\n\t\t{\r\n\t\t\targ_type = TYPE_EVERY\r\n\t\t}\r\n\t\t\r\n\t\tswitch(arg_type)\r\n\t\t{\r\n\t\t\tcase TYPE_EVERY:\tthis.tx_type = TYPE_EVERY; return\r\n\t\t\tcase TYPE_ONE:\t    this.tx_type = TYPE_ONE; return\r\n\t\t\tcase TYPE_SEQUENCE: this.tx_type = TYPE_SEQUENCE; return\r\n\t\t}\r\n\t\t\r\n\t\tthis.tx_type = TYPE_EVERY\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Prepare transaction executables. Change status to PREPARED.\r\n\t * @param {object} arg_context - executables context.\r\n\t * @returns {nothing}\r\n\t */\r\n\tprepare(arg_context)\r\n\t{\r\n\t\tthis.metrics.forEach( (metric)=>{ metric.before() } )\r\n\t\t\r\n\t\tthis.executables.forEach(\r\n\t\t\t(executable) => {\r\n\t\t\t\texecutable.prepare(arg_context)\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.results = []\r\n\t\tthis.status = STATUS_PREPARED\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Execute all executables regarding the transaction type.\r\n\t * @param {anything} arg_data - any parameter\r\n\t * @returns {Promise} - a promise of executables results array\r\n\t */\r\n\texecute(arg_data)\r\n\t{\r\n\t\tswitch(this.tx_type)\r\n\t\t{\r\n\t\t\tcase TYPE_EVERY: {\r\n\t\t\t\treturn this.execute_every(arg_data)\r\n\t\t\t}\r\n\t\t\tcase TYPE_ONE: {\r\n\t\t\t\treturn this.execute_one(arg_data)\r\n\t\t\t}\r\n\t\t\tcase TYPE_SEQUENCE: {\r\n\t\t\t\treturn this.execute_sequence(arg_data)\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve(false)\r\n\t\t// return Promise.reject('bad transaction type')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Execute every executables without order and fails if one failure appears.\r\n\t * @param {anything} arg_data - any parameter\r\n\t * @returns {Promise} - a promise of executables results array\r\n\t */\r\n\texecute_every(arg_data)\r\n\t{\r\n\t\tconst self = this\r\n\t\tlet index = 0\r\n\t\tthis.metric_duration.before()\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet tx_promises = []\r\n\t\t\tthis.executables.forEach(\r\n\t\t\t\t(executable) => {\r\n\t\t\t\t\tlet exec_promise = executable.execute(arg_data)\r\n\t\t\t\t\ttx_promises.push(exec_promise)\r\n\t\t\t\t\t\r\n\t\t\t\t\texec_promise.then(\r\n\t\t\t\t\t\tfunction(value)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlet has_error = executable.has_error()\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.results.push(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tindex:index,\r\n\t\t\t\t\t\t\t\t\tresult:value,\r\n\t\t\t\t\t\t\t\t\thas_error:has_error,\r\n\t\t\t\t\t\t\t\t\terror_msg:executable.get_error_msg()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.metrics.forEach( (metric)=>{ metric.iteration() } )\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (has_error)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\tindex++\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\tlet all_promise = Promise.all(tx_promises).then(\r\n\t\t\t\tfunction(results)\r\n\t\t\t\t{\r\n\t\t\t\t\tlet all_result = true\r\n\t\t\t\t\tresults.forEach(\r\n\t\t\t\t\t\tfunction(value/*, index, arr*/)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (! value)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tall_result = false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.metric_duration.after()\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (! all_result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tself.rollback()\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.commit()\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\treturn all_promise\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tthis.rollback()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Execute every executables without order and fulfill on first resolved, fails if one failure appears.\r\n\t * @param {anything} arg_data - any parameter\r\n\t * @returns {Promise} - a promise of executables results array\r\n\t */\r\n\texecute_one(arg_data)\r\n\t{\r\n\t\tconst self = this\r\n\t\tlet index = 0\r\n\t\tthis.metric_duration.before()\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet tx_promises = []\r\n\t\t\tthis.executables.forEach(\r\n\t\t\t\t(executable) => {\r\n\t\t\t\t\tlet exec_promise = executable.execute(arg_data)\r\n\t\t\t\t\ttx_promises.push(exec_promise)\r\n\t\t\t\t\t\r\n\t\t\t\t\texec_promise.then(\r\n\t\t\t\t\t\tfunction(value)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlet has_error = executable.has_error()\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.results.push(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tindex:index,\r\n\t\t\t\t\t\t\t\t\tresult:value,\r\n\t\t\t\t\t\t\t\t\thas_error:has_error,\r\n\t\t\t\t\t\t\t\t\terror_msg:executable.get_error_msg()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.metrics.forEach( (metric)=>{ metric.iteration() } )\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (has_error)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\tindex++\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\tlet all_promise = Promise.race(tx_promises).then(\r\n\t\t\t\tfunction(result)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.metric_duration.after()\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (! result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tself.rollback()\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.commit()\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\treturn all_promise\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tthis.rollback()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Execute every executables in a fixed order and stop on failure.\r\n\t * @param {anything} arg_data - any parameter\r\n\t * @returns {Promise} - a promise of executables results array\r\n\t */\r\n\texecute_sequence(arg_data)\r\n\t{\r\n\t\tthis.enter_group('execute a sequence of executables')\r\n\t\t\r\n\t\tconst self = this\r\n\t\tthis.metric_duration.before()\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet tx_promise = Promise.resolve(true)\r\n\t\t\tthis.executables.forEach(\r\n\t\t\t\t(executable, index) => {\r\n\t\t\t\t\t// console.log('loop on executable', index, executable.$name)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( tx_promise && tx_promise.then )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// console.log('promise exists')\r\n\t\t\t\t\t\ttx_promise = tx_promise.then(\r\n\t\t\t\t\t\t\tfunction(value)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// console.log('previous is resolved')\r\n\t\t\t\t\t\t\t\tif(!value)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tconsole.log('previous executable error', index, executable.$name)\r\n\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tlet exec_promise = executable.execute(arg_data)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// EXECUTION WITHOUT EXCEPTION\r\n\t\t\t\t\t\t\t\texec_promise = exec_promise.then(\r\n\t\t\t\t\t\t\t\t\tfunction(exec_value)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tlet has_error = executable.has_error()\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tconsole.info('current executable [%s] [%s] without exception', index, executable.$name)\r\n\t\t\t\t\t\t\t\t\t\tif (has_error)\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error('current executable [%s] [%s] with error', index, executable.$name)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tself.results.push(\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex:index,\r\n\t\t\t\t\t\t\t\t\t\t\t\tresult:exec_value,\r\n\t\t\t\t\t\t\t\t\t\t\t\thas_error:has_error,\r\n\t\t\t\t\t\t\t\t\t\t\t\terror_msg:executable.get_error_msg()\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\tself.metrics.forEach( (metric)=>{ metric.iteration() } )\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\treturn ! has_error\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// EXECUTION FAILURE WITH AN EXCEPTION\r\n\t\t\t\t\t\t\t\texec_promise.catch(\r\n\t\t\t\t\t\t\t\t\t(reason)=>{\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('current executable exception', index, executable.$name)\r\n\t\t\t\t\t\t\t\t\t\tself.results.push(\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex:index,\r\n\t\t\t\t\t\t\t\t\t\t\t\tresult:null,\r\n\t\t\t\t\t\t\t\t\t\t\t\thas_error:true,\r\n\t\t\t\t\t\t\t\t\t\t\t\terror_msg:reason\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\treturn exec_promise\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t// TRANSACTION WITHOUT EXCEPTION\r\n\t\t\ttx_promise = tx_promise.then(\r\n\t\t\t\tfunction(result)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log('executable success')\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.metric_duration.after()\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (! result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tself.rollback()\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.log('runtime loading parts duration', self.metric_duration.get_values().iterations)\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.commit()\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t// TRANSACTION FAILURE WITH EXCEPTION\r\n\t\t\ttx_promise = tx_promise.catch(\r\n\t\t\t\t(reason)=>{\r\n\t\t\t\t\tconsole.log('executable failure')\r\n\t\t\t\t\tself.metric_duration.after()\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.error(context + ':exception:tx failure', reason)\r\n\t\t\t\t\tself.rollback()\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\tthis.leave_group('execute a sequence of executables (OK) (async)')\r\n\t\t\treturn tx_promise\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tconsole.error(context + ':exception:' + e)\r\n\t\t\tthis.rollback()\r\n\t\t}\r\n\t\t\r\n\t\tthis.leave_group('execute a sequence of executables (KO) (async)')\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Commit transaction execution on executables success. Change status to EXEC_OK.\r\n\t * @returns {nothing}\r\n\t */\r\n\tcommit()\r\n\t{\r\n\t\tthis.executables.forEach(\r\n\t\t\t(executable) => {\r\n\t\t\t\texecutable.exec_ack()\r\n\t\t\t}\r\n\t\t)\r\n\t\tthis.status = STATUS_EXEC_OK\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Rollback transaction execution on executables failure. Change status to EXEC_KO.\r\n\t * @returns {nothing}\r\n\t */\r\n\trollback()\r\n\t{\r\n\t\tthis.executables.forEach(\r\n\t\t\t(executable) => {\r\n\t\t\t\texecutable.exec_fail()\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.status = STATUS_EXEC_KO\r\n\t\t\r\n\t\tthis.results.forEach(\r\n\t\t\t(value, index)=>console.log('result at executable [' + index + ']', value)\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Finish all executables.\r\n\t * @returns {nothing}\r\n\t */\r\n\tfinish()\r\n\t{\r\n\t\tthis.executables.forEach(\r\n\t\t\t(executable) => {\r\n\t\t\t\texecutable.finish()\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.metrics.forEach( (metric)=>{ metric.after() } )\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get instance description: {$type:..., $class:..., $id:..., $name:...}.\r\n\t * @returns {object} - instance object description\r\n\t */\r\n\tget_descriptor()\r\n\t{\r\n\t\t// TODO: delete this method ? Same as its parent!\r\n\t\tlet parent_desc = super.get_descriptor()\r\n\t\treturn parent_desc\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get transaction metrics: {id:..., status:..., metrics:...}.\r\n\t * @returns {object} - transaction metrics plain object\r\n\t */\r\n\tget_metrics()\r\n\t{\r\n\t\tlet values = []\r\n\t\tthis.metrics.forEach( (metric)=>{ values.push( metric.getvalues() ) } )\r\n\t\treturn { $id:this.$id, $status:this.status, metrics:values }\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get executables results array: {index:..., result:..., has_error:..., error_msg:...}.\r\n\t * @returns {Array} - all executed executables results.\r\n\t */\r\n\tget_results()\r\n\t{\r\n\t\treturn this.results\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get result of the first ended executable.\r\n\t * @returns {object} - result object.\r\n\t */\r\n\tget_first_result()\r\n\t{\r\n\t\treturn this.results && this.results.length > 0 ? this.results[0] : null\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get result of the first ended executable which failed.\r\n\t * @returns {object} - error object.\r\n\t */\r\n\tget_first_error()\r\n\t{\r\n\t\tif ( this.results && this.results.length > 0 )\r\n\t\t{\r\n\t\t\treturn this.results.find( (result) => { return result.has_error } )\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * Transaction type SEQUENCE: all executables are run one at a time in the registered order.\r\n */\r\nTransaction.SEQUENCE = TYPE_SEQUENCE\r\n\r\n/**\r\n * Transaction type ONE: all executables are run at the same time without order and transaction ends when a run finish.\r\n */\r\nTransaction.ONE = TYPE_ONE\r\n\r\n/**\r\n * Transaction type EVERY: all executables are run at the same time without order.\r\n */\r\nTransaction.EVERY = TYPE_EVERY\r\n",
    "static": true,
    "longname": "js/base/transaction.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 50,
    "kind": "variable",
    "name": "context",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 51,
    "kind": "variable",
    "name": "TYPE_SEQUENCE",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~TYPE_SEQUENCE",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 52,
    "kind": "variable",
    "name": "TYPE_EVERY",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~TYPE_EVERY",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 53,
    "kind": "variable",
    "name": "TYPE_ONE",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~TYPE_ONE",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 54,
    "kind": "variable",
    "name": "STATUS_CREATED",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~STATUS_CREATED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 55,
    "kind": "variable",
    "name": "STATUS_PREPARED",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~STATUS_PREPARED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 56,
    "kind": "variable",
    "name": "STATUS_EXEC_OK",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~STATUS_EXEC_OK",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 57,
    "kind": "variable",
    "name": "STATUS_EXEC_KO",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~STATUS_EXEC_KO",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 58,
    "kind": "class",
    "name": "Transaction",
    "memberof": "js/base/transaction.js",
    "static": true,
    "longname": "js/base/transaction.js~Transaction",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/base/transaction.js",
    "importStyle": "Transaction",
    "description": "",
    "lineNumber": 32,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Transaction class to manage grouped executions with commit/rollback features."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/instance~Instance"
    ]
  },
  {
    "__docId__": 59,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#constructor",
    "access": null,
    "description": "Create a Transaction. Set status to CREATED.",
    "lineNumber": 45,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Instance"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_app_name",
        "description": "application name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_svc_name",
        "description": "service name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_tx_name",
        "description": "transaction name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "settings"
      },
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_executables",
        "description": "executables array (optional)"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "transaction type (optional)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 60,
    "kind": "member",
    "name": "is_transaction",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#is_transaction",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 61,
    "kind": "member",
    "name": "metric_duration",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#metric_duration",
    "access": null,
    "description": null,
    "lineNumber": 58,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 62,
    "kind": "member",
    "name": "metrics",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#metrics",
    "access": null,
    "description": null,
    "lineNumber": 59,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "undefined[]"
      ]
    }
  },
  {
    "__docId__": 63,
    "kind": "member",
    "name": "status",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#status",
    "access": null,
    "description": null,
    "lineNumber": 62,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 64,
    "kind": "method",
    "name": "set_executables",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#set_executables",
    "access": null,
    "description": "Set transaction executables.",
    "lineNumber": 71,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_executables",
        "description": "executables instances array."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 65,
    "kind": "member",
    "name": "executables",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#executables",
    "access": null,
    "description": null,
    "lineNumber": 74,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 66,
    "kind": "method",
    "name": "set_type",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#set_type",
    "access": null,
    "description": "Set the transaction type. Value should be choosen from the list:EVERY,SEQUENCE,ONE\n  * EVERY: transaction is finished when all executables are finished without order.\n  * SEQUENCE: transaction is finished when all executables are finished in a ordered sequence.\n  * ONE: transaction is finished when an executable finished without waiting other executables.",
    "lineNumber": 93,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "transaction type value."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 67,
    "kind": "member",
    "name": "tx_type",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#tx_type",
    "access": null,
    "description": null,
    "lineNumber": 102,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 68,
    "kind": "member",
    "name": "tx_type",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#tx_type",
    "access": null,
    "description": null,
    "lineNumber": 103,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 69,
    "kind": "member",
    "name": "tx_type",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#tx_type",
    "access": null,
    "description": null,
    "lineNumber": 104,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 70,
    "kind": "member",
    "name": "tx_type",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#tx_type",
    "access": null,
    "description": null,
    "lineNumber": 107,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 71,
    "kind": "method",
    "name": "prepare",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#prepare",
    "access": null,
    "description": "Prepare transaction executables. Change status to PREPARED.",
    "lineNumber": 116,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "executables context."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 72,
    "kind": "member",
    "name": "results",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#results",
    "access": null,
    "description": null,
    "lineNumber": 126,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 73,
    "kind": "member",
    "name": "status",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#status",
    "access": null,
    "description": null,
    "lineNumber": 127,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 74,
    "kind": "method",
    "name": "execute",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#execute",
    "access": null,
    "description": "Execute all executables regarding the transaction type.",
    "lineNumber": 136,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of executables results array"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "anything"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "any parameter"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of executables results array"
    }
  },
  {
    "__docId__": 75,
    "kind": "method",
    "name": "execute_every",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#execute_every",
    "access": null,
    "description": "Execute every executables without order and fails if one failure appears.",
    "lineNumber": 161,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of executables results array"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "anything"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "any parameter"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of executables results array"
    }
  },
  {
    "__docId__": 76,
    "kind": "method",
    "name": "execute_one",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#execute_one",
    "access": null,
    "description": "Execute every executables without order and fulfill on first resolved, fails if one failure appears.",
    "lineNumber": 247,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of executables results array"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "anything"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "any parameter"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of executables results array"
    }
  },
  {
    "__docId__": 77,
    "kind": "method",
    "name": "execute_sequence",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#execute_sequence",
    "access": null,
    "description": "Execute every executables in a fixed order and stop on failure.",
    "lineNumber": 322,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of executables results array"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "anything"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "any parameter"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of executables results array"
    }
  },
  {
    "__docId__": 78,
    "kind": "method",
    "name": "commit",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#commit",
    "access": null,
    "description": "Commit transaction execution on executables success. Change status to EXEC_OK.",
    "lineNumber": 449,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 79,
    "kind": "member",
    "name": "status",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#status",
    "access": null,
    "description": null,
    "lineNumber": 456,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 80,
    "kind": "method",
    "name": "rollback",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#rollback",
    "access": null,
    "description": "Rollback transaction execution on executables failure. Change status to EXEC_KO.",
    "lineNumber": 464,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 81,
    "kind": "member",
    "name": "status",
    "memberof": "js/base/transaction.js~Transaction",
    "static": false,
    "longname": "js/base/transaction.js~Transaction#status",
    "access": null,
    "description": null,
    "lineNumber": 472,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 82,
    "kind": "method",
    "name": "finish",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#finish",
    "access": null,
    "description": "Finish all executables.",
    "lineNumber": 484,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 83,
    "kind": "method",
    "name": "get_descriptor",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#get_descriptor",
    "access": null,
    "description": "Get instance description: {$type:..., $class:..., $id:..., $name:...}.",
    "lineNumber": 500,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - instance object description"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "instance object description"
    }
  },
  {
    "__docId__": 84,
    "kind": "method",
    "name": "get_metrics",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#get_metrics",
    "access": null,
    "description": "Get transaction metrics: {id:..., status:..., metrics:...}.",
    "lineNumber": 512,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - transaction metrics plain object"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "transaction metrics plain object"
    }
  },
  {
    "__docId__": 85,
    "kind": "method",
    "name": "get_results",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#get_results",
    "access": null,
    "description": "Get executables results array: {index:..., result:..., has_error:..., error_msg:...}.",
    "lineNumber": 524,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Array} - all executed executables results."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Array"
      ],
      "spread": false,
      "description": "all executed executables results."
    }
  },
  {
    "__docId__": 86,
    "kind": "method",
    "name": "get_first_result",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#get_first_result",
    "access": null,
    "description": "Get result of the first ended executable.",
    "lineNumber": 534,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - result object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "result object."
    }
  },
  {
    "__docId__": 87,
    "kind": "method",
    "name": "get_first_error",
    "memberof": "js/base/transaction.js~Transaction",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/base/transaction.js~Transaction#get_first_error",
    "access": null,
    "description": "Get result of the first ended executable which failed.",
    "lineNumber": 544,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - error object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "error object."
    }
  },
  {
    "__docId__": 88,
    "kind": "file",
    "name": "js/executables/executable_command.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T          from 'devapt-core-common/dist/js/utils/types'\r\nimport Executable from 'devapt-core-common/dist/js/base/executable'\r\n\r\n\r\nlet context = 'server/executables/executable_command'\r\n\r\n\r\n\r\n/**\r\n *  @file todo Executable command class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ExecutableCommand extends Executable\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tsuper(context)\r\n\t}\r\n\t\r\n\t\r\n\tprepare(arg_settings)\r\n\t{\r\n\t\tassert( T.isObject(arg_settings), context + ':no given config')\r\n\t\tthis.store_config = arg_settings\r\n\t\t\r\n\t\tassert(T.isObject(this.store_config), context + ':bad config object')\r\n\t\t\r\n\t\tassert(T.isObject(this.store_config.server), context + ':bad server object')\r\n\t\tassert(this.store_config.server.is_server, context + ':bad server instance')\r\n\t\t\r\n\t\tthis.server = this.store_config.server\r\n\t\t\r\n\t\t// assert(T.isArray(this.store_config.server_types), context + ':bad server_types array')\r\n\t\tthis.store_config.server_types = ['restify', 'express']\r\n\t}\r\n\t\r\n\t\r\n\texecute(arg_data)\r\n\t{\r\n\t\t// CHECK APPLICATION\r\n\t\tassert(T.isObject(arg_data), context + ':bad application object')\r\n\t\tassert(arg_data.is_topology_define_application, context + ':bad application instance')\r\n\t\tconst application = arg_data\r\n\t\tthis.info('Execute: add server route for ' + application.$name)\r\n\t\t\r\n\t\t// CHECK SERVER\r\n\t\tconst server_instance = this.server\r\n\t\tassert(T.isString(server_instance.server_type), context + ':bad server_instance.server_type string')\r\n\t\tassert(this.store_config.server_types.indexOf(server_instance.server_type) > -1, context + ':server_instance.server_type not valid')\r\n\t\t// console.log(server_instance, 'server_instance')\r\n\t\t// console.log(server_instance.server, 'server_instance.server')\r\n\t\t// assert(T.isObject(server_instance.server), context + ':bad server_instance.server object')\r\n\t\tassert(T.isObject(server_instance.server) || T.isFunction(server_instance.server), context + ':bad server_instance.server object or function')\r\n\t\t\r\n        return Promise.resolve()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/executables/executable_command.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 89,
    "kind": "variable",
    "name": "context",
    "memberof": "js/executables/executable_command.js",
    "static": true,
    "longname": "js/executables/executable_command.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/executables/executable_command.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 90,
    "kind": "class",
    "name": "ExecutableCommand",
    "memberof": "js/executables/executable_command.js",
    "static": true,
    "longname": "js/executables/executable_command.js~ExecutableCommand",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/executables/executable_command.js",
    "importStyle": "ExecutableCommand",
    "description": "",
    "lineNumber": 18,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "todo Executable command class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/executable~Executable"
    ]
  },
  {
    "__docId__": 91,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/executables/executable_command.js~ExecutableCommand",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/executables/executable_command.js~ExecutableCommand#constructor",
    "access": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": []
  },
  {
    "__docId__": 92,
    "kind": "method",
    "name": "prepare",
    "memberof": "js/executables/executable_command.js~ExecutableCommand",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/executables/executable_command.js~ExecutableCommand#prepare",
    "access": null,
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_settings",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 93,
    "kind": "member",
    "name": "store_config",
    "memberof": "js/executables/executable_command.js~ExecutableCommand",
    "static": false,
    "longname": "js/executables/executable_command.js~ExecutableCommand#store_config",
    "access": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 94,
    "kind": "member",
    "name": "server",
    "memberof": "js/executables/executable_command.js~ExecutableCommand",
    "static": false,
    "longname": "js/executables/executable_command.js~ExecutableCommand#server",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 95,
    "kind": "method",
    "name": "execute",
    "memberof": "js/executables/executable_command.js~ExecutableCommand",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/executables/executable_command.js~ExecutableCommand#execute",
    "access": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_data",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 96,
    "kind": "file",
    "name": "js/index.js",
    "content": "\r\n// COMMON IMPORTS\r\nimport RenderingPlugin from 'devapt-core-common/dist/js/plugins/rendering_plugin'\r\nimport ServicesPlugin  from 'devapt-core-common/dist/js/plugins/services_plugin'\r\n\r\n// SERVICES IMPORTS\r\nimport DefaultServicesPlugin from 'devapt-core-services/dist/js/default_plugins/services_default_plugin'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from './base/runtime'\r\nimport ServersPlugin from './plugins/servers_plugin'\r\n\r\n// BROWSER IMPORTS\r\nimport Component        from '../browser/base/component'\r\nimport Container        from '../browser/base/container'\r\n\r\n\r\n\r\n/**\r\n * Main public part of Devapt library\r\n * \r\n * @name index.js\r\n * \r\n * @license Apache-2.0\r\n * \r\n * @auhtor Luc BORIES\r\n * \r\n * @property {object} devapt.runtime - Runtime class instance\r\n * @property {object} devapt.store - Redux store instance\r\n * @property {object} devapt.config - configuration part of a Redux store instance\r\n * @property {object} devapt.logs - logging wrapper\r\n * @property {object} devapt.render - rendering wrapper Class (Render)\r\n * @property {object} devapt.Component - rendering base class (Component)\r\n */\r\n\r\n\r\nexport default { runtime, Component, Container, RenderingPlugin, ServicesPlugin, ServersPlugin, DefaultServicesPlugin }\r\n",
    "static": true,
    "longname": "js/index.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 97,
    "kind": "file",
    "name": "js/metrics/base/metrics_collector.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T            from 'devapt-core-common/dist/js/utils/types'\r\nimport Settingsable from 'devapt-core-common/dist/js/base/settingsable'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../../base/runtime'\r\n\r\n\r\nconst context = 'server/metrics/base/metrics_collector'\r\n\r\n\r\n/**\r\n * Metrics collector status.\r\n */\r\nconst STATUS_CREATED = 'CREATED'\r\nconst STATUS_INITIALIZED = 'INITIALIZED'\r\nconst STATUS_CLOSED = 'CLOSED'\r\n\r\n\r\n\r\n/**\r\n * Metrics collector base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsCollector extends Settingsable\r\n{\r\n    /**\r\n     * Metrics collector constructor.\r\n\t * @extends Settingsable\r\n\t * @param {Immutable.Map} arg_settings - instance settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_settings, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_settings, (arg_log_context ? arg_log_context : context))\r\n\t\t\r\n\t\tthis.is_metrics_collector = true\r\n\t\t\r\n\t\tthis.$state = STATUS_CREATED\r\n\t\t\r\n\t\tthis.metrics_server_name = undefined\r\n\r\n\t\tthis.metrics_reducer = undefined\r\n\t\tthis.metrics_state = undefined\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Initialize metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tinit()\r\n\t{\r\n\t\tthis.$state = STATUS_INITIALIZED\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Send metrics message.\r\n\t * \r\n\t * @param {string} arg_type - metrics type string.\r\n\t * @param {array} arg_values - metrics values array.\r\n\t * \r\n\t * @returns {boolean}\r\n\t */\r\n\tsend_metrics(arg_type, arg_values)\r\n\t{\r\n\t\tif (!this.metrics_server_name)\r\n\t\t{\r\n\t\t\tthis.metrics_server_name = runtime.node.get_metrics_server().get_name()\r\n\t\t\t// console.log(context + ':send_metrics:metrics_server_name:type=%s srv=%s', arg_type, this.metrics_server_name)\r\n\t\t}\r\n\r\n\t\t// console.log(context + ':send_metrics:type=%s srv=%s', arg_type, this.metrics_server_name)\r\n\t\treturn runtime.node.send_metrics(this.metrics_server_name, arg_type, arg_values)\r\n\t}\r\n\t\r\n    \r\n\t/**\r\n     * Flush pending metrics records.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tflush()\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush and close the metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tclose()\r\n\t{\r\n\t\tthis.flush()\r\n\t\tthis.$state = STATUS_CLOSED\r\n\t\t\r\n\t\tdelete this.metric_reducer\r\n\t\tdelete this.metrics_state\r\n\t\t\r\n\t\tthis.metric_reducer = undefined\r\n\t\tthis.metrics_state = undefined\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Get the metrics collector status: CREATED, INITIALIZED, CLOSED.\r\n\t * \r\n\t * @returns {string} _ status string\r\n     */\r\n\tget_status()\r\n\t{\r\n\t\treturn this.$state\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Get the metrics collector status: CREATED, INITIALIZED, CLOSED.\r\n\t * \r\n\t * @returns {string} _ status string\r\n     */\r\n\tget_state_values()\r\n\t{\r\n\t\tassert( T.isObject(this.metrics_state) && this.metrics_state.is_metrics_state, context + ':get_state_values:bad state object')\r\n\t\treturn this.metrics_state.get_values()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Process a metrics record.\r\n\t * \r\n\t * @param {MetricsRecord} arg_metrics_record - metrics record.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tprocess_record(arg_metrics_record)\r\n\t{\r\n\t\tassert( T.isObject(arg_metrics_record) && arg_metrics_record.is_metrics_record, context + ':get_state_values:bad state object')\r\n\t\t\r\n\t\tif (arg_metrics_record.get_name() == this.get_name())\r\n\t\t{\r\n\t\t\tthis.process_values(arg_metrics_record.get_values())\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Process metrics record values.\r\n\t * \r\n\t * @param {object} arg_metrics_values - metrics record values.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tprocess_values(arg_metrics_values)\r\n\t{\r\n\t\tthis.metrics_state = this.metrics_reducer.reduce(this.metrics_state, arg_metrics_values)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 98,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/base/metrics_collector.js",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 99,
    "kind": "variable",
    "name": "STATUS_CREATED",
    "memberof": "js/metrics/base/metrics_collector.js",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js~STATUS_CREATED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_collector.js",
    "importStyle": null,
    "description": "Metrics collector status.",
    "lineNumber": 18,
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 100,
    "kind": "variable",
    "name": "STATUS_INITIALIZED",
    "memberof": "js/metrics/base/metrics_collector.js",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js~STATUS_INITIALIZED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 19,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 101,
    "kind": "variable",
    "name": "STATUS_CLOSED",
    "memberof": "js/metrics/base/metrics_collector.js",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js~STATUS_CLOSED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 102,
    "kind": "class",
    "name": "MetricsCollector",
    "memberof": "js/metrics/base/metrics_collector.js",
    "static": true,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_collector.js",
    "importStyle": "MetricsCollector",
    "description": "Metrics collector base class.",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/settingsable~Settingsable"
    ]
  },
  {
    "__docId__": 103,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#constructor",
    "access": null,
    "description": "Metrics collector constructor.",
    "lineNumber": 38,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Settingsable"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "instance settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 104,
    "kind": "member",
    "name": "is_metrics_collector",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#is_metrics_collector",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 105,
    "kind": "member",
    "name": "$state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#$state",
    "access": null,
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 106,
    "kind": "member",
    "name": "metrics_server_name",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_server_name",
    "access": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 107,
    "kind": "member",
    "name": "metrics_reducer",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 108,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 109,
    "kind": "method",
    "name": "init",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#init",
    "access": null,
    "description": "Initialize metrics collector.",
    "lineNumber": 59,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 110,
    "kind": "member",
    "name": "$state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#$state",
    "access": null,
    "description": null,
    "lineNumber": 61,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 111,
    "kind": "method",
    "name": "send_metrics",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#send_metrics",
    "access": null,
    "description": "Send metrics message.",
    "lineNumber": 74,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "metrics type string."
      },
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_values",
        "description": "metrics values array."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 112,
    "kind": "member",
    "name": "metrics_server_name",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_server_name",
    "access": null,
    "description": null,
    "lineNumber": 78,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 113,
    "kind": "method",
    "name": "flush",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#flush",
    "access": null,
    "description": "Flush pending metrics records.",
    "lineNumber": 92,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 114,
    "kind": "method",
    "name": "close",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#close",
    "access": null,
    "description": "Flush and close the metrics collector.",
    "lineNumber": 103,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 115,
    "kind": "member",
    "name": "$state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#$state",
    "access": null,
    "description": null,
    "lineNumber": 106,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 116,
    "kind": "member",
    "name": "metric_reducer",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metric_reducer",
    "access": null,
    "description": null,
    "lineNumber": 111,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 117,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 112,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 118,
    "kind": "method",
    "name": "get_status",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#get_status",
    "access": null,
    "description": "Get the metrics collector status: CREATED, INITIALIZED, CLOSED.",
    "lineNumber": 122,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} _ status string"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "_ status string"
    }
  },
  {
    "__docId__": 119,
    "kind": "method",
    "name": "get_state_values",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#get_state_values",
    "access": null,
    "description": "Get the metrics collector status: CREATED, INITIALIZED, CLOSED.",
    "lineNumber": 134,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} _ status string"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "_ status string"
    }
  },
  {
    "__docId__": 120,
    "kind": "method",
    "name": "process_record",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#process_record",
    "access": null,
    "description": "Process a metrics record.",
    "lineNumber": 149,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "MetricsRecord"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_record",
        "description": "metrics record."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 121,
    "kind": "method",
    "name": "process_values",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#process_values",
    "access": null,
    "description": "Process metrics record values.",
    "lineNumber": 168,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics record values."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 122,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/base/metrics_collector.js~MetricsCollector",
    "static": false,
    "longname": "js/metrics/base/metrics_collector.js~MetricsCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 170,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 123,
    "kind": "file",
    "name": "js/metrics/base/metrics_record.js",
    "content": "\r\n// const context = 'server/metrics/base/metrics_record'\r\n\r\n\r\n\r\n/**\r\n * @file Metrics record base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsRecord\r\n{\r\n    /**\r\n     * Metrics record constructor.\r\n\t * \r\n\t * @params {string} arg_metrics_name - metrics series name ('http', 'host'...)\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_metrics_name)\r\n\t{\r\n\t\tthis.is_metrics_record  = true\r\n\t\t\r\n\t\tthis.name = arg_metrics_name\r\n\t\tthis.values = {}\r\n\t\t\r\n\t\t// METRIC TYPE\r\n\t\tthis.values.metric = this.get_name()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before request processing.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tbefore()\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\titeration()\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tafter()\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Returns metrics series name.\r\n\t * \r\n\t * @returns {string} - name\r\n     */\r\n\tget_name()\r\n\t{\r\n\t\treturn this.name\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Returns metrics values plain object.\r\n\t * \r\n\t * @returns {object} - values map plain object\r\n     */\r\n\tget_values()\r\n\t{\r\n\t\treturn this.values\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/base/metrics_record.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 124,
    "kind": "class",
    "name": "MetricsRecord",
    "memberof": "js/metrics/base/metrics_record.js",
    "static": true,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_record.js",
    "importStyle": "MetricsRecord",
    "description": "",
    "lineNumber": 11,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Metrics record base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 125,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#constructor",
    "access": null,
    "description": "Metrics record constructor.",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@params",
        "tagValue": "{string} arg_metrics_name - metrics series name ('http', 'host'...)"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_metrics_name",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 126,
    "kind": "member",
    "name": "is_metrics_record",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#is_metrics_record",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 127,
    "kind": "member",
    "name": "name",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#name",
    "access": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 128,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#values",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 129,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#before",
    "access": null,
    "description": "Executed before request processing.",
    "lineNumber": 38,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 130,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#iteration",
    "access": null,
    "description": "Executed at each request processing iteration.",
    "lineNumber": 49,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 131,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#after",
    "access": null,
    "description": "Executed after request processing.",
    "lineNumber": 60,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 132,
    "kind": "method",
    "name": "get_name",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#get_name",
    "access": null,
    "description": "Returns metrics series name.",
    "lineNumber": 71,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - name"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "name"
    }
  },
  {
    "__docId__": 133,
    "kind": "method",
    "name": "get_values",
    "memberof": "js/metrics/base/metrics_record.js~MetricsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_record.js~MetricsRecord#get_values",
    "access": null,
    "description": "Returns metrics values plain object.",
    "lineNumber": 83,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - values map plain object"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "values map plain object"
    }
  },
  {
    "__docId__": 134,
    "kind": "file",
    "name": "js/metrics/base/metrics_reducer.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n\r\nconst context = 'server/metrics/base/metrics_reducer'\r\n\r\n\r\n\r\n/**\r\n * @file Reducer class for HTTP metrics collect.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsReducer\r\n{\r\n\t/**\r\n\t * Reducer for metrics class.\r\n\t * \r\n\t * @params {string} arg_metrics_name - metrics series name ('http', 'host'...)\r\n\t * \r\n\t * @returns {nothing}\r\n\t*/\r\n\tconstructor(arg_metrics_name)\r\n\t{\r\n\t\tthis.is_metrics_reducer = true\r\n\t\t\r\n\t\tthis.name = arg_metrics_name\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce metrics records to a state.\r\n\t * \r\n\t * @param {MetricsState} arg_state - metrics state.\r\n\t * @param {object|array} arg_metrics_values - metrics records values.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce(arg_state, arg_metrics_values)\r\n\t{\r\n\t\tassert( T.isObject(arg_state) && arg_state.is_metrics_state, context + ':reduce:bad state object')\r\n\t\tassert( T.isObject(arg_metrics_values) || T.isArray(arg_metrics_values), context + ':reduce:bad metrics values object or array' )\r\n\t\t\r\n\t\targ_metrics_values = T.isArray(arg_metrics_values) ? arg_metrics_values : [arg_metrics_values]\r\n\t\t\r\n\t\tlet state_values = arg_state.get_values()\r\n\t\t// console.log(state_values, context + ':reduce:state_values for ' + arg_state.get_name())\r\n\t\t\r\n\t\t// PROBLEM WITH NODEJS 0.10\r\n\t\tfor(let loop_metric_index = 0 ; loop_metric_index < arg_metrics_values.length ; loop_metric_index++)\r\n\t\t{\r\n\t\t\tlet loop_metric = arg_metrics_values[loop_metric_index]\r\n\t\t// for(let loop_metric of arg_metrics_values)\r\n\t\t// {\r\n\t\t\t// console.log(loop_metric, context + ':reduce:loop_metric for ' + arg_state.get_name())\r\n\t\t\t\r\n\t\t\tassert( T.isObject(loop_metric) && loop_metric.metric == arg_state.get_name(), context + ':reduce:bad metrics object')\r\n\t\t\t\r\n\t\t\tstate_values = this.reduce_one_record(state_values, loop_metric, arg_state)\r\n\t\t}\r\n\t\t\r\n\t\targ_state.set_values(state_values)\r\n\t\t\r\n\t\t// console.log('http reduce.state', arg_state)\r\n\t\t\r\n\t\treturn arg_state\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce metrics records into a state.\r\n\t * \r\n\t * @param {object} arg_state_values - metrics state values.\r\n\t * @param {object} arg_metrics_values - metrics records values.\r\n\t * @param {MetricsState} arg_state - metrics state.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce_one_record(arg_state_values/*, arg_metrics_values, arg_state*/)\r\n\t{\r\n\t\treturn arg_state_values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Increment a state value.\r\n\t * \r\n\t * @param {object} arg_state_values - values map object.\r\n\t * @param {string} arg_state_key - metrics state values.\r\n\t * @param {string} arg_metrics_values_key - metrics values key.\r\n\t * \r\n\t * @returns {MetricsState} - a new metrics state instance.\r\n\t */\r\n\tincr(arg_state_values, arg_state_key, arg_metrics_values_key)\r\n\t{\r\n\t\targ_state_key = arg_state_key ? arg_state_key : 'unknow'\r\n\t\t\r\n\t\tif ( ! (arg_state_key in arg_state_values) )\r\n\t\t{\r\n\t\t\targ_state_values[arg_state_key] = {}\r\n\t\t}\r\n\t\t\r\n\t\tif ( ! (arg_metrics_values_key in arg_state_values[arg_state_key]) )\r\n\t\t{\r\n\t\t\targ_state_values[arg_state_key][arg_metrics_values_key] = 0\r\n\t\t}\r\n\t\t\r\n\t\targ_state_values[arg_state_key][arg_metrics_values_key] += 1\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new state instance.\r\n\t * \r\n\t * @returns {MetricsState} - a new metrics state instance.\r\n\t */\r\n\tcreate_state()\r\n\t{\r\n\t\treturn undefined\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/base/metrics_reducer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 135,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/base/metrics_reducer.js",
    "static": true,
    "longname": "js/metrics/base/metrics_reducer.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_reducer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 136,
    "kind": "class",
    "name": "MetricsReducer",
    "memberof": "js/metrics/base/metrics_reducer.js",
    "static": true,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_reducer.js",
    "importStyle": "MetricsReducer",
    "description": "",
    "lineNumber": 17,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Reducer class for HTTP metrics collect."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 137,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#constructor",
    "access": null,
    "description": "Reducer for metrics class.",
    "lineNumber": 26,
    "unknown": [
      {
        "tagName": "@params",
        "tagValue": "{string} arg_metrics_name - metrics series name ('http', 'host'...)"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_metrics_name",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 138,
    "kind": "member",
    "name": "is_metrics_reducer",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#is_metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 139,
    "kind": "member",
    "name": "name",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#name",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 140,
    "kind": "method",
    "name": "reduce",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#reduce",
    "access": null,
    "description": "Reduce metrics records to a state.",
    "lineNumber": 43,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "MetricsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      },
      {
        "nullable": null,
        "types": [
          "object",
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 141,
    "kind": "method",
    "name": "reduce_one_record",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#reduce_one_record",
    "access": null,
    "description": "Reduce metrics records into a state.",
    "lineNumber": 84,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      },
      {
        "nullable": null,
        "types": [
          "MetricsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 142,
    "kind": "method",
    "name": "incr",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#incr",
    "access": null,
    "description": "Increment a state value.",
    "lineNumber": 100,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsState} - a new metrics state instance."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "values map object."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_key",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values_key",
        "description": "metrics values key."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "MetricsState"
      ],
      "spread": false,
      "description": "a new metrics state instance."
    }
  },
  {
    "__docId__": 143,
    "kind": "method",
    "name": "create_state",
    "memberof": "js/metrics/base/metrics_reducer.js~MetricsReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_reducer.js~MetricsReducer#create_state",
    "access": null,
    "description": "Create a new state instance.",
    "lineNumber": 124,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsState} - a new metrics state instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MetricsState"
      ],
      "spread": false,
      "description": "a new metrics state instance."
    }
  },
  {
    "__docId__": 144,
    "kind": "file",
    "name": "js/metrics/base/metrics_state.js",
    "content": "\r\n// const context = 'common/metrics/base/metrics_state'\r\n\r\n\r\n\r\n/**\r\n * @file Metrics state base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsState\r\n{\r\n    /**\r\n     * Metrics state constructor.\r\n\t * \r\n\t * @params {string} arg_metrics_name - metrics series name ('http', 'host'...)\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_metrics_name)\r\n\t{\r\n\t\tthis.is_metrics_state  = true\r\n\t\t\r\n\t\tthis.name = arg_metrics_name\r\n\t\tthis.values = {}\r\n\t\t\r\n\t\t// METRIC TYPE\r\n\t\tthis.values.metric = this.get_name()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Returns metrics series name.\r\n\t * \r\n\t * @returns {string} - name.\r\n     */\r\n\tget_name()\r\n\t{\r\n\t\treturn this.name\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Returns metrics values plain object.\r\n\t * \r\n\t * @returns {object} - values map plain object.\r\n     */\r\n\tget_values()\r\n\t{\r\n\t\treturn this.values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Set metrics values plain object.\r\n\t * \r\n\t * @param {object} arg_values - values plain object.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tset_values(arg_values)\r\n\t{\r\n\t\tthis.values = arg_values\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/base/metrics_state.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 145,
    "kind": "class",
    "name": "MetricsState",
    "memberof": "js/metrics/base/metrics_state.js",
    "static": true,
    "longname": "js/metrics/base/metrics_state.js~MetricsState",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/base/metrics_state.js",
    "importStyle": "MetricsState",
    "description": "",
    "lineNumber": 11,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Metrics state base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 146,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#constructor",
    "access": null,
    "description": "Metrics state constructor.",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@params",
        "tagValue": "{string} arg_metrics_name - metrics series name ('http', 'host'...)"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_metrics_name",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 147,
    "kind": "member",
    "name": "is_metrics_state",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#is_metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 148,
    "kind": "member",
    "name": "name",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#name",
    "access": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 149,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#values",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 150,
    "kind": "method",
    "name": "get_name",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#get_name",
    "access": null,
    "description": "Returns metrics series name.",
    "lineNumber": 38,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - name."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "name."
    }
  },
  {
    "__docId__": 151,
    "kind": "method",
    "name": "get_values",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#get_values",
    "access": null,
    "description": "Returns metrics values plain object.",
    "lineNumber": 50,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - values map plain object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "values map plain object."
    }
  },
  {
    "__docId__": 152,
    "kind": "method",
    "name": "set_values",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#set_values",
    "access": null,
    "description": "Set metrics values plain object.",
    "lineNumber": 64,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_values",
        "description": "values plain object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 153,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/base/metrics_state.js~MetricsState",
    "static": false,
    "longname": "js/metrics/base/metrics_state.js~MetricsState#values",
    "access": null,
    "description": null,
    "lineNumber": 66,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 154,
    "kind": "file",
    "name": "js/metrics/bus/metrics_bus_collector.js",
    "content": "// SERVER IMPORTS\r\nimport runtime from '../../base/runtime'\r\nimport MetricsCollector from '../base/metrics_collector'\r\nimport MetricsBusRecord from './metrics_bus_record'\r\nimport MetricsBusState from './metrics_bus_state'\r\nimport MetricsBusReducer from './metrics_bus_reducer'\r\n\r\n\r\nconst context = 'server/metrics/bus/metrics_bus_collector'\r\n\r\n\r\n\r\n/**\r\n * Metrics Bus collector class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsBusCollector extends MetricsCollector\r\n{\r\n    /**\r\n     * Metrics collector constructor.\r\n\t * @extends MetricsCollector\r\n\t * @param {Immutable.Map} arg_settings - instance settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_settings, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_settings, (arg_log_context ? arg_log_context : context))\r\n\t\t\r\n\t\tthis.is_metrics_bus_collector = true\r\n\t\t\r\n\t\tthis.scheduler = undefined\r\n\t\t\r\n\t\tthis.metrics_msg_bus = new MetricsBusRecord('msg_bus', runtime.node.get_msg_bus())\r\n\t\tthis.metrics_metrics_bus = new MetricsBusRecord('metrics_bus', runtime.node.get_metrics_bus())\r\n\t\tthis.metrics_logs_bus = new MetricsBusRecord('logs_bus', runtime.node.get_logs_bus())\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Initialize metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tinit()\r\n\t{\r\n\t\tsuper.init()\r\n\t\t\r\n\t\t// CREATE REDUCER\r\n\t\tthis.metrics_reducer = new MetricsBusReducer()\r\n\t\tthis.metrics_state = new MetricsBusState()\r\n\t\t\r\n\t\t// SCHEDULE HOST METRICS\r\n\t\tconst self = this\r\n\t\tconst delay_in_sec = 30// TODO SET IN SETTINGS\r\n\t\t\r\n\t\tthis.metrics_msg_bus.before()\r\n\t\tthis.metrics_metrics_bus.before()\r\n\t\tthis.metrics_logs_bus.before()\r\n\t\t\r\n\t\tconst handler = () => {\r\n\t\t\tself.metrics_msg_bus.iteration()\r\n\t\t\tself.metrics_metrics_bus.iteration()\r\n\t\t\tself.metrics_logs_bus.iteration()\r\n\t\t\t\r\n\t\t\tself.send_metrics(self.metrics_msg_bus.get_name(),     [self.metrics_msg_bus.get_values()])\r\n\t\t\tself.send_metrics(self.metrics_metrics_bus.get_name(), [self.metrics_metrics_bus.get_values()])\r\n\t\t\tself.send_metrics(self.metrics_logs_bus.get_name(),    [self.metrics_logs_bus.get_values()])\r\n\t\t\t\r\n\t\t\t// console.log(this.metrics_msg_bus.get_values(), 'metrics_msg_bus')\r\n\t\t\t// console.log(this.metrics_metrics_bus.get_values(), 'metrics_metrics_bus')\r\n\t\t\t// console.log(this.metrics_logs_bus.get_values(), 'metrics_logs_bus')\r\n\t\t}\r\n\t\t\r\n\t\tthis.scheduler = setInterval(handler, delay_in_sec * 1000)\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush pending metrics records.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tflush()\r\n\t{\r\n\t\tsuper.flush()\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush and close the metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tclose()\r\n\t{\r\n\t\tthis.metrics_msg_bus.after()\r\n\t\tthis.metrics_metrics_bus.after()\r\n\t\tthis.metrics_logs_bus.after()\r\n\t\t\r\n\t\tclearInterval(this.scheduler)\r\n\t\tsuper.close()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_collector.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 155,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/bus/metrics_bus_collector.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_collector.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 156,
    "kind": "class",
    "name": "MetricsBusCollector",
    "memberof": "js/metrics/bus/metrics_bus_collector.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_collector.js",
    "importStyle": "MetricsBusCollector",
    "description": "Metrics Bus collector class.",
    "lineNumber": 18,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_collector.js~MetricsCollector"
    ]
  },
  {
    "__docId__": 157,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#constructor",
    "access": null,
    "description": "Metrics collector constructor.",
    "lineNumber": 27,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsCollector"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "instance settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 158,
    "kind": "member",
    "name": "is_metrics_bus_collector",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#is_metrics_bus_collector",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 159,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 33,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 160,
    "kind": "member",
    "name": "metrics_msg_bus",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#metrics_msg_bus",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 161,
    "kind": "member",
    "name": "metrics_metrics_bus",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#metrics_metrics_bus",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 162,
    "kind": "member",
    "name": "metrics_logs_bus",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#metrics_logs_bus",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 163,
    "kind": "method",
    "name": "init",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#init",
    "access": null,
    "description": "Initialize metrics collector.",
    "lineNumber": 47,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 164,
    "kind": "member",
    "name": "metrics_reducer",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 52,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 165,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 53,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 166,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 77,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 167,
    "kind": "method",
    "name": "flush",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#flush",
    "access": null,
    "description": "Flush pending metrics records.",
    "lineNumber": 87,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 168,
    "kind": "method",
    "name": "close",
    "memberof": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_collector.js~MetricsBusCollector#close",
    "access": null,
    "description": "Flush and close the metrics collector.",
    "lineNumber": 99,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 169,
    "kind": "file",
    "name": "js/metrics/bus/metrics_bus_record.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsRecord from '../base/metrics_record'\r\n\r\n\r\n\r\n// const context = 'server/metrics/bus/metrics_bus_record'\r\n\r\n\r\n\r\n/**\r\n * @file Bus information metric class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsBusRecord extends MetricsRecord\r\n{\r\n    /**\r\n     * Metrics bus record constructor.\r\n\t * @extends MetricsRecord\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_bus_name, arg_bus)\r\n\t{\r\n\t\tsuper('bus')\r\n\t\t\r\n\t\tthis.is_metrics_record_bus  = true\r\n\t\t\r\n\t\tthis.bus_name = arg_bus_name\r\n\t\tthis.bus = arg_bus\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before request processing\r\n     */\r\n\tbefore()\r\n\t{\r\n\t\tthis.values = {\r\n\t\t\tmetric:'bus',\r\n\t\t\t\r\n\t\t\tbus_name:this.bus_name,\r\n\t\t\tts:new Date().getTime(),\r\n\t\t\t\r\n\t\t\tmsg_count:0,\r\n\t\t\tmsg_count_sum:0,\r\n\t\t\t\r\n\t\t\tmsg_size:0,\r\n\t\t\tmsg_size_sum:0,\r\n\t\t\t\r\n\t\t\terrors_count:0,\r\n\t\t\terrors_count_sum:0,\r\n\t\t\t\r\n\t\t\tsubscribers_count:0,\r\n\t\t\tsubscribers_count_sum:0\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration\r\n     */\r\n\titeration()\r\n\t{\r\n\t\tif (! this.bus)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\tconst counters = this.bus.get_input_stream().get_and_reset_counters_snapshot()\r\n\t\t\r\n\t\tthis.values.ts = new Date().getTime()\r\n\t\t\r\n\t\tthis.values.msg_count         = counters.msg_count\r\n\t\tthis.values.msg_size          = counters.msg_size\r\n\t\tthis.values.errors_count      = counters.errors_count\r\n\t\tthis.values.subscribers_count = counters.subscribers_count\r\n\t\t\r\n\t\tthis.values.msg_count_sum         += this.values.msg_count\r\n\t\tthis.values.msg_size_sum          += this.values.msg_size\r\n\t\tthis.values.errors_count_sum      += this.values.errors_count\r\n\t\tthis.values.subscribers_count_sum += this.values.subscribers_count\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing\r\n     */\r\n\tafter()\r\n\t{\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_record.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 170,
    "kind": "class",
    "name": "MetricsBusRecord",
    "memberof": "js/metrics/bus/metrics_bus_record.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_record.js",
    "importStyle": "MetricsBusRecord",
    "description": "",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Bus information metric class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_record.js~MetricsRecord"
    ]
  },
  {
    "__docId__": 171,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#constructor",
    "access": null,
    "description": "Metrics bus record constructor.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsRecord"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_bus_name",
        "types": [
          "*"
        ]
      },
      {
        "name": "arg_bus",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 172,
    "kind": "member",
    "name": "is_metrics_record_bus",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#is_metrics_record_bus",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 173,
    "kind": "member",
    "name": "bus_name",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#bus_name",
    "access": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 174,
    "kind": "member",
    "name": "bus",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#bus",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 175,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#before",
    "access": null,
    "description": "Executed before request processing",
    "lineNumber": 38,
    "params": []
  },
  {
    "__docId__": 176,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#values",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{\"metric\": string, \"bus_name\": *, \"ts\": *, \"msg_count\": *, \"msg_count_sum\": *, \"msg_size\": *, \"msg_size_sum\": *, \"errors_count\": *, \"errors_count_sum\": *, \"subscribers_count\": *, \"subscribers_count_sum\": *}"
      ]
    }
  },
  {
    "__docId__": 177,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#iteration",
    "access": null,
    "description": "Executed at each request processing iteration",
    "lineNumber": 64,
    "params": []
  },
  {
    "__docId__": 178,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_record.js~MetricsBusRecord#after",
    "access": null,
    "description": "Executed after request processing",
    "lineNumber": 90,
    "params": []
  },
  {
    "__docId__": 179,
    "kind": "file",
    "name": "js/metrics/bus/metrics_bus_reducer.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsReducer from '../base/metrics_reducer'\r\nimport MetricsBusState from './metrics_bus_state'\r\n\r\n\r\n// const context = 'server/metrics/bus/metrics_bus_reducer'\r\n\r\n\r\n\r\n/**\r\n * @file Reducer class for Bus metrics collect.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsBusReducer extends MetricsReducer\r\n{\r\n\t/**\r\n\t * Reducer for Bus metric class.\r\n\t * @extends MetricsReducer\r\n\t * \r\n\t * @returns {nothing}\r\n\t*/\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('bus')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce metrics records into a state.\r\n\t * \r\n\t * @param {object} arg_state_values - metrics state values.\r\n\t * @param {object} arg_metrics_values - metrics records values.\r\n\t * @param {MetricsState} arg_state - metrics state.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce_one_record(arg_state_values, arg_metrics_values, arg_state)\r\n\t{\r\n\t\tconst bus_name = arg_metrics_values.bus_name\r\n\t\targ_state.add_bus_name(bus_name)\r\n\t\t\r\n\t\targ_state_values = arg_state.get_values()[bus_name]\r\n\t\t\r\n\t\tconst count = arg_state_values.aggregated.count + 1\r\n\t\t\r\n\t\tconst new_bus_name_values = {\r\n\t\t\tmetric:'bus',\r\n\t\t\t\r\n\t\t\tlast_metric:arg_metrics_values,\r\n\t\t\t\r\n\t\t\taggregated:{\r\n\t\t\t\tcount:count,\r\n\t\t\t\t\r\n\t\t\t\tbus_name:arg_metrics_values.bus_name,\r\n\t\t\t\tts:new Date().getTime(),\r\n\t\t\t\t\r\n\t\t\t\tmsg_count:arg_metrics_values.msg_count_sum,\r\n\t\t\t\tmsg_size:arg_metrics_values.msg_size_sum,\r\n\t\t\t\terrors_count:arg_metrics_values.errors_count_sum,\r\n\t\t\t\tsubscribers_count:arg_metrics_values.subscribers_count\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlet state_values = arg_state.get_values()\r\n\t\tstate_values[bus_name] = new_bus_name_values\r\n\t\treturn state_values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new state instance.\r\n\t * \r\n\t * @returns {MetricsBusState} - a new bus metrics state instance.\r\n\t */\r\n\tcreate_state()\r\n\t{\r\n\t\treturn new MetricsBusState()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_reducer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 180,
    "kind": "class",
    "name": "MetricsBusReducer",
    "memberof": "js/metrics/bus/metrics_bus_reducer.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_reducer.js",
    "importStyle": "MetricsBusReducer",
    "description": "",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Reducer class for Bus metrics collect."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_reducer.js~MetricsReducer"
    ]
  },
  {
    "__docId__": 181,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer#constructor",
    "access": null,
    "description": "Reducer for Bus metric class.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsReducer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 182,
    "kind": "method",
    "name": "reduce_one_record",
    "memberof": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer#reduce_one_record",
    "access": null,
    "description": "Reduce metrics records into a state.",
    "lineNumber": 39,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      },
      {
        "nullable": null,
        "types": [
          "MetricsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 183,
    "kind": "method",
    "name": "create_state",
    "memberof": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_reducer.js~MetricsBusReducer#create_state",
    "access": null,
    "description": "Create a new state instance.",
    "lineNumber": 78,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsBusState} - a new bus metrics state instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MetricsBusState"
      ],
      "spread": false,
      "description": "a new bus metrics state instance."
    }
  },
  {
    "__docId__": 184,
    "kind": "file",
    "name": "js/metrics/bus/metrics_bus_state.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsState from '../base/metrics_state'\r\n\r\n\r\nconst context = 'server/metrics/bus/metrics_bus_state'\r\n\r\n\r\n\r\n/**\r\n * @file Bus metrics state class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricBusState extends MetricsState\r\n{\r\n    /**\r\n     * Metrics bus state constructor.\r\n\t * @extends MetricsState\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('bus')\r\n\t\t\r\n\t\tthis.is_metrics_bus_state = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Add bus_name state values.\r\n\t * \r\n\t * @param {string} arg_bus_name - bus name valid string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tadd_bus_name(arg_bus_name)\r\n\t{\r\n\t\tassert( T.isString(arg_bus_name) && arg_bus_name.length > 0, context + ':add_bus_name: bad bus_name string')\r\n\t\t\r\n\t\tif (arg_bus_name in this.values)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\t// CREATE HOSTNAME VALUES\r\n\t\tthis.values[arg_bus_name] = {}\r\n\t\t\r\n\t\t// LAST SNAPSHOT\r\n\t\tthis.values[arg_bus_name].last_metric = undefined\r\n\t\t\r\n\t\t\r\n\t\t// CONTINUOUS AGGREGATION\r\n\t\tconst aggregated_init = {\r\n\t\t\tbus_name:undefined,\r\n\t\t\t\r\n\t\t\tcount:0,\r\n\t\t\t\r\n\t\t\tmsg_count:0,\r\n\t\t\tmsg_size:0,\r\n\t\t\terrors_count:0,\r\n\t\t\tsubscribers_count:0\r\n\t\t}\r\n\t\tthis.values[arg_bus_name].aggregated = Object.assign({}, aggregated_init)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_state.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 185,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/bus/metrics_bus_state.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_state.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_state.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 186,
    "kind": "class",
    "name": "MetricBusState",
    "memberof": "js/metrics/bus/metrics_bus_state.js",
    "static": true,
    "longname": "js/metrics/bus/metrics_bus_state.js~MetricBusState",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/bus/metrics_bus_state.js",
    "importStyle": "MetricBusState",
    "description": "",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Bus metrics state class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_state.js~MetricsState"
    ]
  },
  {
    "__docId__": 187,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/bus/metrics_bus_state.js~MetricBusState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_state.js~MetricBusState#constructor",
    "access": null,
    "description": "Metrics bus state constructor.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsState"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 188,
    "kind": "member",
    "name": "is_metrics_bus_state",
    "memberof": "js/metrics/bus/metrics_bus_state.js~MetricBusState",
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_state.js~MetricBusState#is_metrics_bus_state",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 189,
    "kind": "method",
    "name": "add_bus_name",
    "memberof": "js/metrics/bus/metrics_bus_state.js~MetricBusState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/bus/metrics_bus_state.js~MetricBusState#add_bus_name",
    "access": null,
    "description": "Add bus_name state values.",
    "lineNumber": 44,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_bus_name",
        "description": "bus name valid string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 190,
    "kind": "file",
    "name": "js/metrics/host/metrics_host_collector.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsCollector from '../base/metrics_collector'\r\nimport MetricsHostRecord from './metrics_host_record'\r\nimport MetricsHostState from './metrics_host_state'\r\nimport MetricsHostReducer from './metrics_host_reducer'\r\n\r\n\r\nconst context = 'server/metrics/host/metrics_host_collector'\r\n\r\n\r\n\r\n/**\r\n * Metrics Host collector class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHostCollector extends MetricsCollector\r\n{\r\n    /**\r\n     * Metrics collector constructor.\r\n\t * @extends MetricsCollector\r\n\t * @param {Immutable.Map} arg_settings - instance settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_settings, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_settings, (arg_log_context ? arg_log_context : context))\r\n\t\t\r\n\t\tthis.is_metrics_host_collector = true\r\n\t\t\r\n\t\tthis.scheduler = undefined\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Initialize metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tinit()\r\n\t{\r\n\t\tsuper.init()\r\n\t\t\r\n\t\t// CREATE REDUCER\r\n\t\tthis.metrics_reducer = new MetricsHostReducer()\r\n\t\tthis.metrics_state = new MetricsHostState()\r\n\t\tthis.metrics_record = new MetricsHostRecord()\r\n\t\t\r\n\t\t// SCHEDULE HOST METRICS\r\n\t\tconst self = this\r\n\t\tconst delay_in_sec = 30 // TODO SET IN SETTINGS\r\n\t\tthis.metrics_record.before()\r\n\t\t\r\n\t\tconst handler = () => {\r\n\t\t\tthis.metrics_record.iteration()\r\n\t\t\t\r\n\t\t\tself.send_metrics(self.metrics_record.get_name(), [self.metrics_record.get_values()])\r\n\t\t}\r\n\t\t\r\n\t\tthis.scheduler = setInterval(handler, delay_in_sec * 1000)\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush pending metrics records.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tflush()\r\n\t{\r\n\t\tsuper.flush()\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush and close the metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tclose()\r\n\t{\r\n\t\tclearInterval(this.scheduler)\r\n\t\tthis.metrics_record.after()\r\n\t\tsuper.close()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/host/metrics_host_collector.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 191,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/host/metrics_host_collector.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_collector.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 192,
    "kind": "class",
    "name": "MetricsHostCollector",
    "memberof": "js/metrics/host/metrics_host_collector.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_collector.js",
    "importStyle": "MetricsHostCollector",
    "description": "Metrics Host collector class.",
    "lineNumber": 17,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_collector.js~MetricsCollector"
    ]
  },
  {
    "__docId__": 193,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#constructor",
    "access": null,
    "description": "Metrics collector constructor.",
    "lineNumber": 26,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsCollector"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "instance settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 194,
    "kind": "member",
    "name": "is_metrics_host_collector",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#is_metrics_host_collector",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 195,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 196,
    "kind": "method",
    "name": "init",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#init",
    "access": null,
    "description": "Initialize metrics collector.",
    "lineNumber": 42,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 197,
    "kind": "member",
    "name": "metrics_reducer",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 198,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 199,
    "kind": "member",
    "name": "metrics_record",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#metrics_record",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 200,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 62,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 201,
    "kind": "method",
    "name": "flush",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#flush",
    "access": null,
    "description": "Flush pending metrics records.",
    "lineNumber": 72,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 202,
    "kind": "method",
    "name": "close",
    "memberof": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_collector.js~MetricsHostCollector#close",
    "access": null,
    "description": "Flush and close the metrics collector.",
    "lineNumber": 84,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 203,
    "kind": "file",
    "name": "js/metrics/host/metrics_host_record.js",
    "content": "// NPM IMPORTS\r\nimport os from 'os'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsRecord from '../base/metrics_record'\r\n\r\n\r\n\r\n// const context = 'server/metrics/host/metrics_host_record'\r\n\r\n\r\n\r\n/**\r\n * @file Host information metric class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHostRecord extends MetricsRecord\r\n{\r\n    /**\r\n     * Metrics host record constructor.\r\n\t * @extends MetricsRecord\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('host')\r\n\t\t\r\n\t\tthis.is_metrics_record_host  = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before request processing\r\n     */\r\n\tbefore()\r\n\t{\r\n\t\tconst cpus = os.cpus()\r\n\t\t\r\n\t\tconst cpus_user_mean = cpus.reduce( (prev = 0, current/*, index, all*/) => prev + current.times.user, 0) / cpus.length\r\n\t\tconst cpus_nice_mean = cpus.reduce( (prev = 0, current/*, index, all*/) => prev + current.times.nice, 0) / cpus.length\r\n\t\tconst cpus_sys_mean = cpus.reduce(  (prev = 0, current/*, index, all*/) => prev + current.times.sys,  0) / cpus.length\r\n\t\tconst cpus_idle_mean = cpus.reduce( (prev = 0, current/*, index, all*/) => prev + current.times.idle, 0) / cpus.length\r\n\t\tconst cpus_irq_mean = cpus.reduce(  (prev = 0, current/*, index, all*/) => prev + current.times.irq,  0) / cpus.length\r\n\t\t\r\n\t\tthis.values = {\r\n\t\t\tmetric:'host',\r\n\t\t\t\r\n\t\t\thostname:os.hostname(),\r\n\t\t\tts:new Date().getTime(),\r\n\t\t\t\r\n\t\t\tcpus_arch:os.arch(),\r\n\t\t\tcpus_count:cpus.length,\r\n\t\t\t\r\n\t\t\tcpus_user:cpus_user_mean,\r\n\t\t\tcpus_nice:cpus_nice_mean,\r\n\t\t\tcpus_sys:cpus_sys_mean,\r\n\t\t\tcpus_idle:cpus_idle_mean,\r\n\t\t\tcpus_irq:cpus_irq_mean\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration\r\n     */\r\n\titeration()\r\n\t{\r\n\t\tthis.before()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing\r\n     */\r\n\tafter()\r\n\t{\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/host/metrics_host_record.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 204,
    "kind": "class",
    "name": "MetricsHostRecord",
    "memberof": "js/metrics/host/metrics_host_record.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_record.js",
    "importStyle": "MetricsHostRecord",
    "description": "",
    "lineNumber": 18,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Host information metric class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_record.js~MetricsRecord"
    ]
  },
  {
    "__docId__": 205,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#constructor",
    "access": null,
    "description": "Metrics host record constructor.",
    "lineNumber": 26,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsRecord"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 206,
    "kind": "member",
    "name": "is_metrics_record_host",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#is_metrics_record_host",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 207,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#before",
    "access": null,
    "description": "Executed before request processing",
    "lineNumber": 38,
    "params": []
  },
  {
    "__docId__": 208,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#values",
    "access": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{\"metric\": string, \"hostname\": *, \"ts\": *, \"cpus_arch\": *, \"cpus_count\": *, \"cpus_user\": *, \"cpus_nice\": *, \"cpus_sys\": *, \"cpus_idle\": *, \"cpus_irq\": *}"
      ]
    }
  },
  {
    "__docId__": 209,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#iteration",
    "access": null,
    "description": "Executed at each request processing iteration",
    "lineNumber": 69,
    "params": []
  },
  {
    "__docId__": 210,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/host/metrics_host_record.js~MetricsHostRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_record.js~MetricsHostRecord#after",
    "access": null,
    "description": "Executed after request processing",
    "lineNumber": 78,
    "params": []
  },
  {
    "__docId__": 211,
    "kind": "file",
    "name": "js/metrics/host/metrics_host_reducer.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsReducer from '../base/metrics_reducer'\r\nimport MetricsHostState from './metrics_host_state'\r\n\r\n\r\n// const context = 'server/metrics/host/metrics_host_reducer'\r\n\r\n\r\n\r\n/**\r\n * @file Reducer class for Host metrics collect.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHostReducer extends MetricsReducer\r\n{\r\n\t/**\r\n\t * Reducer for Host metric class.\r\n\t * @extends MetricsReducer\r\n\t * \r\n\t * @returns {nothing}\r\n\t*/\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('host')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce metrics records into a state.\r\n\t * \r\n\t * @param {object} arg_state_values - metrics state values.\r\n\t * @param {object} arg_metrics_values - metrics records values.\r\n\t * @param {MetricsState} arg_state - metrics state.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce_one_record(arg_state_values, arg_metrics_values, arg_state)\r\n\t{\r\n\t\tconst hostname = arg_metrics_values.hostname\r\n\t\targ_state.add_hostname(hostname)\r\n\t\t\r\n\t\targ_state_values = arg_state.get_values()[hostname]\r\n\t\t\r\n\t\tconst count = arg_state_values.aggregated.count + 1\r\n\t\t\r\n\t\tconst new_hostname_values = {\r\n\t\t\tlast_metric:arg_metrics_values,\r\n\t\t\taggregated:{\r\n\t\t\t\tcount:count,\r\n\t\t\t\t\r\n\t\t\t\thostname:arg_metrics_values.hostname,\r\n\t\t\t\tts:new Date().getTime(),\r\n\t\t\t\t\r\n\t\t\t\tcpus_arch:arg_metrics_values.cpus_arch,\r\n\t\t\t\tcpus_count:arg_metrics_values.cpus_count,\r\n\t\t\t\t\r\n\t\t\t\tcpus_user_sum:arg_state_values.aggregated.cpus_user_sum + arg_metrics_values.cpus_user,\r\n\t\t\t\tcpus_nice_sum:arg_state_values.aggregated.cpus_nice_sum + arg_metrics_values.cpus_nice,\r\n\t\t\t\tcpus_sys_sum :arg_state_values.aggregated.cpus_sys_sum  + arg_metrics_values.cpus_sys,\r\n\t\t\t\tcpus_idle_sum:arg_state_values.aggregated.cpus_idle_sum + arg_metrics_values.cpus_idle,\r\n\t\t\t\tcpus_irq_sum :arg_state_values.aggregated.cpus_irq_sum  + arg_metrics_values.cpus_irq,\r\n\t\t\t\t\r\n\t\t\t\tcpus_user_mean:(arg_state_values.aggregated.cpus_user_sum + arg_metrics_values.cpus_user)/count,\r\n\t\t\t\tcpus_nice_mean:(arg_state_values.aggregated.cpus_nice_sum + arg_metrics_values.cpus_nice)/count,\r\n\t\t\t\tcpus_sys_mean :(arg_state_values.aggregated.cpus_sys_sum  + arg_metrics_values.cpus_sys)/count,\r\n\t\t\t\tcpus_idle_mean:(arg_state_values.aggregated.cpus_idle_sum + arg_metrics_values.cpus_idle)/count,\r\n\t\t\t\tcpus_irq_mean :(arg_state_values.aggregated.cpus_irq_sum  + arg_metrics_values.cpus_irq)/count\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlet state_values = arg_state.get_values()\r\n\t\tstate_values[hostname] = new_hostname_values\r\n\t\treturn state_values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new state instance.\r\n\t * \r\n\t * @returns {MetricsHostState} - a new host metrics state instance.\r\n\t */\r\n\tcreate_state()\r\n\t{\r\n\t\treturn new MetricsHostState()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/host/metrics_host_reducer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 212,
    "kind": "class",
    "name": "MetricsHostReducer",
    "memberof": "js/metrics/host/metrics_host_reducer.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_reducer.js",
    "importStyle": "MetricsHostReducer",
    "description": "",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Reducer class for Host metrics collect."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_reducer.js~MetricsReducer"
    ]
  },
  {
    "__docId__": 213,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer#constructor",
    "access": null,
    "description": "Reducer for Host metric class.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsReducer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 214,
    "kind": "method",
    "name": "reduce_one_record",
    "memberof": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer#reduce_one_record",
    "access": null,
    "description": "Reduce metrics records into a state.",
    "lineNumber": 39,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      },
      {
        "nullable": null,
        "types": [
          "MetricsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 215,
    "kind": "method",
    "name": "create_state",
    "memberof": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_reducer.js~MetricsHostReducer#create_state",
    "access": null,
    "description": "Create a new state instance.",
    "lineNumber": 85,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsHostState} - a new host metrics state instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MetricsHostState"
      ],
      "spread": false,
      "description": "a new host metrics state instance."
    }
  },
  {
    "__docId__": 216,
    "kind": "file",
    "name": "js/metrics/host/metrics_host_state.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsState from '../base/metrics_state'\r\n\r\n\r\nconst context = 'server/metrics/host/metrics_host_state'\r\n\r\n\r\n\r\n/**\r\n * @file Host metrics state class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricHostState extends MetricsState\r\n{\r\n    /**\r\n     * Metrics host state constructor.\r\n\t * @extends MetricsState\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('host')\r\n\t\t\r\n\t\tthis.is_metrics_host_state = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Add hostname state values.\r\n\t * \r\n\t * @param {string} arg_hostname - hostname valid string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tadd_hostname(arg_hostname)\r\n\t{\r\n\t\tassert( T.isString(arg_hostname) && arg_hostname.length > 0, context + ':add_hostname: bad hostname string')\r\n\t\t\r\n\t\tif (arg_hostname in this.values)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\t// CREATE HOSTNAME VALUES\r\n\t\tthis.values[arg_hostname] = {}\r\n\t\t\r\n\t\t// LAST SNAPSHOT\r\n\t\tthis.values[arg_hostname].last_metric = undefined\r\n\t\t\r\n\t\t\r\n\t\t// CONTINUOUS AGGREGATION\r\n\t\tconst aggregated_init = {\r\n\t\t\thostname:undefined,\r\n\t\t\t\r\n\t\t\tcount:0,\r\n\t\t\t\r\n\t\t\tcpus_arch:undefined,\r\n\t\t\tcpus_count:undefined,\r\n\t\t\t\r\n\t\t\tcpus_user_sum:0,\r\n\t\t\tcpus_nice_sum:0,\r\n\t\t\tcpus_sys_sum:0,\r\n\t\t\tcpus_idle_sum:0,\r\n\t\t\tcpus_irq_sum:0,\r\n\t\t\t\r\n\t\t\tcpus_user_mean:undefined,\r\n\t\t\tcpus_nice_mean:undefined,\r\n\t\t\tcpus_sys_mean:undefined,\r\n\t\t\tcpus_idle_mean:undefined,\r\n\t\t\tcpus_irq_mean:undefined\r\n\t\t}\r\n\t\tthis.values[arg_hostname].aggregated = Object.assign({}, aggregated_init)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/host/metrics_host_state.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 217,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/host/metrics_host_state.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_state.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_state.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 218,
    "kind": "class",
    "name": "MetricHostState",
    "memberof": "js/metrics/host/metrics_host_state.js",
    "static": true,
    "longname": "js/metrics/host/metrics_host_state.js~MetricHostState",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/host/metrics_host_state.js",
    "importStyle": "MetricHostState",
    "description": "",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Host metrics state class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_state.js~MetricsState"
    ]
  },
  {
    "__docId__": 219,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/host/metrics_host_state.js~MetricHostState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_state.js~MetricHostState#constructor",
    "access": null,
    "description": "Metrics host state constructor.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsState"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 220,
    "kind": "member",
    "name": "is_metrics_host_state",
    "memberof": "js/metrics/host/metrics_host_state.js~MetricHostState",
    "static": false,
    "longname": "js/metrics/host/metrics_host_state.js~MetricHostState#is_metrics_host_state",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 221,
    "kind": "method",
    "name": "add_hostname",
    "memberof": "js/metrics/host/metrics_host_state.js~MetricHostState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/host/metrics_host_state.js~MetricHostState#add_hostname",
    "access": null,
    "description": "Add hostname state values.",
    "lineNumber": 44,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_hostname",
        "description": "hostname valid string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 222,
    "kind": "file",
    "name": "js/metrics/http/metrics_http_collector.js",
    "content": "// NPM IMPORTS\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime            from '../../base/runtime'\r\nimport MetricsCollector   from '../base/metrics_collector'\r\nimport MetricsHttpRecord  from './metrics_http_record'\r\nimport MetricsHttpState   from './metrics_http_state'\r\nimport MetricsHttpReducer from './metrics_http_reducer'\r\n\r\n\r\n\r\nconst context = 'server/metrics/host/metrics_host_collector'\r\n\r\n\r\n\r\n/**\r\n * Metrics Http collector class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHttpCollector extends MetricsCollector\r\n{\r\n    /**\r\n     * Metrics collector constructor.\r\n\t * @extends MetricsCollector\r\n\t * @param {Immutable.Map} arg_settings - instance settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_settings, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_settings, (arg_log_context ? arg_log_context : context))\r\n\t\t\r\n\t\tthis.is_metrics_http_collector = true\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Initialize metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tinit()\r\n\t{\r\n\t\tsuper.init()\r\n\t\t\r\n\t\tthis.metrics_reducer = new MetricsHttpReducer()\r\n\t\tthis.metrics_state = new MetricsHttpState()\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush pending metrics records.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tflush()\r\n\t{\r\n\t\tsuper.flush()\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush and close the metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tclose()\r\n\t{\r\n\t\tsuper.close()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before main request processing\r\n     * {object}   server object (Server base class instance)\r\n     */\r\n\tstatic create_middleware(arg_server)\r\n\t{\r\n        // HANDLE END OF REQUEST PROCESSING FOR RESTIFY SERVER\r\n\t\tif (arg_server.is_restify_server)\r\n\t\t{\r\n\t\t\targ_server.server.on('after',\r\n\t\t\t\tfunction (req/*, res*/)\r\n\t\t\t\t{\r\n\t\t\t\t\t// console.log('MetricHttp middleware on finish')\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet metric = req.devapt_metrics\r\n                    // console.log(metric, 'metric')\r\n                    \r\n\t\t\t\t\tif (metric)\r\n                    {\r\n\t\t\t\t\t\tmetric.after()\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// console.log('MetricHttp middleware on finish, leave')\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t\t\r\n        \r\n        // MIDDLEWARE FUNCTION\r\n\t\treturn function(req, res, next)\r\n\t\t{\r\n\t\t\t// console.log('MetricHttp middleware created')\r\n\t\t\t\r\n\t\t\tlet metric = new MetricsHttpRecord(req, res)\r\n\t\t\t// metric.server = arg_server\r\n\t\t\tmetric.before()\r\n\t\t\tmetric.values.server.node_name = arg_server.node.get_name()\r\n\t\t\tmetric.values.server.server_name = arg_server.get_name()\r\n\t\t\t\r\n\t\t\t// HANDLE END OF REQUEST PROCESSING FOR EXPRESS SERVER\r\n\t\t\tif (arg_server.is_express_server)\r\n\t\t\t{\r\n\t\t\t\tres.on('finish',\r\n\t\t\t\t\tfunction ()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// console.log('MetricHttp middleware on finish')\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet metric = res.devapt_metrics\r\n                        // console.log(metric, 'metric')\r\n                        \r\n\t\t\t\t\t\tconst metrics_server_name = runtime.node.get_metrics_server_name()\r\n\t\t\t\t\t\t// console.log(context + ':create_middleware:metrics srv=%s', metrics_server_name)\r\n\r\n\t\t\t\t\t\tif (metric)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmetric.after()\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst type = metric.get_name()\r\n\t\t\t\t\t\t\tconst values = T.isArray(metric.get_values()) ? metric.get_values() : [metric.get_values()]\r\n\t\t\t\t\t\t\t// console.log(context + ':create_middleware:target=%s type=%s', metrics_server_name, type)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\targ_server.send_metrics(metrics_server_name, type, values)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn next()\r\n\t\t}\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/http/metrics_http_collector.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 223,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/http/metrics_http_collector.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_collector.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 224,
    "kind": "class",
    "name": "MetricsHttpCollector",
    "memberof": "js/metrics/http/metrics_http_collector.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_collector.js",
    "importStyle": "MetricsHttpCollector",
    "description": "Metrics Http collector class.",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_collector.js~MetricsCollector"
    ]
  },
  {
    "__docId__": 225,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#constructor",
    "access": null,
    "description": "Metrics collector constructor.",
    "lineNumber": 33,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsCollector"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "instance settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 226,
    "kind": "member",
    "name": "is_metrics_http_collector",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#is_metrics_http_collector",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 227,
    "kind": "method",
    "name": "init",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#init",
    "access": null,
    "description": "Initialize metrics collector.",
    "lineNumber": 47,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 228,
    "kind": "member",
    "name": "metrics_reducer",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 51,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 229,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 52,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 230,
    "kind": "method",
    "name": "flush",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#flush",
    "access": null,
    "description": "Flush pending metrics records.",
    "lineNumber": 62,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 231,
    "kind": "method",
    "name": "close",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector#close",
    "access": null,
    "description": "Flush and close the metrics collector.",
    "lineNumber": 74,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 232,
    "kind": "method",
    "name": "create_middleware",
    "memberof": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "js/metrics/http/metrics_http_collector.js~MetricsHttpCollector.create_middleware",
    "access": null,
    "description": "Executed before main request processing\n{object}   server object (Server base class instance)",
    "lineNumber": 85,
    "params": [
      {
        "name": "arg_server",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 233,
    "kind": "file",
    "name": "js/metrics/http/metrics_http_record.js",
    "content": "// NPM IMPORTS\r\nimport uuid from 'uuid'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsRecord from '../base/metrics_record'\r\n\r\n\r\n\r\n// const context = 'server/metrics/http/metrics_http_record'\r\n\r\n\r\n\r\n/**\r\n * Metric class for HTTP servers.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHttpRecord extends MetricsRecord\r\n{\r\n    /**\r\n     * MetricsHttpRecord constructor.\r\n\t * @extends Metric\r\n\t * \r\n     * @param {object}  Http request object (Request class instance).\r\n     * @param {object}  Http response object (Response class instance).\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_request, arg_response)\r\n\t{\r\n\t\tsuper('http')\r\n\t\t\r\n\t\tthis.is_metrics_http_record  =true\r\n\t\t\r\n\t\tthis.server = undefined\r\n\t\t\r\n\t\tthis.req = arg_request\r\n\t\tthis.res = arg_response\r\n\t\t\r\n\t\tthis.req.devapt_metrics = this\r\n\t\tthis.res.devapt_metrics = this\r\n\t}\r\n\t\r\n    \r\n\t/**\r\n     * Executed before request processing.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tbefore()\r\n\t{\r\n\t\t// REQUEST VERSION\r\n\t\tthis.values.version = require('../../../../package.json').version\r\n\t\r\n\t\t// IDENTIFICATION\r\n\t\tthis.values.metric = 'http'\r\n\t\tthis.values.id = this.get_id()\r\n\t\tthis.values.pid = this.get_pid()\r\n\t\t\r\n\t\t// DURATION\r\n\t\tthis.values.ts_begin = Date.now()\r\n\t\tthis.values.ts_end = null\r\n\t\tthis.values.latency = null\r\n\t\r\n\t\t// SERVICE IDENTIFICATION\r\n\t\tthis.values.service = {}\r\n\t\tthis.values.service.name = 'unknow service'\r\n\t\tthis.values.service.url = this.req.originalUrl || this.req.url\r\n\t\tthis.values.service.method = this.req.method\r\n\t\tthis.values.service.http_version = this.req.httpVersion \r\n\t\tthis.values.service.route = this.req.route ? this.req.route.path : 'unknown route'\r\n\t\t\r\n\t\t// SERVER IDENTIFICATION\r\n\t\tthis.values.server = {}\r\n\t\tthis.values.server.node_name = null\r\n\t\tthis.values.server.server_name = null\r\n\t\r\n\t\t// CLIENT IDENTIFICATION\r\n\t\tthis.values.client = {}\r\n\t\tthis.values.client.ip = this.get_ip()\r\n\t\tthis.values.client.port = this.get_port()\r\n\t\tthis.values.client.security_token = null\r\n\t\tthis.values.client.user_name = this.req.user_name || null\r\n\t\tthis.values.client.user_id = null\r\n\t\tthis.values.client.browser = this.req.headers['user-agent']\r\n\t\tthis.values.client.referrer = this.req.headers['referer'] || this.req.headers['referrer']\r\n\t\r\n\t\t// RESPONSE\r\n\t\tthis.values.response = {}\r\n\t\tthis.values.response.status = null\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\titeration()\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tafter()\r\n\t{\r\n\t\tthis.values.ts_end = Date.now()\r\n\t\t\r\n\t\tthis.values.response.status = this.res.statusCode\r\n\r\n\t\tthis.values.latency = this.get_latency()\r\n\t\t\r\n\t\t// this.values.server.node_name = this.server.node.get_name()\r\n\t\t// this.values.server.server_name = this.server.get_name()\r\n\t}\r\n    \r\n\t\r\n\t/**\r\n     * Returns process id.\r\n\t * \r\n\t * @returns {string} - process PID.\r\n     */\r\n\tget_pid()\r\n\t{\r\n\t\treturn process.pid\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Returns request id or a self generated unique id.\r\n\t * \r\n\t * @returns {string} - request ID.\r\n     */\r\n\tget_id()\r\n\t{\r\n\t\treturn ( T.isFunction(this.req.getId) && this.req.getId() )\r\n\t\t\t|| ( this.req.id && T.isFunction(this.req.id) && this.req.id() )\r\n\t\t\t|| this.req.id\r\n\t\t\t|| uuid.v1()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Returns client ip address or undefined.\r\n\t * \r\n\t * @returns {string} - server IP.\r\n     */\r\n\tget_ip()\r\n\t{\r\n\t\treturn this.req.ip\r\n\t\t\t|| this.req._remoteAddress\r\n\t\t\t|| (this.req.connection && this.req.connection.remoteAddress)\r\n\t\t\t|| undefined\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Returns client port or undefined.\r\n\t * \r\n\t * @returns {string} - server port.\r\n     */\r\n\tget_port()\r\n\t{\r\n\t\treturn (this.req.connection && this.req.connection.remotePort)\r\n\t\t\t|| undefined\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Returns client security token or undefined.\r\n\t * \r\n\t * @returns {string} - security token.\r\n     */\r\n\tget_token()\r\n\t{\r\n\t\treturn this.req.secure\r\n\t\t\t|| undefined\r\n\t}\r\n\t\r\n\t/**\r\n     * Returns processing latency (response time).\r\n\t * \r\n\t * @returns {string} - request processing latency.\r\n     */\r\n\tget_latency()\r\n\t{\r\n\t\tvar latency = this.res.get('Response-Time')\r\n\t\tif ( typeof (latency) !== 'number' )\r\n\t\t\tlatency = this.values.ts_end - this.values.ts_begin\r\n\t\t\r\n\t\treturn latency\r\n\t}\r\n}\r\n\r\n\r\n\r\n// RESTIFY AUDIT FORMAT\r\n/*\r\nconst r = {\r\n\t\"name\":\"audit\",\"hostname\":\"LFR000867\",\r\n\t\"pid\":6552,\"audit\":true,\r\n\t\"level\":30,\r\n\t\"remoteAddress\":\"::ffff:127.0.0.1\",\"remotePort\":58229,\r\n\t\"req_id\":\"8d407e4e-5ee7-4c46-b7e9-e046d268a4c7\",\r\n\t\"req\":{\r\n\t\t\"method\":\"GET\",\"url\":\"/tutorial-rest/api/v1/views/\",\r\n\t\t\"headers\":{\r\n\t\t\t\"user-agent\":\"curl/7.30.0\",\r\n\t\t\t\"host\":\"localhost:8080\",\r\n\t\t\t\"accept\":'* / *'\r\n\t\t},\r\n\t\t\"httpVersion\":\"1.1\",\r\n\t\t\"trailers\":{},\r\n\t\t\"version\":\"* \",\r\n\t\t\"timers\":{\r\n\t\t\t\"parseAccept\":78,\"parseAuthorization\":5,\"parseQueryString\":19,\"_jsonp\":153,\"gzip\":43,\"readBody\":21,\r\n\t\t\t\"parseBody\":9,\"bunyan\":39,\"rateLimit\":175,\"exec_http\":1763\r\n\t\t}\r\n\t},\r\n\t\"res\":{\r\n\t\t\"statusCode\":200,\r\n\t\t\"headers\":{\r\n\t\t\t\"content- type\":\"application/ json\",\r\n\t\t\t\"content- length\":662\r\n\t\t},\r\n\t\t\"trailer\":false\r\n\t},\r\n\t\"latency\":0,\r\n\t\"_audit\":true,\r\n\t\"msg\":\"handled: 200\",\r\n\t\"time\":\"2015- 12 - 17T16: 10:00.583Z\",\r\n\t\"v\":0\r\n}\r\n*/",
    "static": true,
    "longname": "js/metrics/http/metrics_http_record.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 234,
    "kind": "class",
    "name": "MetricsHttpRecord",
    "memberof": "js/metrics/http/metrics_http_record.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_record.js",
    "importStyle": "MetricsHttpRecord",
    "description": "Metric class for HTTP servers.",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_record.js~MetricsRecord"
    ]
  },
  {
    "__docId__": 235,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#constructor",
    "access": null,
    "description": "MetricsHttpRecord constructor.",
    "lineNumber": 32,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Metric"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "Http",
        "description": "request object (Request class instance)."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "Http",
        "description": "response object (Response class instance)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 236,
    "kind": "member",
    "name": "is_metrics_http_record",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#is_metrics_http_record",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 237,
    "kind": "member",
    "name": "server",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#server",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 238,
    "kind": "member",
    "name": "req",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#req",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 239,
    "kind": "member",
    "name": "res",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#res",
    "access": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 240,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#before",
    "access": null,
    "description": "Executed before request processing.",
    "lineNumber": 53,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 241,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#iteration",
    "access": null,
    "description": "Executed at each request processing iteration.",
    "lineNumber": 102,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 242,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#after",
    "access": null,
    "description": "Executed after request processing.",
    "lineNumber": 112,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 243,
    "kind": "method",
    "name": "get_pid",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_pid",
    "access": null,
    "description": "Returns process id.",
    "lineNumber": 130,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - process PID."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "process PID."
    }
  },
  {
    "__docId__": 244,
    "kind": "method",
    "name": "get_id",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_id",
    "access": null,
    "description": "Returns request id or a self generated unique id.",
    "lineNumber": 141,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - request ID."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "request ID."
    }
  },
  {
    "__docId__": 245,
    "kind": "method",
    "name": "get_ip",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_ip",
    "access": null,
    "description": "Returns client ip address or undefined.",
    "lineNumber": 155,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - server IP."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "server IP."
    }
  },
  {
    "__docId__": 246,
    "kind": "method",
    "name": "get_port",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_port",
    "access": null,
    "description": "Returns client port or undefined.",
    "lineNumber": 169,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - server port."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "server port."
    }
  },
  {
    "__docId__": 247,
    "kind": "method",
    "name": "get_token",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_token",
    "access": null,
    "description": "Returns client security token or undefined.",
    "lineNumber": 181,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - security token."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "security token."
    }
  },
  {
    "__docId__": 248,
    "kind": "method",
    "name": "get_latency",
    "memberof": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_record.js~MetricsHttpRecord#get_latency",
    "access": null,
    "description": "Returns processing latency (response time).",
    "lineNumber": 192,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - request processing latency."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "request processing latency."
    }
  },
  {
    "__docId__": 249,
    "kind": "file",
    "name": "js/metrics/http/metrics_http_reducer.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsReducer from '../base/metrics_reducer'\r\nimport MetricHttpState from './metrics_http_state'\r\n\r\n\r\nconst context = 'server/metrics/http/metric_hhtp_reducer'\r\n\r\n\r\n\r\n/**\r\n * @file Reducer class for HTTP metrics collect.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricHttpReducer extends MetricsReducer\r\n{\r\n\t/**\r\n\t * Reducer for HTTP metric class.\r\n\t * @extends MetricsReducer\r\n\t * \r\n\t * @returns {nothing}\r\n\t*/\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('http')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce metrics records into a state.\r\n\t * \r\n\t * @param {object} arg_state_values - metrics state values.\r\n\t * @param {object} arg_metrics_values - metrics records values.\r\n\t * @param {MetricsState} arg_state - metrics state.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce_one_record(arg_state_values, arg_metrics_values/*, arg_state*/)\r\n\t{\r\n\t\tassert( T.isObject(arg_metrics_values) && arg_metrics_values.metric == 'http', context + ':reduce:bad metric object')\r\n\t\t\r\n\t\t// VERSIONS\r\n\t\tthis.incr(arg_state_values, 'version_counters', arg_metrics_values.version)\r\n\t\t\r\n\t\t// REQUEST UUID\r\n\t\targ_state_values.id_counter += 1\r\n\t\tthis.incr(arg_state_values, 'pid_counters', arg_metrics_values.pid)\r\n\t\t\r\n\t\t// DURATIONS\r\n\t\targ_state_values.latency_counter += 1\r\n\t\targ_state_values.latency_sum += arg_metrics_values.latency\r\n\t\targ_state_values.latency_mean = arg_state_values.latency_sum / arg_state_values.latency_counter\r\n\t\targ_state_values.latency_min = (arg_metrics_values.latency < arg_state_values.latency_min) ? arg_metrics_values.latency : arg_state_values.latency_min\r\n\t\targ_state_values.latency_max = (arg_metrics_values.latency > arg_state_values.latency_max) ? arg_metrics_values.latency : arg_state_values.latency_max\r\n\t\t\r\n\t\t// SERVICE IDENTIFICATION\r\n\t\tthis.incr(arg_state_values, 'service_name_counters', arg_metrics_values.service.name)\r\n\t\tthis.incr(arg_state_values, 'service_url_counters', arg_metrics_values.service.url)\r\n\t\tthis.incr(arg_state_values, 'service_method_counters', arg_metrics_values.service.method)\r\n\t\tthis.incr(arg_state_values, 'service_http_version_counters', arg_metrics_values.service.http_version)\r\n\t\tthis.incr(arg_state_values, 'service_route_counters', arg_metrics_values.service.route)\r\n\t\t\r\n\t\t// SERVER IDENTIFICATION\r\n\t\tthis.incr(arg_state_values, 'server_node_name_counters', arg_metrics_values.server.node_name)\r\n\t\tthis.incr(arg_state_values, 'server_server_name_counters', arg_metrics_values.server.server_name)\r\n\t\t\r\n\t\t// CLIENT IDENTIFICATION\r\n\t\tthis.incr(arg_state_values, 'client_user_name_counters', arg_metrics_values.client.user_name)\r\n\t\tthis.incr(arg_state_values, 'client_user_id_counters', arg_metrics_values.client.user_id)\r\n\t\tthis.incr(arg_state_values, 'client_browser_counters', arg_metrics_values.client.browser)\r\n\t\tthis.incr(arg_state_values, 'client_referrer_counters', arg_metrics_values.client.referrer)\r\n\t\r\n\t\t// RESPONSE\r\n\t\tthis.incr(arg_state_values, 'response_status_counters', arg_metrics_values.response.status)\r\n\t\t\r\n\t\treturn arg_state_values\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new state instance.\r\n\t * \r\n\t * @returns {MetricsHttpState} - a new host metrics state instance.\r\n\t */\r\n\tcreate_state()\r\n\t{\r\n\t\treturn new MetricHttpState()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/http/metrics_http_reducer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 250,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/http/metrics_http_reducer.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_reducer.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_reducer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 251,
    "kind": "class",
    "name": "MetricHttpReducer",
    "memberof": "js/metrics/http/metrics_http_reducer.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_reducer.js",
    "importStyle": "MetricHttpReducer",
    "description": "",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Reducer class for HTTP metrics collect."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_reducer.js~MetricsReducer"
    ]
  },
  {
    "__docId__": 252,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer#constructor",
    "access": null,
    "description": "Reducer for HTTP metric class.",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsReducer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 253,
    "kind": "method",
    "name": "reduce_one_record",
    "memberof": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer#reduce_one_record",
    "access": null,
    "description": "Reduce metrics records into a state.",
    "lineNumber": 45,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      },
      {
        "nullable": null,
        "types": [
          "MetricsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 254,
    "kind": "method",
    "name": "create_state",
    "memberof": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_reducer.js~MetricHttpReducer#create_state",
    "access": null,
    "description": "Create a new state instance.",
    "lineNumber": 92,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsHttpState} - a new host metrics state instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MetricsHttpState"
      ],
      "spread": false,
      "description": "a new host metrics state instance."
    }
  },
  {
    "__docId__": 255,
    "kind": "file",
    "name": "js/metrics/http/metrics_http_state.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsState from '../base/metrics_state'\r\n\r\n\r\n\r\n// const context = 'server/metrics/http/metrics_http_state'\r\n\r\n\r\n\r\n/**\r\n * @file Metrics http state base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsHttpState extends MetricsState\r\n{\r\n    /**\r\n     * Metrics http state constructor.\r\n\t * @extends MetricsState\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('http')\r\n\t\t\r\n\t\tthis.is_metrics_http_state = true\r\n\t\t\r\n\t\t// REQUEST VERSIONS\r\n\t\tthis.values.version_counters = {}\r\n\t\t\r\n\t\t// REQUEST UUID\r\n\t\tthis.values.id_counter = 0\r\n\t\tthis.values.pid_counters = {} // { pid1:counter1, pid2:counter2 }\r\n\t\t\r\n\t\t// DURATIONS\r\n\t\tthis.values.latency_min = 0\r\n\t\tthis.values.latency_counter = 0\r\n\t\tthis.values.latency_sum = 0\r\n\t\tthis.values.latency_mean = 0\r\n\t\tthis.values.latency_max = 0\r\n\t\t\r\n\t\t// SERVICE IDENTIFICATION\r\n\t\tthis.values.service_name_counters = {}\r\n\t\tthis.values.service_url_counters = {}\r\n\t\tthis.values.service_method_counters = {}\r\n\t\tthis.values.service_http_version_counters = {} \r\n\t\tthis.values.service_route_counters = {}\r\n\t\t\r\n\t\t// SERVER IDENTIFICATION\r\n\t\tthis.values.server_node_name_counters = {}\r\n\t\tthis.values.server_server_name_counters = {}\r\n\t\t\r\n\t\t// CLIENT IDENTIFICATION\r\n\t\tthis.values.client_user_name_counters = {}\r\n\t\tthis.values.client_user_id_counters = {}\r\n\t\tthis.values.client_browser_counters = {}\r\n\t\tthis.values.client_referrer_counters = {}\r\n\t\r\n\t\t// RESPONSE\r\n\t\tthis.values.response_status_counters = {}\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/http/metrics_http_state.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 256,
    "kind": "class",
    "name": "MetricsHttpState",
    "memberof": "js/metrics/http/metrics_http_state.js",
    "static": true,
    "longname": "js/metrics/http/metrics_http_state.js~MetricsHttpState",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/http/metrics_http_state.js",
    "importStyle": "MetricsHttpState",
    "description": "",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Metrics http state base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_state.js~MetricsState"
    ]
  },
  {
    "__docId__": 257,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/http/metrics_http_state.js~MetricsHttpState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/http/metrics_http_state.js~MetricsHttpState#constructor",
    "access": null,
    "description": "Metrics http state constructor.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsState"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 258,
    "kind": "member",
    "name": "is_metrics_http_state",
    "memberof": "js/metrics/http/metrics_http_state.js~MetricsHttpState",
    "static": false,
    "longname": "js/metrics/http/metrics_http_state.js~MetricsHttpState#is_metrics_http_state",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 259,
    "kind": "file",
    "name": "js/metrics/metric_duration.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsRecord from './base/metrics_record'\r\n\r\n\r\n/**\r\n * @file Duration metric class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricDuration extends MetricsRecord\r\n{\r\n    /**\r\n     * MetricDuration constructor.\r\n\t * @extends Metric\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before request processing\r\n     */\r\n\tbefore()\r\n\t{\r\n\t\tthis.ts_before = Date.now()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration\r\n     */\r\n\titeration()\r\n\t{\r\n\t\tthis.ts_at = this.ts_at ? this.ts_at : []\r\n\t\tthis.ts_at.push(Date.now())\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing\r\n     */\r\n\tafter()\r\n\t{\r\n\t\tthis.ts_after = Date.now()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Returns metrics values plain object\r\n     */\r\n\tget_values()\r\n\t{\r\n\t\tif (! this.ts_at)\r\n\t\t{\r\n\t\t\treturn { metric:'duration', start:this.ts_before, duration:(this.ts_after - this.ts_before) }\r\n\t\t}\r\n\t\t\r\n\t\tlet at = []\r\n\t\tlet prev = this.ts_before\r\n\t\tthis.ts_at.forEach(\r\n\t\t\t(ts) => {\r\n\t\t\t\tat.push(ts - prev)\r\n\t\t\t\tprev = ts\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\treturn { metric:'duration', start:this.ts_before, duration:(this.ts_after - this.ts_before), iterations:at }\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/metric_duration.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 260,
    "kind": "class",
    "name": "MetricDuration",
    "memberof": "js/metrics/metric_duration.js",
    "static": true,
    "longname": "js/metrics/metric_duration.js~MetricDuration",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/metric_duration.js",
    "importStyle": "MetricDuration",
    "description": "",
    "lineNumber": 10,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Duration metric class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_record.js~MetricsRecord"
    ]
  },
  {
    "__docId__": 261,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#constructor",
    "access": null,
    "description": "MetricDuration constructor.",
    "lineNumber": 17,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Metric"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 262,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#before",
    "access": null,
    "description": "Executed before request processing",
    "lineNumber": 26,
    "params": []
  },
  {
    "__docId__": 263,
    "kind": "member",
    "name": "ts_before",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#ts_before",
    "access": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 264,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#iteration",
    "access": null,
    "description": "Executed at each request processing iteration",
    "lineNumber": 35,
    "params": []
  },
  {
    "__docId__": 265,
    "kind": "member",
    "name": "ts_at",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#ts_at",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 266,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#after",
    "access": null,
    "description": "Executed after request processing",
    "lineNumber": 45,
    "params": []
  },
  {
    "__docId__": 267,
    "kind": "member",
    "name": "ts_after",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#ts_after",
    "access": null,
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 268,
    "kind": "method",
    "name": "get_values",
    "memberof": "js/metrics/metric_duration.js~MetricDuration",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/metric_duration.js~MetricDuration#get_values",
    "access": null,
    "description": "Returns metrics values plain object",
    "lineNumber": 54,
    "params": [],
    "return": {
      "types": [
        "{\"metric\": string, \"start\": *, \"duration\": *, \"iterations\": *}"
      ]
    }
  },
  {
    "__docId__": 269,
    "kind": "file",
    "name": "js/metrics/nodejs/metrics_nodejs_collector.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsCollector from '../base/metrics_collector'\r\nimport MetricsNodeJsRecord from './metrics_nodejs_record'\r\nimport MetricsNodeJsState from './metrics_nodejs_state'\r\nimport MetricsNodeJsReducer from './metrics_nodejs_reducer'\r\n\r\n\r\nconst context = 'server/metrics/nodejs/metrics_nodejs_collector'\r\n\r\n\r\n\r\n/**\r\n * Metrics Node collector class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsNodeJsCollector extends MetricsCollector\r\n{\r\n    /**\r\n     * Metrics collector constructor.\r\n\t * @extends MetricsCollector\r\n\t * @param {Immutable.Map} arg_settings - instance settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_settings, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_settings, (arg_log_context ? arg_log_context : context))\r\n\t\t\r\n\t\tthis.is_metrics_node_collector = true\r\n\t\t\r\n\t\tthis.scheduler = undefined\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Initialize metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tinit()\r\n\t{\r\n\t\tsuper.init()\r\n\t\t\r\n\t\t// CREATE REDUCER\r\n\t\tthis.metrics_reducer = new MetricsNodeJsReducer()\r\n\t\tthis.metrics_state = new MetricsNodeJsState()\r\n\t\tthis.metrics_record = new MetricsNodeJsRecord()\r\n\t\t\r\n\t\t// SCHEDULE HOST METRICS\r\n\t\tconst self = this\r\n\t\tconst delay_in_sec = 30 // TODO SET IN SETTINGS\r\n\t\tthis.metrics_record.before()\r\n\t\tconst handler = () => {\r\n\t\t\tthis.metrics_record.iteration()\r\n\t\t\t\r\n\t\t\tself.send_metrics(self.metrics_record.get_name(), [self.metrics_record.get_values()])\r\n\t\t}\r\n\t\t\r\n\t\tthis.scheduler = setInterval(handler, delay_in_sec * 1000)\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush pending metrics records.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tflush()\r\n\t{\r\n\t\tsuper.flush()\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Flush and close the metrics collector.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tclose()\r\n\t{\r\n\t\tclearInterval(this.scheduler)\r\n\t\tthis.metrics_record.after()\r\n\t\tsuper.close()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 270,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_collector.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 271,
    "kind": "class",
    "name": "MetricsNodeJsCollector",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_collector.js",
    "importStyle": "MetricsNodeJsCollector",
    "description": "Metrics Node collector class.",
    "lineNumber": 17,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_collector.js~MetricsCollector"
    ]
  },
  {
    "__docId__": 272,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#constructor",
    "access": null,
    "description": "Metrics collector constructor.",
    "lineNumber": 26,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsCollector"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "instance settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 273,
    "kind": "member",
    "name": "is_metrics_node_collector",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#is_metrics_node_collector",
    "access": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 274,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 275,
    "kind": "method",
    "name": "init",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#init",
    "access": null,
    "description": "Initialize metrics collector.",
    "lineNumber": 42,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 276,
    "kind": "member",
    "name": "metrics_reducer",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#metrics_reducer",
    "access": null,
    "description": null,
    "lineNumber": 47,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 277,
    "kind": "member",
    "name": "metrics_state",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#metrics_state",
    "access": null,
    "description": null,
    "lineNumber": 48,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 278,
    "kind": "member",
    "name": "metrics_record",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#metrics_record",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 279,
    "kind": "member",
    "name": "scheduler",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#scheduler",
    "access": null,
    "description": null,
    "lineNumber": 61,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 280,
    "kind": "method",
    "name": "flush",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#flush",
    "access": null,
    "description": "Flush pending metrics records.",
    "lineNumber": 71,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 281,
    "kind": "method",
    "name": "close",
    "memberof": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_collector.js~MetricsNodeJsCollector#close",
    "access": null,
    "description": "Flush and close the metrics collector.",
    "lineNumber": 83,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 282,
    "kind": "file",
    "name": "js/metrics/nodejs/metrics_nodejs_record.js",
    "content": "// NPM IMPORTS\r\nimport os from 'os'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../../base/runtime'\r\nimport MetricsRecord from '../base/metrics_record'\r\n\r\n\r\n\r\n// const context = 'server/metrics/nodejs/metrics_nodejs_record'\r\n\r\n\r\n\r\n/**\r\n * @file Node information metric class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsNodeJsRecord extends MetricsRecord\r\n{\r\n    /**\r\n     * Metrics node record constructor.\r\n\t * @extends MetricsRecord\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('nodejs')\r\n\t\t\r\n\t\tthis.is_metrics_record_node  = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n     * Executed before request processing\r\n     */\r\n\tbefore()\r\n\t{\r\n\t\tconst memory = process.memoryUsage()\r\n\t\t\r\n\t\tthis.values = {\r\n\t\t\tmetric:this.get_name(),\r\n\t\t\t\r\n\t\t\thostname:os.hostname(),\r\n\t\t\t\r\n\t\t\truntime_uid:runtime.get_uid(),\r\n\t\t\t\r\n\t\t\tts:new Date().getTime(),\r\n\t\t\t\r\n\t\t\tprocess_arch:process.arch,\r\n\t\t\tprocess_platform:process.platform,\r\n\t\t\t\r\n\t\t\tprocess_uptime:process.uptime(),\r\n\t\t\tprocess_pid:process.pid,\r\n\t\t\tprocess_version:process.version,\r\n\t\t\t\r\n\t\t\tprocess_memory_shared:memory.rss,\r\n\t\t\tprocess_memory_head_total:memory.heapTotal,\r\n\t\t\tprocess_memory_heap_used:memory.heapUsed\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed at each request processing iteration\r\n     */\r\n\titeration()\r\n\t{\r\n\t\tthis.before()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Executed after request processing\r\n     */\r\n\tafter()\r\n\t{\r\n\t}\r\n}",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 283,
    "kind": "class",
    "name": "MetricsNodeJsRecord",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_record.js",
    "importStyle": "MetricsNodeJsRecord",
    "description": "",
    "lineNumber": 19,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node information metric class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_record.js~MetricsRecord"
    ]
  },
  {
    "__docId__": 284,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#constructor",
    "access": null,
    "description": "Metrics node record constructor.",
    "lineNumber": 27,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsRecord"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 285,
    "kind": "member",
    "name": "is_metrics_record_node",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#is_metrics_record_node",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 286,
    "kind": "method",
    "name": "before",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#before",
    "access": null,
    "description": "Executed before request processing",
    "lineNumber": 39,
    "params": []
  },
  {
    "__docId__": 287,
    "kind": "member",
    "name": "values",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#values",
    "access": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{\"metric\": *, \"hostname\": *, \"runtime_uid\": *, \"ts\": *, \"process_arch\": *, \"process_platform\": *, \"process_uptime\": *, \"process_pid\": *, \"process_version\": *, \"process_memory_shared\": *, \"process_memory_head_total\": *, \"process_memory_heap_used\": *}"
      ]
    }
  },
  {
    "__docId__": 288,
    "kind": "method",
    "name": "iteration",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#iteration",
    "access": null,
    "description": "Executed at each request processing iteration",
    "lineNumber": 69,
    "params": []
  },
  {
    "__docId__": 289,
    "kind": "method",
    "name": "after",
    "memberof": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_record.js~MetricsNodeJsRecord#after",
    "access": null,
    "description": "Executed after request processing",
    "lineNumber": 78,
    "params": []
  },
  {
    "__docId__": 290,
    "kind": "file",
    "name": "js/metrics/nodejs/metrics_nodejs_reducer.js",
    "content": "// SERVER IMPORTS\r\nimport MetricsReducer from '../base/metrics_reducer'\r\nimport MetricsNodeJsState from './metrics_nodejs_state'\r\n\r\n\r\n// const context = 'server/metrics/nodejs/metrics_nodejs_reducer'\r\n\r\n\r\n\r\n/**\r\n * @file Reducer class for NodeJs metrics collect.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsNodeReducer extends MetricsReducer\r\n{\r\n\t/**\r\n\t * Reducer for NodeJs metric class.\r\n\t * @extends MetricsReducer\r\n\t * \r\n\t * @returns {nothing}\r\n\t*/\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('nodejs')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Reduce NodeJs metrics records into a state.\r\n\t * \r\n\t * @param {object} arg_state_values - metrics state values.\r\n\t * @param {object} arg_metrics_values - metrics records values.\r\n\t * @param {MetricsNodeJsState} arg_state - metrics state.\r\n\t * \r\n\t * @returns {object} - metrics state values.\r\n\t */\r\n\treduce_one_record(arg_state_values, arg_metrics_values, arg_state)\r\n\t{\r\n\t\tconst runtime_uid = arg_metrics_values.runtime_uid\r\n\t\targ_state.add_nodejs(runtime_uid)\r\n\t\t\r\n\t\targ_state_values = arg_state.get_values()[runtime_uid]\r\n\t\t\r\n\t\tconst count = arg_state_values.aggregated.count + 1\r\n\t\t\r\n\t\tconst new_values = {\r\n\t\t\tlast_metric:arg_metrics_values,\r\n\t\t\taggregated:{\r\n\t\t\t\tcount:count,\r\n\t\t\t\t\r\n\t\t\t\thostname:arg_metrics_values.hostname,\r\n\t\t\t\t\r\n\t\t\t\truntime_uid:arg_metrics_values.runtime_uid,\r\n\t\t\t\t\r\n\t\t\t\tts:new Date().getTime(),\r\n\t\t\t\t\r\n\t\t\t\tprocess_arch:arg_metrics_values.process_arch,\r\n\t\t\t\tprocess_platform:arg_metrics_values.process_platform,\r\n\t\t\t\t\r\n\t\t\t\tprocess_uptime_sum:arg_state_values.aggregated.process_uptime_sum + arg_metrics_values.process_uptime,\r\n\t\t\t\tprocess_uptime_mean:(arg_state_values.aggregated.process_uptime_sum + arg_metrics_values.process_uptime)/count,\r\n\t\t\t\t\r\n\t\t\t\tprocess_pid:arg_metrics_values.process_pid,\r\n\t\t\t\tprocess_version:arg_metrics_values.process_version,\r\n\t\t\t\t\r\n\t\t\t\tprocess_memory_shared_sum:arg_state_values.aggregated.process_memory_shared_sum + arg_metrics_values.process_memory_shared,\r\n\t\t\t\tprocess_memory_head_total_sum:arg_state_values.aggregated.process_memory_head_total_sum + arg_metrics_values.process_memory_head_total,\r\n\t\t\t\tprocess_memory_heap_used_sum:arg_state_values.aggregated.process_memory_heap_used_sum + arg_metrics_values.process_memory_heap_used,\r\n\t\t\t\t\r\n\t\t\t\tprocess_memory_shared_mean:(arg_state_values.aggregated.process_memory_shared_sum + arg_metrics_values.process_memory_shared)/count,\r\n\t\t\t\tprocess_memory_head_total_mean:(arg_state_values.aggregated.process_memory_head_total_sum + arg_metrics_values.process_memory_head_total)/count,\r\n\t\t\t\tprocess_memory_heap_used_mean:(arg_state_values.aggregated.process_memory_heap_used_sum + arg_metrics_values.process_memory_heap_used)/count\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tlet state_values = arg_state.get_values()\r\n\t\tstate_values[runtime_uid] = new_values\r\n\t\treturn state_values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new state instance.\r\n\t * \r\n\t * @returns {MetricsNodeJsState} - a new node metrics state instance.\r\n\t */\r\n\tcreate_state()\r\n\t{\r\n\t\treturn new MetricsNodeJsState()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_reducer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 291,
    "kind": "class",
    "name": "MetricsNodeReducer",
    "memberof": "js/metrics/nodejs/metrics_nodejs_reducer.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_reducer.js",
    "importStyle": "MetricsNodeReducer",
    "description": "",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Reducer class for NodeJs metrics collect."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_reducer.js~MetricsReducer"
    ]
  },
  {
    "__docId__": 292,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer#constructor",
    "access": null,
    "description": "Reducer for NodeJs metric class.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsReducer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 293,
    "kind": "method",
    "name": "reduce_one_record",
    "memberof": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer#reduce_one_record",
    "access": null,
    "description": "Reduce NodeJs metrics records into a state.",
    "lineNumber": 39,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - metrics state values."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state_values",
        "description": "metrics state values."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_metrics_values",
        "description": "metrics records values."
      },
      {
        "nullable": null,
        "types": [
          "MetricsNodeJsState"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "metrics state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "metrics state values."
    }
  },
  {
    "__docId__": 294,
    "kind": "method",
    "name": "create_state",
    "memberof": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_reducer.js~MetricsNodeReducer#create_state",
    "access": null,
    "description": "Create a new state instance.",
    "lineNumber": 90,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MetricsNodeJsState} - a new node metrics state instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MetricsNodeJsState"
      ],
      "spread": false,
      "description": "a new node metrics state instance."
    }
  },
  {
    "__docId__": 295,
    "kind": "file",
    "name": "js/metrics/nodejs/metrics_nodejs_state.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport MetricsState from '../base/metrics_state'\r\n\r\n\r\nconst context = 'server/metrics/nodejs/metrics_nodejs_state'\r\n\r\n\r\n\r\n/**\r\n * @file Node metrics state class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricNodeJsState extends MetricsState\r\n{\r\n    /**\r\n     * Metrics node state constructor.\r\n\t * @extends MetricsState\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor()\r\n\t{\r\n\t\tsuper('nodejs')\r\n\t\t\r\n\t\tthis.is_metrics_node_state = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Add nodename state values.\r\n\t * \r\n\t * @param {string} arg_runtime_uid - nodejs runtime uid.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tadd_nodejs(arg_runtime_uid)\r\n\t{\r\n\t\tassert( T.isString(arg_runtime_uid) && arg_runtime_uid.length > 0, context + ':add_nodename: bad nodejs runtime uid string')\r\n\t\t\r\n\t\tif (arg_runtime_uid in this.values)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\t// CREATE HOSTNAME VALUES\r\n\t\tthis.values[arg_runtime_uid] = {}\r\n\t\t\r\n\t\t// LAST SNAPSHOT\r\n\t\tthis.values[arg_runtime_uid].last_metric = undefined\r\n\t\t\r\n\t\t\r\n\t\t// CONTINUOUS AGGREGATION\r\n\t\tconst aggregated_init = {\r\n\t\t\thostname:undefined,\r\n\t\t\t\r\n\t\t\truntime_uid:undefined,\r\n\t\t\t\r\n\t\t\tcount:0,\r\n\t\t\t\r\n\t\t\tprocess_arch:undefined,\r\n\t\t\tprocess_platform:undefined,\r\n\t\t\t\r\n\t\t\tprocess_uptime_sum:0,\r\n\t\t\tprocess_uptime_mean:undefined,\r\n\t\t\t\r\n\t\t\tprocess_pid:undefined,\r\n\t\t\tprocess_version:undefined,\r\n\t\t\t\r\n\t\t\tprocess_memory_shared_sum:0,\r\n\t\t\tprocess_memory_head_total_sum:0,\r\n\t\t\tprocess_memory_heap_used_sum:0,\r\n\t\t\t\r\n\t\t\tprocess_memory_shared_mean:undefined,\r\n\t\t\tprocess_memory_head_total_mean:undefined,\r\n\t\t\tprocess_memory_heap_used_mean:undefined\r\n\t\t}\r\n\t\tthis.values[arg_runtime_uid].aggregated = Object.assign({}, aggregated_init)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 296,
    "kind": "variable",
    "name": "context",
    "memberof": "js/metrics/nodejs/metrics_nodejs_state.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_state.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 297,
    "kind": "class",
    "name": "MetricNodeJsState",
    "memberof": "js/metrics/nodejs/metrics_nodejs_state.js",
    "static": true,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/metrics/nodejs/metrics_nodejs_state.js",
    "importStyle": "MetricNodeJsState",
    "description": "",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node metrics state class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/metrics/base/metrics_state.js~MetricsState"
    ]
  },
  {
    "__docId__": 298,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState#constructor",
    "access": null,
    "description": "Metrics node state constructor.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "MetricsState"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 299,
    "kind": "member",
    "name": "is_metrics_node_state",
    "memberof": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState",
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState#is_metrics_node_state",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 300,
    "kind": "method",
    "name": "add_nodejs",
    "memberof": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/metrics/nodejs/metrics_nodejs_state.js~MetricNodeJsState#add_nodejs",
    "access": null,
    "description": "Add nodename state values.",
    "lineNumber": 44,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime_uid",
        "description": "nodejs runtime uid."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 301,
    "kind": "file",
    "name": "js/nodes/bus_node_feature.js",
    "content": "// NPM IMPORTS\r\n// import assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\n// import T                 from 'devapt-core-common/dist/js/utils/types'\r\nimport StreamBusEngine   from 'devapt-core-common/dist/js/messaging/stream_bus_engine'\r\nimport MessageBus        from 'devapt-core-common/dist/js/messaging/message_bus'\r\n\r\n// SERVER IMPORTS\r\nimport NodeFeature from './node_feature'\r\n\r\n\r\n\r\nlet context = 'server/nodes/bus_node_feature'\r\n\r\n\r\n\r\n/**\r\n * @file Node feature: manages a bus.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class BusNodeFeature extends NodeFeature\r\n{\r\n\t/**\r\n\t * Create a BusNodefeature instance.\r\n\t * @extends NodeFeature\r\n\t * \r\n\t * @param {Node} arg_node - node instance.\r\n\t * @param {string} arg_name - feature name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_node, arg_name)\r\n\t{\r\n\t\tsuper(arg_node, arg_name)\r\n\t\t\r\n\t\tthis.is_bus_node_feature = true\r\n\t\t\r\n\t\tthis.bus = undefined\r\n\t\tthis.bus_gateway = undefined\r\n\t\tthis.started_promise = undefined\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Get bus name.\r\n\t * \r\n\t * @returns {string} - unique bus name: node name + '_' + feature bus name\r\n\t */\r\n\tget_bus_unique_name()\r\n\t{\r\n\t\treturn this.node.get_name() + '_' + this.get_name()\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Create bus from settings.\r\n\t * \r\n\t * @returns {MessageBus} - created bus messages.\r\n\t */\r\n\tcreate_message_bus()\r\n\t{\r\n\t\tconst default_bus_package = 'default'\r\n\t\tconst default_bus_type = this.node.is_master ? 'Server' : 'Client'\r\n\r\n\t\tconst bus_name = this.get_name()\r\n\t\tconst bus_pkg  = this.node.get_setting(['master', bus_name, 'package'], default_bus_package)\r\n\t\t\r\n\t\tlet engine_settings = this.node.get_setting(['master', bus_name, 'settings'], fromJS({}) )\r\n\t\tengine_settings = engine_settings.set('runtime', this.node._runtime)\r\n\t\tengine_settings = engine_settings.set('type', this.node.get_setting(['master', bus_name, 'type'], default_bus_type) )\r\n\t\tengine_settings = engine_settings.set('host', this.node.get_setting(['master', bus_name, 'host'], undefined) )\r\n\t\tengine_settings = engine_settings.set('port', this.node.get_setting(['master', bus_name, 'port'], undefined) )\r\n\r\n\t\tconst bus_engine = bus_pkg == 'default' ? new StreamBusEngine(bus_name + '_engine', engine_settings, context, this.node.get_logger_manager()) : this.create_bus_engine(bus_pkg, bus_name + '_engine', engine_settings)\r\n\t\t\r\n\t\t// CREATE MESSAGES BUS FOR INTRA NODES COMMUNICATION\r\n\t\tconst bus_settings = { runtime:this.node._runtime, logger_manager:this.node.get_logger_manager() }\r\n\t\t\r\n\t\treturn new MessageBus(this.get_bus_unique_name(), bus_engine, bus_settings, context)\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Create a bus engine.\r\n\t * \r\n\t * @param {string} arg_package  - class package name.\r\n\t * @param {string} arg_name - bus engine name.\r\n\t * @param {object} arg_settings - bus engine settings.\r\n\t * \r\n\t * @returns {BusEngine} - Bus engine instance\r\n\t */\r\n\tcreate_bus_engine(arg_package, arg_name, arg_settings)\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\t// GET PACKAGE\r\n\t\t\tlet pkg = require(arg_package)\r\n\t\t\tif (! pkg)\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t\tif (pkg.default)\r\n\t\t\t{\r\n\t\t\t\tpkg = pkg.default\r\n\t\t\t}\r\n\r\n\t\t\t// CHECK TYPE\r\n\t\t\tif (! ('BusEngine' in pkg) )\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\r\n\t\t\t// GET CLASS\r\n\t\t\tconst pkg_class = pkg['BusEngine']\r\n\t\t\tif (! pkg_class)\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\r\n\t\t\treturn new pkg_class(arg_name, arg_settings, context, this.node.get_logger_manager())\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tconsole.warn('bad package name for bus engine:' + arg_package + ' with error:' + e.toString())\r\n\t\t}\r\n\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Load Node settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\t// const self = this\r\n\t\tthis.node.enter_group(':BusNodeFeature.load()')\r\n\t\t\r\n\t\tif (this.bus)\r\n\t\t{\r\n\t\t\tthis.node.leave_group(':BusNodeFeature.load():already loaded')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tsuper.load()\r\n\t\t\r\n\t\tthis.bus = this.create_message_bus()\r\n\t\tconsole.log(context + ':load:name=%s this.bus', this.get_name(), this.bus.get_name())\r\n\t\tthis.node.enable_on_bus(this.bus, 'default', 'receive_msg')\r\n\r\n\t\t// CREATE MESSAGES GATEWAY FOR INTER NODES COMMUNICATION\r\n\t\t/*if ( T.isString(bus_pkg) && T.isString(bus_type) && bus_host && bus_port)\r\n\t\t{\r\n\t\t\tif (bus_type != 'local')\r\n\t\t\t{\r\n\t\t\t\tconst gw_settings = this.node.get_setting_js(['master', bus_name])\r\n\t\t\t\tgw_settings.runtime = this.node._runtime\r\n\t\t\t\tgw_settings.logger_manager = this.node.get_logger_manager()\r\n\t\t\t\tconst gw_name = this.get_bus_unique_name() + '_gateway'\r\n\t\t\t\t\r\n\t\t\t\t// console.log(context + ':load:bus_type != local and gw_settings=%o', gw_settings)\r\n\r\n\t\t\t\tthis.bus_gateway = this.create_bus_gateway(bus_pkg, bus_type, gw_name, gw_settings, context)\r\n\t\t\t\tassert( T.isObject(this.bus_gateway), context + ':bad bus gateway instance')\r\n\t\t\t\tconst gw_started_promise = this.bus_gateway.enable()\r\n\r\n\t\t\t\tassert(gw_started_promise, context + ':load:bad gateway started promise')\r\n\t\t\t\t\r\n\t\t\t\tthis.started_promise = this.bus_gateway.started_promise.then(\r\n\t\t\t\t\t() => {\r\n\r\n\t\t\t\t\t\tself.bus_gateway.add_locale_bus(self.bus)\r\n\t\t\t\t\t\tself.bus.add_gateway(self.bus_gateway)\r\n\r\n\t\t\t\t\t\tassert( T.isFunction(self.bus_gateway.subscribe), context + ':load:bad self.bus_gateway.subscribe function')\r\n\t\t\t\t\t\tself.bus_gateway.subscribe(self.node.get_name())\r\n\r\n\t\t\t\t\t\tif (! self.node.is_master)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.bus_gateway.add_remote_target(self.node.master_name)\r\n\t\t\t\t\t\t\tself.node.remote_nodes[self.node.master_name] = self.node.get_setting_js(['master'])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}*/\r\n\t\t\r\n\t\tthis.node.leave_group(':BusNodeFeature.load()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Starts node bus.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstart()\r\n\t{\r\n\t\tthis.node.enter_group(':BusNodeFeature.start')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':BusNodeFeature.start')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Stops node bus.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstop()\r\n\t{\r\n\t\tthis.node.enter_group(':BusNodeFeature.stop')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':BusNodeFeature.stop')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a bus gateway.\r\n\t * \r\n\t * @param {string} arg_gw_pkg  - gateway class package name.\r\n\t * @param {string} arg_gw_type - gateway type (Client or Server).\r\n\t * @param {string} arg_gw_name - gateway name.\r\n\t * @param {object} arg_gw_settings - gateway settings.\r\n\t * \r\n\t * @returns {BusGateway} - BusClient or BusServer instance\r\n\t */\r\n/*\tcreate_bus_gateway(arg_gw_pkg, arg_gw_type, arg_gw_name, arg_gw_settings)\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\t// GET PACKAGE\r\n\t\t\tlet pkg = require('../../../../' + arg_gw_pkg)\r\n\t\t\tif (! pkg)\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t\tif (pkg.default)\r\n\t\t\t{\r\n\t\t\t\tpkg = pkg.default\r\n\t\t\t}\r\n\r\n\t\t\t// CHECK TYPE\r\n\t\t\tif (! (arg_gw_type in pkg) )\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\r\n\t\t\t// GET CLASS\r\n\t\t\tconst pkg_class = pkg[arg_gw_type]\r\n\t\t\tif (! pkg_class)\r\n\t\t\t{\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\r\n\t\t\treturn new pkg_class(arg_gw_name, arg_gw_settings, context)\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tconsole.warn('bad package name for bus gateway:' + arg_gw_pkg + ' with error:' + e.toString())\r\n\t\t}\r\n\r\n\t\treturn undefined\r\n\t}*/\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/bus_node_feature.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 302,
    "kind": "variable",
    "name": "context",
    "memberof": "js/nodes/bus_node_feature.js",
    "static": true,
    "longname": "js/nodes/bus_node_feature.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/bus_node_feature.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 303,
    "kind": "class",
    "name": "BusNodeFeature",
    "memberof": "js/nodes/bus_node_feature.js",
    "static": true,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/bus_node_feature.js",
    "importStyle": "BusNodeFeature",
    "description": "",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node feature: manages a bus."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/nodes/node_feature.js~NodeFeature"
    ]
  },
  {
    "__docId__": 304,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#constructor",
    "access": null,
    "description": "Create a BusNodefeature instance.",
    "lineNumber": 35,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "NodeFeature"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_node",
        "description": "node instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 305,
    "kind": "member",
    "name": "is_bus_node_feature",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#is_bus_node_feature",
    "access": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 306,
    "kind": "member",
    "name": "bus",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#bus",
    "access": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 307,
    "kind": "member",
    "name": "bus_gateway",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#bus_gateway",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 308,
    "kind": "member",
    "name": "started_promise",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#started_promise",
    "access": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 309,
    "kind": "method",
    "name": "get_bus_unique_name",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#get_bus_unique_name",
    "access": null,
    "description": "Get bus name.",
    "lineNumber": 52,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - unique bus name: node name + '_' + feature bus name"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "unique bus name: node name + '_' + feature bus name"
    }
  },
  {
    "__docId__": 310,
    "kind": "method",
    "name": "create_message_bus",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#create_message_bus",
    "access": null,
    "description": "Create bus from settings.",
    "lineNumber": 64,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{MessageBus} - created bus messages."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "MessageBus"
      ],
      "spread": false,
      "description": "created bus messages."
    }
  },
  {
    "__docId__": 311,
    "kind": "method",
    "name": "create_bus_engine",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#create_bus_engine",
    "access": null,
    "description": "Create a bus engine.",
    "lineNumber": 97,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{BusEngine} - Bus engine instance"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_package",
        "description": "class package name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "bus engine name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "bus engine settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "BusEngine"
      ],
      "spread": false,
      "description": "Bus engine instance"
    }
  },
  {
    "__docId__": 312,
    "kind": "method",
    "name": "load",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#load",
    "access": null,
    "description": "Load Node settings.",
    "lineNumber": 142,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 313,
    "kind": "member",
    "name": "bus",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#bus",
    "access": null,
    "description": null,
    "lineNumber": 155,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 314,
    "kind": "method",
    "name": "start",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#start",
    "access": null,
    "description": "Starts node bus.",
    "lineNumber": 206,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 315,
    "kind": "method",
    "name": "stop",
    "memberof": "js/nodes/bus_node_feature.js~BusNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/bus_node_feature.js~BusNodeFeature#stop",
    "access": null,
    "description": "Stops node bus.",
    "lineNumber": 221,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 316,
    "kind": "file",
    "name": "js/nodes/metrics_node_feature.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport NodeFeature from './node_feature'\r\nimport MetricsServer from '../servers/metrics_server'\r\n\r\n\r\n\r\nlet context = 'server/nodes/metrics_node_feature'\r\n\r\n\r\n\r\n/**\r\n * @file Node feature: manages a set of metrics.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsNodeFeature extends NodeFeature\r\n{\r\n\t/**\r\n\t * Create a MetricsNodefeature instance.\r\n\t * @extends NodeFeature\r\n\t * \r\n\t * @param {Node} arg_node - node instance.\r\n\t * @param {string} arg_name - feature name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_node, arg_name)\r\n\t{\r\n\t\tsuper(arg_node, arg_name)\r\n\t\t\r\n\t\tthis.is_metrics_node_feature = true\r\n\t\t\r\n\t\tthis.metrics_server = undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load Node settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\tthis.node.enter_group(':MetricsNodeFeature.load()')\r\n\t\t\r\n\t\tsuper.load()\r\n\t\t\r\n\t\tconst metrics_bus_host = this.node.get_setting(['master', 'metrics_bus', 'host'], undefined)\r\n\t\tconst metrics_bus_port = this.node.get_setting(['master', 'metrics_bus', 'port'], undefined)\r\n\t\r\n\t\t// CREATE METRICS SERVER\r\n\t\tconst metrics_server_settings = {\r\n\t\t\t'protocole':'bus',\r\n\t\t\t'host':metrics_bus_host ? metrics_bus_host : 'localhost',\r\n\t\t\t'port':metrics_bus_port ? metrics_bus_port : 9900,\r\n\t\t\t'type':'metrics',\r\n\t\t\t'runtime':this.node.get_runtime(),\r\n\t\t\t'logger_manager':this.node.get_logger_manager()\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(metrics_server_settings.runtime.is_base_runtime ? 'RUNTIME FOUND FOR SERVER ' + 'metrics_server' : '!!! RUNTIME NOT FOUND FOR SERVER ' + 'metrics_server')\r\n\t\tconsole.log(metrics_server_settings.logger_manager.is_logger_manager ? 'LOGGER MANAGER FOUND FOR SERVER ' + 'metrics_server' : '!!! LOGGER MANAGER NOT FOUND FOR SERVER ' + 'metrics_server')\r\n\t\t\r\n\t\tthis.metrics_server = new MetricsServer('metrics_server', fromJS(metrics_server_settings) )\r\n\t\tthis.metrics_server.node = this.node\r\n\t\tthis.metrics_server.load()\r\n\r\n\t\t// this.node.metrics_bus_feature.bus.get_bus_engine().channel_add('metrics')\r\n\t\tthis.node.metrics_bus_feature.bus.msg_register(this.metrics_server, 'metrics')\r\n\t\t// this.node.enable_locale_target('metrics_server')\r\n\t\tthis.metrics_server.enable_metrics()\r\n\t\t\r\n\t\tthis.node.leave_group(':MetricsNodeFeature.load()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get metrics server instance.\r\n\t * @returns {Server} - Metrics server.\r\n\t */\r\n\tget_metrics_server()\r\n\t{\r\n\t\tassert( T.isObject(this.metrics_server), context + ':MetricsNodeFeature.get_metrics_server:bad metrics_server object')\r\n\t\treturn this.metrics_server\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Starts node metrics.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstart()\r\n\t{\r\n\t\tthis.node.enter_group(':MetricsNodeFeature.start')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':MetricsNodeFeature.start')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Stops node metrics.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstop()\r\n\t{\r\n\t\tthis.node.enter_group(':MetricsNodeFeature.stop')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':MetricsNodeFeature.stop')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/metrics_node_feature.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 317,
    "kind": "variable",
    "name": "context",
    "memberof": "js/nodes/metrics_node_feature.js",
    "static": true,
    "longname": "js/nodes/metrics_node_feature.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/metrics_node_feature.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 318,
    "kind": "class",
    "name": "MetricsNodeFeature",
    "memberof": "js/nodes/metrics_node_feature.js",
    "static": true,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/metrics_node_feature.js",
    "importStyle": "MetricsNodeFeature",
    "description": "",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node feature: manages a set of metrics."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/nodes/node_feature.js~NodeFeature"
    ]
  },
  {
    "__docId__": 319,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#constructor",
    "access": null,
    "description": "Create a MetricsNodefeature instance.",
    "lineNumber": 34,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "NodeFeature"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_node",
        "description": "node instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 320,
    "kind": "member",
    "name": "is_metrics_node_feature",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#is_metrics_node_feature",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 321,
    "kind": "member",
    "name": "metrics_server",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#metrics_server",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 322,
    "kind": "method",
    "name": "load",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#load",
    "access": null,
    "description": "Load Node settings.",
    "lineNumber": 50,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 323,
    "kind": "member",
    "name": "metrics_server",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#metrics_server",
    "access": null,
    "description": null,
    "lineNumber": 72,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 324,
    "kind": "method",
    "name": "get_metrics_server",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#get_metrics_server",
    "access": null,
    "description": "Get metrics server instance.",
    "lineNumber": 90,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Server} - Metrics server."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Server"
      ],
      "spread": false,
      "description": "Metrics server."
    }
  },
  {
    "__docId__": 325,
    "kind": "method",
    "name": "start",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#start",
    "access": null,
    "description": "Starts node metrics.",
    "lineNumber": 103,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 326,
    "kind": "method",
    "name": "stop",
    "memberof": "js/nodes/metrics_node_feature.js~MetricsNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/metrics_node_feature.js~MetricsNodeFeature#stop",
    "access": null,
    "description": "Stops node metrics.",
    "lineNumber": 118,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 327,
    "kind": "file",
    "name": "js/nodes/node.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T                  from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime            from '../base/runtime'\r\nimport NodeMessaging      from './node_messaging'\r\nimport MetricsNodeFeature from './metrics_node_feature'\r\nimport ServersNodeFeature from './servers_node_feature'\r\nimport BusNodeFeature     from './bus_node_feature'\r\n\r\n\r\n\r\nlet context = 'server/nodes/node'\r\n\r\n\r\nconst STATE_CREATED = 'NODE_IS_CREATED'\r\n// const STATE_REGISTERING = 'NODE_IS_REGISTERING_TO_MASTER'\r\n// const STATE_WAITING = 'NODE_IS_WAITING_ITS_SETTINGS'\r\nconst STATE_LOADING = 'NODE_IS_LOADING_ITS_SETTINGS'\r\nconst STATE_LOADED = 'NODE_HAS_LOADED_ITS_SETTINGS'\r\nconst STATE_STARTING = 'NODE_IS_STARTING'\r\nconst STATE_STARTED = 'NODE_IS_STARTED'\r\nconst STATE_STOPPING = 'NODE_IS_STOPPING'\r\nconst STATE_STOPPED = 'NODE_IS_STOPPED'\r\n// const STATE_UNREGISTERING = 'NODE_IS_UNREGISTERING_TO_MASTER'\r\n\r\n\r\n\r\n/**\r\n * @file Node class: node is an item of a topology and manages a set of servers.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class Node extends NodeMessaging\r\n{\r\n\t/**\r\n\t * Create a Node instance.\r\n\t * @extends NodeMessaging\r\n\t * \r\n\t * @param {string} arg_name - resource name.\r\n\t * @param {object} arg_settings - resource settings.\r\n\t * @param {string} arg_log_context - trace context string (optional, default=context).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tassert( T.isObject(arg_settings.runtime), arg_log_context + ':bad runtime instance')\r\n\t\tassert( T.isObject(arg_settings), arg_log_context + ':bad settings object')\r\n\t\t\r\n\t\tsuper(arg_name, arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_node = true\r\n\t\t\r\n\t\t// CREATE NODE FEATURES\r\n\t\tthis.servers_feature     = new ServersNodeFeature(this, 'servers')\r\n\t\tthis.msg_bus_feature     = new BusNodeFeature(this, 'msg_bus')\r\n\t\tthis.logs_bus_feature    = new BusNodeFeature(this, 'logs_bus')\r\n\t\tthis.metrics_bus_feature = new BusNodeFeature(this, 'metrics_bus')\r\n\t\tthis.metrics_feature     = undefined\r\n\r\n\t\tthis.features = []\r\n\t\tthis.features.push(this.servers_feature)\r\n\t\t\r\n\t\tthis.remote_nodes = {}\r\n\r\n\t\tthis.switch_state(STATE_CREATED)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load Node with starting settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\tthis.enter_group('load()')\r\n\t\t\r\n\t\t// console.log(context + ':load:Node')\r\n\r\n\t\t// LOAD BUSES FEATURES BEFORE LOADING DISTRIBUTED INSTANCE PARENT CLASS\r\n\t\tthis.msg_bus_feature.load()\r\n\t\tthis.logs_bus_feature.load()\r\n\t\tthis.metrics_bus_feature.load()\r\n\r\n\t\tsuper.load()\r\n\t\t\r\n\t\tthis.msg_bus = this.msg_bus_feature.bus\r\n\t\tthis.metrics_bus = this.metrics_bus_feature.bus\r\n\t\tthis.logs_bus = this.logs_bus_feature.bus\r\n\r\n\t\tthis.metrics_bus.get_bus_engine().channel_add('metrics')\r\n\t\tthis.logs_bus.get_bus_engine().channel_add('logs')\r\n\r\n\t\tthis.leave_group('load()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load Node features.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload_features()\r\n\t{\r\n\t\t// UODATE TRACE FLAG\r\n\t\tthis.update_trace_enabled()\r\n\t\t\r\n\t\tconst self = this\r\n\r\n\t\t// DEBUG\r\n\t\t// this.enable_trace()\r\n\r\n\t\tthis.enter_group('load_features()')\r\n\t\t\r\n\t\t// CREATE MASTER INIT\r\n\t\tif (this.is_master)\r\n\t\t{\r\n\t\t\tthis.metrics_feature = new MetricsNodeFeature(this, 'metrics')\r\n\t\t\tthis.metrics_feature.load()\r\n\t\t}\r\n\r\n\t\t// LOAD EXISTING FEATURES\r\n\t\tthis.features.forEach(\r\n\t\t\t(feature) => {\r\n\t\t\t\tself.info('Loading feature [' + feature.get_name() + ']')\r\n\t\t\t\t\r\n\t\t\t\tfeature.load()\r\n\t\t\t\t\r\n\t\t\t\tself.info('Feature is loaded [' + feature.get_name() + ']')\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tif (this.is_master)\r\n\t\t{\r\n\t\t\tthis.features.push(this.metrics_feature)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('load_features()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load settings on master node.\r\n\t * \r\n\t * @param {object} arg_settings - master node settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload_topology_settings(arg_settings)\r\n\t{\r\n\t\t// UODATE TRACE FLAG\r\n\t\tthis.update_trace_enabled()\r\n\r\n\t\tthis.enter_group('load_topology_settings')\r\n\t\tthis.switch_state(STATE_LOADING)\r\n\r\n\t\t// console.log(arg_settings, 'node.loading_master_settings:arg_settings')\r\n\t\t\r\n\t\t// CHECK NODE SERVERS SETTINGS\r\n\t\tassert( T.isObject(arg_settings), context + ':load_topology_settings:bad master settings object')\r\n\t\tassert( T.isFunction(arg_settings.has), context + ':load_topology_settings:bad settings object')\r\n\t\tassert( arg_settings.has('servers'), context + ':load_topology_settings:unknow settings.servers')\r\n\t\t\r\n\t\t// GET NODE SERVERS SETTINGS\r\n\t\tlet servers = arg_settings.get('servers')\r\n\t\tassert( T.isObject(servers), context + ':load_topology_settings:bad settings.servers object')\r\n\t\tconst bindings = runtime.get_setting('servers_bindings', undefined)\r\n\t\tif (bindings)\r\n\t\t{\r\n\t\t\tconst bindings_js = bindings.toJS()\r\n\t\t\t// console.log(context + ':load_topology_settings:settings.servers_bindings', bindings_js)\r\n\t\t\t// assert( T.isArray(bindings_js), context + ':load_topology_settings:bad settings.servers_bindings array')\r\n\t\t\tbindings_js.forEach(\r\n\t\t\t\t(binding_record) => {\r\n\t\t\t\t\tif (binding_record.node == this.get_name() && servers.has(binding_record.server) )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tservers = servers.setIn([binding_record.server, 'host'], binding_record.host )\r\n\t\t\t\t\t\tservers = servers.setIn([binding_record.server, 'port'], binding_record.port )\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\t// UDPATE NODE SETTINGS WITH SERVERS\r\n\t\tthis.$settings = this.$settings.set('servers', servers)\r\n\t\t\r\n\t\t// LOAD NODE FEATURES (servers)\r\n\t\tthis.load_features()\r\n\t\t\r\n\t\tthis.switch_state(STATE_LOADED)\r\n\t\tthis.leave_group('load_topology_settings')\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * TODO get_metrics_server_name\r\n\t */\r\n\tget_metrics_server_name()\r\n\t{\r\n\t\treturn 'metrics_server'\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Get metrics server instance.\r\n\t * \r\n\t * @returns {Server} - Metrics server.\r\n\t */\r\n\tget_metrics_server()\r\n\t{\r\n\t\tif ( ! this.metrics_feature)\r\n\t\t{\r\n\t\t\treturn undefined\r\n\t\t}\r\n\t\tconst srv = this.metrics_feature.get_metrics_server()\r\n\t\tassert( T.isObject(srv), context + ':get_metrics_server:bad metrics_server object')\r\n\t\treturn srv\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get Node instance servers collection.\r\n\t * \r\n\t * @returns {Collection} - Node servers.\r\n\t */\r\n\tget_servers()\r\n\t{\r\n\t\tconst srv = this.servers_feature.servers\r\n\t\tassert( T.isObject(srv), context + ':get_servers:bad servers object')\r\n\t\treturn srv\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Process received message.\r\n\t * \r\n\t * @param {DistributedMessage} arg_msg - message object.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\treceive_msg(arg_msg)\r\n\t{\r\n\t\tthis.enter_group('receive_msg')\r\n\t\tconsole.log(context + ':receive_msg:from=%s to=%s', arg_msg.get_sender(), arg_msg.get_target())\r\n\r\n\t\t// DO NOT PROCESS MESSAGES FROM SELF\r\n\t\tif (arg_msg.get_sender() == this.get_name())\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\r\n        // CHECK SENDER\r\n\t\tassert( T.isString(arg_msg.get_sender()), context + ':receive_msg:bad sender string')\r\n\t\tthis.info('receiving a message from ' + arg_msg.get_sender())\r\n\t\t\r\n        // CHECK PAYLOAD\r\n\t\tassert( T.isObject(arg_msg.get_payload()), context + ':receive_msg:bad payload object')\r\n\r\n        // DEBUG\r\n\t\t// console.log(arg_payload, 'arg_payload from ' + arg_sender)\r\n\r\n\t\tif (this.is_master)\r\n\t\t{\r\n\t\t\tthis.receive_master_msg(arg_msg.get_sender(), arg_msg.get_payload())\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.receive_node_msg(arg_msg.get_sender(), arg_msg.get_payload())\r\n\t\t}\r\n\r\n\t\tthis.leave_group('receive_msg')\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Process received message on master node.\r\n\t * \r\n\t * @param {string} arg_sender - message emitter name.\r\n\t * @param {object} arg_payload - message content.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\treceive_master_msg(arg_sender, arg_payload)\r\n\t{\r\n\t\tthis.enter_group('receive_master_msg')\r\n        \r\n\t\t// CHECK ACTION\r\n\t\tif ( ! T.isString(arg_payload.action) )\r\n\t\t{\r\n\t\t\tthis.warn('receive_master_msg:bad payload.action string received from ' + arg_sender)\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif ( ! T.isObject(arg_payload.node) )\r\n\t\t{\r\n\t\t\tthis.warn('receive_master_msg:bad payload.node object received from ' + arg_sender)\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif ( ! T.isString(arg_payload.node.name) )\r\n\t\t{\r\n\t\t\tthis.warn('receive_master_msg:bad payload.node.name string received from ' + arg_sender)\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// REGISTER A NEW NODE ON MASTER TOPOLOGY\r\n\t\tif (arg_payload.action == 'NODE_ACTION_REGISTERING' && this.get_name() != arg_payload.node.name)\r\n\t\t{\r\n\t\t\tconst cfg = runtime.get_registry().initial_config\r\n\t\t\tconst response_msg = {\r\n\t\t\t\taction:'NODE_ACTION_REGISTERING',\r\n\t\t\t\tmaster:this.get_name(),\r\n\t\t\t\tsettings:cfg\r\n\t\t\t}\r\n\t\t\t// console.log(context + ':receive_master_msg:send response', response_msg)\r\n\r\n\t\t\tthis.remote_nodes[arg_payload.node.name] = arg_payload.node\r\n\t\t\tthis.send_msg(arg_sender, response_msg)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('receive_master_msg')\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Process received message not on master node.\r\n\t * \r\n\t * @param {string} arg_sender - message emitter name.\r\n\t * @param {object} arg_payload - message content.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\treceive_node_msg(arg_sender, arg_payload)\r\n\t{\r\n\t\tthis.enter_group('receive_node_msg')\r\n        \r\n\t\tconsole.log(context + ':receive_node_msg:send response from %s', arg_sender, arg_payload)\r\n\r\n\t\tif (arg_payload.action == 'NODE_ACTION_REGISTERING' && T.isObject(arg_payload.settings))\r\n\t\t{\r\n\t\t\t// console.log(context + ':receive_node_msg:load_topology_settings')\r\n\t\t\tconst settings = arg_payload.settings\r\n\t\t\tif ( T.isFunction(this.on_registering_callback) )\r\n\t\t\t{\r\n\t\t\t\tthis.on_registering_callback(settings)\r\n\t\t\t\tthis.leave_group('receive_node_msg:call on_registering_callback')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tthis.load_topology_settings(settings)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('receive_node_msg')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Starts node features.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstart()\r\n\t{\r\n\t\tconst self = this\r\n\t\tthis.enter_group('start')\r\n\t\tthis.switch_state(STATE_STARTING)\r\n\t\t\r\n\t\tthis.features.forEach(\r\n\t\t\t(feature) => {\r\n\t\t\t\tself.info('Starting feature [' + feature.get_name() + ']')\r\n\t\t\t\t// console.info(context + ':starting feature [' + feature.get_name() + ']')\r\n\t\t\t\t\r\n\t\t\t\tfeature.start()\r\n\r\n\t\t\t\t// console.info('Feature is started [' + feature.get_name() + ']')\r\n\t\t\t\tself.info('Feature is started [' + feature.get_name() + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.switch_state(STATE_STARTED)\r\n\t\tthis.leave_group('start')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Stops node features.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstop()\r\n\t{\r\n\t\tconst self = this\r\n\t\tthis.enter_group('stop')\r\n\t\tthis.switch_state(STATE_STOPPING)\r\n\t\t\r\n\t\tthis.features.forEach(\r\n\t\t\t(feature) => {\r\n\t\t\t\tself.info('Stopping feature [' + feature.get_name() + ']')\r\n\t\t\t\t\r\n\t\t\t\tfeature.stop()\r\n\t\t\t\t\r\n\t\t\t\tself.info('Feature is stopped [' + feature.get_name() + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.switch_state(STATE_STOPPED)\r\n\t\tthis.leave_group('stop')\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Get topology item informations.\r\n\t * \r\n\t * @param {boolean} arg_deep - get deep sub items information on true (default:false).\r\n\t * @param {object} arg_visited - visited items plain object map.\r\n\t * \r\n\t * @returns {object} - topology informations (plain object).\r\n\t */\r\n\tget_topology_info(arg_deep=true, arg_visited={})\r\n\t{\r\n\t\tconst info = {\r\n\t\t\tname:this.get_name(),\r\n\t\t\tuid_desc:'N/A',\r\n\t\t\tuid:'N/A',\r\n\r\n\t\t\ttenant:'N/A',\r\n\t\t\tpackage:'N/A',\r\n\t\t\tversion:'N/A',\r\n\t\t\t\r\n\t\t\ttype:'node',\r\n\t\t\tsecurity:'N/A',\r\n\t\t\t\r\n\t\t\tchildren:['N/A']\r\n\t\t}\r\n\r\n\t\tif ( arg_visited && (this.topology_uid in arg_visited) )\r\n\t\t{\r\n\t\t\treturn Object.assign(info, { note:'already dumped' } )\r\n\t\t}\r\n\r\n\t\targ_visited[this.topology_uid] = info\r\n\r\n\t\treturn info\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/node.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 328,
    "kind": "variable",
    "name": "context",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 329,
    "kind": "variable",
    "name": "STATE_CREATED",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_CREATED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 19,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 330,
    "kind": "variable",
    "name": "STATE_LOADING",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_LOADING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 331,
    "kind": "variable",
    "name": "STATE_LOADED",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_LOADED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 332,
    "kind": "variable",
    "name": "STATE_STARTING",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_STARTING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 333,
    "kind": "variable",
    "name": "STATE_STARTED",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_STARTED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 334,
    "kind": "variable",
    "name": "STATE_STOPPING",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_STOPPING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 335,
    "kind": "variable",
    "name": "STATE_STOPPED",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~STATE_STOPPED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 336,
    "kind": "class",
    "name": "Node",
    "memberof": "js/nodes/node.js",
    "static": true,
    "longname": "js/nodes/node.js~Node",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/node.js",
    "importStyle": "Node",
    "description": "",
    "lineNumber": 37,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node class: node is an item of a topology and manages a set of servers."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/nodes/node_messaging.js~NodeMessaging"
    ]
  },
  {
    "__docId__": 337,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#constructor",
    "access": null,
    "description": "Create a Node instance.",
    "lineNumber": 49,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "NodeMessaging"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "resource name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "resource settings."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string (optional, default=context)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 338,
    "kind": "member",
    "name": "is_node",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#is_node",
    "access": null,
    "description": null,
    "lineNumber": 56,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 339,
    "kind": "member",
    "name": "servers_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#servers_feature",
    "access": null,
    "description": null,
    "lineNumber": 59,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 340,
    "kind": "member",
    "name": "msg_bus_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#msg_bus_feature",
    "access": null,
    "description": null,
    "lineNumber": 60,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 341,
    "kind": "member",
    "name": "logs_bus_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#logs_bus_feature",
    "access": null,
    "description": null,
    "lineNumber": 61,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 342,
    "kind": "member",
    "name": "metrics_bus_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#metrics_bus_feature",
    "access": null,
    "description": null,
    "lineNumber": 62,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 343,
    "kind": "member",
    "name": "metrics_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#metrics_feature",
    "access": null,
    "description": null,
    "lineNumber": 63,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 344,
    "kind": "member",
    "name": "features",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#features",
    "access": null,
    "description": null,
    "lineNumber": 65,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 345,
    "kind": "member",
    "name": "remote_nodes",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#remote_nodes",
    "access": null,
    "description": null,
    "lineNumber": 68,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 346,
    "kind": "method",
    "name": "load",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#load",
    "access": null,
    "description": "Load Node with starting settings.",
    "lineNumber": 80,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 347,
    "kind": "member",
    "name": "msg_bus",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#msg_bus",
    "access": null,
    "description": null,
    "lineNumber": 93,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 348,
    "kind": "member",
    "name": "metrics_bus",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#metrics_bus",
    "access": null,
    "description": null,
    "lineNumber": 94,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 349,
    "kind": "member",
    "name": "logs_bus",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#logs_bus",
    "access": null,
    "description": null,
    "lineNumber": 95,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 350,
    "kind": "method",
    "name": "load_features",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#load_features",
    "access": null,
    "description": "Load Node features.",
    "lineNumber": 110,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 351,
    "kind": "member",
    "name": "metrics_feature",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#metrics_feature",
    "access": null,
    "description": null,
    "lineNumber": 125,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 352,
    "kind": "method",
    "name": "load_topology_settings",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#load_topology_settings",
    "access": null,
    "description": "Load settings on master node.",
    "lineNumber": 157,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "master node settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 353,
    "kind": "member",
    "name": "$settings",
    "memberof": "js/nodes/node.js~Node",
    "static": false,
    "longname": "js/nodes/node.js~Node#$settings",
    "access": null,
    "description": null,
    "lineNumber": 193,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 354,
    "kind": "method",
    "name": "get_metrics_server_name",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#get_metrics_server_name",
    "access": null,
    "description": "TODO get_metrics_server_name",
    "lineNumber": 207,
    "params": [],
    "return": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 355,
    "kind": "method",
    "name": "get_metrics_server",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#get_metrics_server",
    "access": null,
    "description": "Get metrics server instance.",
    "lineNumber": 219,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Server} - Metrics server."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Server"
      ],
      "spread": false,
      "description": "Metrics server."
    }
  },
  {
    "__docId__": 356,
    "kind": "method",
    "name": "get_servers",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#get_servers",
    "access": null,
    "description": "Get Node instance servers collection.",
    "lineNumber": 237,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Collection} - Node servers."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Collection"
      ],
      "spread": false,
      "description": "Node servers."
    }
  },
  {
    "__docId__": 357,
    "kind": "method",
    "name": "receive_msg",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#receive_msg",
    "access": null,
    "description": "Process received message.",
    "lineNumber": 253,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "DistributedMessage"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_msg",
        "description": "message object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 358,
    "kind": "method",
    "name": "receive_master_msg",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#receive_master_msg",
    "access": null,
    "description": "Process received message on master node.",
    "lineNumber": 296,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_sender",
        "description": "message emitter name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_payload",
        "description": "message content."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 359,
    "kind": "method",
    "name": "receive_node_msg",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#receive_node_msg",
    "access": null,
    "description": "Process received message not on master node.",
    "lineNumber": 345,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_sender",
        "description": "message emitter name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_payload",
        "description": "message content."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 360,
    "kind": "method",
    "name": "start",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#start",
    "access": null,
    "description": "Starts node features.",
    "lineNumber": 374,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 361,
    "kind": "method",
    "name": "stop",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#stop",
    "access": null,
    "description": "Stops node features.",
    "lineNumber": 403,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 362,
    "kind": "method",
    "name": "get_topology_info",
    "memberof": "js/nodes/node.js~Node",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node.js~Node#get_topology_info",
    "access": null,
    "description": "Get topology item informations.",
    "lineNumber": 433,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - topology informations (plain object)."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_deep",
        "description": "get deep sub items information on true (default:false)."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_visited",
        "description": "visited items plain object map."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "topology informations (plain object)."
    }
  },
  {
    "__docId__": 363,
    "kind": "file",
    "name": "js/nodes/node_feature.js",
    "content": "\r\n\r\n// let context = 'server/nodes/node_feature'\r\n\r\n\r\n\r\n/**\r\n * @file Node feature: append a feature to a Node instance.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class NodeFeature\r\n{\r\n\t/**\r\n\t * Create a Nodefeature instance.\r\n\t * @abstract\r\n\t * \r\n\t * @param {Node} arg_node - node instance.\r\n\t * @param {string} arg_name - feature name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_node, arg_name)\r\n\t{\r\n\t\tthis.is_node_feature = true\r\n\t\t\r\n\t\tthis.node = arg_node\r\n\t\tthis.name = arg_name\r\n\t\tthis.is_ready = false\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Get feature name.\r\n\t * \r\n\t * @returns {string} - feature name\r\n\t */\r\n\tget_name()\r\n\t{\r\n\t\treturn this.name\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Load Node settings.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\tthis.node.enter_group(':NodeFeature.load()')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':NodeFeature.load()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Starts node feature.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstart()\r\n\t{\r\n\t\tthis.node.enter_group(':NodeFeature.start')\r\n\r\n\t\t\r\n\t\tthis.node.leave_group(':NodeFeature.start')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Stops node feature.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstop()\r\n\t{\r\n\t\tthis.node.enter_group(':NodeFeature.stop')\r\n\t\t\r\n\t\t\r\n\t\tthis.node.leave_group(':NodeFeature.stop')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/node_feature.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 364,
    "kind": "class",
    "name": "NodeFeature",
    "memberof": "js/nodes/node_feature.js",
    "static": true,
    "longname": "js/nodes/node_feature.js~NodeFeature",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/node_feature.js",
    "importStyle": "NodeFeature",
    "description": "",
    "lineNumber": 12,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node feature: append a feature to a Node instance."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 365,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#constructor",
    "access": null,
    "description": "Create a Nodefeature instance.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_node",
        "description": "node instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 366,
    "kind": "member",
    "name": "is_node_feature",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#is_node_feature",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 367,
    "kind": "member",
    "name": "node",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#node",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 368,
    "kind": "member",
    "name": "name",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#name",
    "access": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 369,
    "kind": "member",
    "name": "is_ready",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#is_ready",
    "access": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 370,
    "kind": "method",
    "name": "get_name",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#get_name",
    "access": null,
    "description": "Get feature name.",
    "lineNumber": 39,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - feature name"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "feature name"
    }
  },
  {
    "__docId__": 371,
    "kind": "method",
    "name": "load",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#load",
    "access": null,
    "description": "Load Node settings.",
    "lineNumber": 52,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 372,
    "kind": "method",
    "name": "start",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#start",
    "access": null,
    "description": "Starts node feature.",
    "lineNumber": 68,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 373,
    "kind": "method",
    "name": "stop",
    "memberof": "js/nodes/node_feature.js~NodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_feature.js~NodeFeature#stop",
    "access": null,
    "description": "Stops node feature.",
    "lineNumber": 84,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 374,
    "kind": "file",
    "name": "js/nodes/node_messaging.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T                   from 'devapt-core-common/dist/js/utils/types'\r\nimport DistributedInstance from 'devapt-core-common/dist/js/base/distributed_instance'\r\n\r\n\r\n\r\nlet context = 'server/nodes/node_messaging'\r\n\r\n\r\nconst STATE_CREATED = 'NODE_IS_CREATED'\r\nconst STATE_REGISTERING = 'NODE_IS_REGISTERING_TO_MASTER'\r\nconst STATE_WAITING = 'NODE_IS_WAITING_ITS_SETTINGS'\r\n// const STATE_LOADING = 'NODE_IS_LOADING_ITS_SETTINGS'\r\n// const STATE_LOADED = 'NODE_HAS_LOADED_ITS_SETTINGS'\r\n// const STATE_STARTING = 'NODE_IS_STARTING'\r\n// const STATE_STARTED = 'NODE_IS_STARTED'\r\n// const STATE_STOPPING = 'NODE_IS_STOPPING'\r\n// const STATE_STOPPED = 'NODE_IS_STOPPED'\r\nconst STATE_UNREGISTERING = 'NODE_IS_UNREGISTERING_TO_MASTER'\r\n\r\n\r\n\r\n/**\r\n * @file Node messaging base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class NodeMessaging extends DistributedInstance\r\n{\r\n\t/**\r\n\t * Create a Node messaging instance.\r\n\t * @extends Instance\r\n\t * \r\n\t * @param {string} arg_name - resource name.\r\n\t * @param {object} arg_settings - resource settings.\r\n\t * @param {string} arg_log_context - trace context string (optional, default=context).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tassert( T.isObject(arg_settings), arg_log_context + ':bad settings object')\r\n\t\tassert( T.isObject(arg_settings.runtime), arg_log_context + ':bad runtime instance')\r\n\t\t\r\n\t\tsuper('nodes', arg_name, 'Node', arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_node_messaging = true\r\n\t\t\r\n\t\t// INIT MASTER ATTRIBUTES\r\n\t\tthis.is_master = this.get_setting('is_master', false)\r\n\t\tthis.master_name = this.is_master ? this.get_name() : this.get_setting(['master', 'name'], undefined)\r\n\t}\r\n\r\n\r\n\r\n\t// load()\r\n\t// {\r\n\t// \tconsole.log(context + ':load:NodeMessaging')\r\n\r\n\t// \tsuper.load()\r\n\t// }\r\n\t\r\n\r\n\r\n\t/**\r\n\t * Enable messaging for locale target.\r\n\t * \r\n\t * @param {string} arg_name - locale target name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\t// enable_locale_target(arg_name)\r\n\t// {\r\n\t// \tthis.msg_bus_feature.bus.add_locale_target(arg_name)\r\n\r\n\t// \tif (arg_name != this.get_name())\r\n\t// \t{\r\n\t// \t\tthis.msg_bus_feature.bus.add_locale_target(arg_name + '@' + this.get_name())\r\n\t// \t}\r\n\t// }\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Get metrics bus client or server instance.\r\n\t * \r\n\t * @returns {BusClient|BusServer} - Metrics bus client or server.\r\n\t */\r\n\tget_msg_bus()\r\n\t{\r\n\t\treturn this.msg_bus_feature.bus\r\n\t}\r\n\t\r\n\t\r\n\r\n\t/**\r\n\t * Get metrics bus client or server instance.\r\n\t * \r\n\t * @returns {BusClient|BusServer} - Metrics bus client or server.\r\n\t */\r\n\tget_metrics_bus()\r\n\t{\r\n\t\treturn this.metrics_bus_feature.bus\r\n\t}\r\n\t\r\n\t\r\n\r\n\t/**\r\n\t * Get metrics bus client or server instance.\r\n\t * \r\n\t * @returns {BusClient|BusServer} - Metrics bus client or server.\r\n\t */\r\n\tget_logs_bus()\r\n\t{\r\n\t\treturn this.logs_bus_feature.bus\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Switch Node state.\r\n\t * \r\n\t * @param {string} arg_state - target state.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tswitch_state(arg_state)\r\n\t{\r\n\t\tthis.state = arg_state\r\n\t\tthis.info(arg_state)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Send a message to master node through a bus.\r\n\t * \r\n\t * @param {object} arg_payload - content of the message to send.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tsend_msg_to_master(arg_payload)\r\n\t{\r\n\t\tconsole.log('send a msg to master [%s]', this.master_name, arg_payload)\r\n\t\tthis.send_msg(this.master_name, arg_payload)\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Register this node to master node.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tregister_to_master()\r\n\t{\r\n\t\tconsole.log('register to master')\r\n\t\tthis.switch_state(STATE_REGISTERING)\r\n\t\t\r\n\t\tlet node_cfg = this.get_settings().toJS()\r\n\t\tdelete node_cfg.logger_manager\r\n\t\t\r\n\t\tconst msg_payload = {\r\n\t\t\t'action':'NODE_ACTION_REGISTERING',\r\n\t\t\t'node':node_cfg\r\n\t\t}\r\n\t\t\r\n\t\tthis.send_msg_to_master(msg_payload)\r\n\t\t\r\n\t\tthis.switch_state(STATE_WAITING)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Unegister this node from master node. (TODO)\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tunregister_to_master()\r\n\t{\r\n\t\tthis.switch_state(STATE_UNREGISTERING)\r\n\t\t\r\n\t\t// if (this.is_master)\r\n\t\t// {\r\n\t\t\t\r\n\t\t// } else{\r\n\t\t\t\r\n\t\t// }\r\n\t\t\r\n\t\tthis.switch_state(STATE_CREATED)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Find master node. (TODO)\r\n\t * \r\n\t * @returns {Node} - master node instance.\r\n\t */\r\n\tfind_master()\r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Promote this node to master node. (TODO)\r\n\t * \r\n\t * @returns {Promise} - Promise of boolean: success or failure\r\n\t */\r\n\tpromote_master()\r\n\t{\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Revoke this node from master node. (TODO)\r\n\t * \r\n\t * @returns {Promise} - Promise of boolean: success or failure\r\n\t */\r\n\trevoke_master()\r\n\t{\r\n\t\t\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/node_messaging.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 375,
    "kind": "variable",
    "name": "context",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 376,
    "kind": "variable",
    "name": "STATE_CREATED",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~STATE_CREATED",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 377,
    "kind": "variable",
    "name": "STATE_REGISTERING",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~STATE_REGISTERING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 378,
    "kind": "variable",
    "name": "STATE_WAITING",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~STATE_WAITING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 379,
    "kind": "variable",
    "name": "STATE_UNREGISTERING",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~STATE_UNREGISTERING",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 380,
    "kind": "class",
    "name": "NodeMessaging",
    "memberof": "js/nodes/node_messaging.js",
    "static": true,
    "longname": "js/nodes/node_messaging.js~NodeMessaging",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/node_messaging.js",
    "importStyle": "NodeMessaging",
    "description": "",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node messaging base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/distributed_instance~DistributedInstance"
    ]
  },
  {
    "__docId__": 381,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#constructor",
    "access": null,
    "description": "Create a Node messaging instance.",
    "lineNumber": 43,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Instance"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "resource name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "resource settings."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string (optional, default=context)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 382,
    "kind": "member",
    "name": "is_node_messaging",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#is_node_messaging",
    "access": null,
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 383,
    "kind": "member",
    "name": "is_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#is_master",
    "access": null,
    "description": null,
    "lineNumber": 53,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 384,
    "kind": "member",
    "name": "master_name",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#master_name",
    "access": null,
    "description": null,
    "lineNumber": 54,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 385,
    "kind": "method",
    "name": "get_msg_bus",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#get_msg_bus",
    "access": null,
    "description": "Get metrics bus client or server instance.",
    "lineNumber": 92,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{BusClient|BusServer} - Metrics bus client or server."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "BusClient",
        "BusServer"
      ],
      "spread": false,
      "description": "Metrics bus client or server."
    }
  },
  {
    "__docId__": 386,
    "kind": "method",
    "name": "get_metrics_bus",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#get_metrics_bus",
    "access": null,
    "description": "Get metrics bus client or server instance.",
    "lineNumber": 104,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{BusClient|BusServer} - Metrics bus client or server."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "BusClient",
        "BusServer"
      ],
      "spread": false,
      "description": "Metrics bus client or server."
    }
  },
  {
    "__docId__": 387,
    "kind": "method",
    "name": "get_logs_bus",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#get_logs_bus",
    "access": null,
    "description": "Get metrics bus client or server instance.",
    "lineNumber": 116,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{BusClient|BusServer} - Metrics bus client or server."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "BusClient",
        "BusServer"
      ],
      "spread": false,
      "description": "Metrics bus client or server."
    }
  },
  {
    "__docId__": 388,
    "kind": "method",
    "name": "switch_state",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#switch_state",
    "access": null,
    "description": "Switch Node state.",
    "lineNumber": 130,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "target state."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 389,
    "kind": "member",
    "name": "state",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#state",
    "access": null,
    "description": null,
    "lineNumber": 132,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 390,
    "kind": "method",
    "name": "send_msg_to_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#send_msg_to_master",
    "access": null,
    "description": "Send a message to master node through a bus.",
    "lineNumber": 145,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_payload",
        "description": "content of the message to send."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 391,
    "kind": "method",
    "name": "register_to_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#register_to_master",
    "access": null,
    "description": "Register this node to master node.",
    "lineNumber": 158,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 392,
    "kind": "method",
    "name": "unregister_to_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#unregister_to_master",
    "access": null,
    "description": "Unegister this node from master node. (TODO)",
    "lineNumber": 183,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 393,
    "kind": "method",
    "name": "find_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#find_master",
    "access": null,
    "description": "Find master node. (TODO)",
    "lineNumber": 203,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Node} - master node instance."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Node"
      ],
      "spread": false,
      "description": "master node instance."
    }
  },
  {
    "__docId__": 394,
    "kind": "method",
    "name": "promote_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#promote_master",
    "access": null,
    "description": "Promote this node to master node. (TODO)",
    "lineNumber": 214,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - Promise of boolean: success or failure"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "Promise of boolean: success or failure"
    }
  },
  {
    "__docId__": 395,
    "kind": "method",
    "name": "revoke_master",
    "memberof": "js/nodes/node_messaging.js~NodeMessaging",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/node_messaging.js~NodeMessaging#revoke_master",
    "access": null,
    "description": "Revoke this node from master node. (TODO)",
    "lineNumber": 225,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - Promise of boolean: success or failure"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "Promise of boolean: success or failure"
    }
  },
  {
    "__docId__": 396,
    "kind": "file",
    "name": "js/nodes/servers_node_feature.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T          from 'devapt-core-common/dist/js/utils/types'\r\nimport Collection from 'devapt-core-common/dist/js/base/collection'\r\n\r\n// SERVER IMPORTS\r\nimport NodeFeature     from './node_feature'\r\nimport { ServerTypes } from '../servers/server'\r\nimport RestifyServer   from '../servers/restify_server'\r\nimport ExpressServer   from '../servers/express_server'\r\nimport LogsServer      from '../servers/logs_server'\r\nimport MetricsServer      from '../servers/metrics_server'\r\n\r\n\r\n\r\nlet context = 'server/nodes/servers_node_feature'\r\n\r\n\r\n\r\n/**\r\n * @file Node feature: manages a set of servers.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ServersNodeFeature extends NodeFeature\r\n{\r\n\t/**\r\n\t * Create a ServersNodefeature instance.\r\n\t * @extends NodeFeature\r\n\t * \r\n\t * @param {Node} arg_node - node instance.\r\n\t * @param {string} arg_name - feature name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_node, arg_name)\r\n\t{\r\n\t\tsuper(arg_node, arg_name)\r\n\t\t\r\n\t\tthis.is_servers_node_feature = true\r\n\t\t\r\n\t\tthis.servers = new Collection()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load Node settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\tconst self = this\r\n\t\tthis.node.enter_group(':ServersNodeFeature.load()')\r\n\t\t\r\n\t\tsuper.load()\r\n\t\t\r\n\t\tconst servers_settings = this.node.get_setting('servers')\r\n\t\tassert( T.isFunction(servers_settings.forEach), context + ':load:bad servers_settings.forEach function')\r\n\r\n\t\tservers_settings.forEach(\r\n\t\t\t(server_cfg, server_name) => {\r\n\t\t\t\tself.node.info(':ServersNodeFeature.load:processing server creation of:' + server_name)\r\n\t\t\t\t\r\n\t\t\t\t// console.log(context + ':server=[%s] cfg=[%s]', server_name, JSON.stringify(server_cfg))\r\n\r\n\t\t\t\tconst server_type = server_cfg.has('type') ? server_cfg.get('type') : null\r\n\t\t\t\tassert( T.isString(server_type), context + ':load:bad server type string for server name [' + server_name + ']')\r\n\t\t\t\t\r\n\t\t\t\tserver_cfg = server_cfg.set('runtime', this.node.get_runtime() )\r\n\t\t\t\tserver_cfg = server_cfg.set('logger_manager', this.node.get_logger_manager() )\r\n\r\n\t\t\t\tlet server = self.create_server(server_type, server_name, server_cfg)\r\n\t\t\t\tserver.load()\r\n\t\t\t\tserver.node = self.node\r\n\t\t\t\t\r\n\t\t\t\tself.servers.add(server)\r\n\t\t\t\t\r\n\t\t\t\tself.node.info(':ServersNodeFeature.load:server is created [' + server_name + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.node.leave_group(':ServersNodeFeature.load()')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Starts node servers.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstart()\r\n\t{\r\n\t\tconst self = this\r\n\t\tthis.node.enter_group(':ServersNodeFeature.start')\r\n\t\t\r\n\t\tsuper.start()\r\n\r\n\t\tthis.servers.forEach(\r\n\t\t\t(server) => {\r\n\t\t\t\tconst server_name = server.get_name()\r\n\t\t\t\t\r\n\t\t\t\tself.node.info(':ServersNodeFeature.start:starting server [' + server_name + ']')\r\n\t\t\t\t// console.info(context + ':ServersNodeFeature.start:starting server [' + server_name + ']')\r\n\t\t\t\t\r\n\t\t\t\tserver.enable()\r\n\t\t\t\tserver.enable_msg()\r\n\t\t\t\t\r\n\t\t\t\tself.node.info(':ServersNodeFeature.start:server is started [' + server_name + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.node.leave_group(':ServersNodeFeature.start')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Stops node servers.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tstop()\r\n\t{\r\n\t\tconst self = this\r\n\t\tthis.node.enter_group(':ServersNodeFeature.stop')\r\n\t\t\r\n\t\tsuper.stop()\r\n\r\n\t\tthis.servers.forEach(\r\n\t\t\t(server) => {\r\n\t\t\t\tconst server_name = server.get_name()\r\n\t\t\t\t\r\n\t\t\t\tself.node.info(':ServersNodeFeature.start:stopping server [' + server_name + ']')\r\n\t\t\t\t\r\n\t\t\t\tserver.disable()\r\n\t\t\t\t\r\n\t\t\t\tself.node.info(':ServersNodeFeature.start:server is stopped [' + server_name + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.node.leave_group(':ServersNodeFeature.stop')\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a server instance on this node.\r\n\t * \r\n\t * @param {string} arg_type - server type string\r\n\t * @param {string} arg_name - server name string\r\n\t * @param {object} arg_settings - server settings object\r\n\t * \r\n\t * @returns {Server} - a new Server instance\r\n\t */\r\n\tcreate_server(arg_type, arg_name, arg_settings)\r\n\t{\r\n\t\t// BUILD SERVER\r\n\t\tswitch(arg_type)\r\n\t\t{\r\n\t\t\tcase ServerTypes.SERVER_TYPE_EXPRESS: {\r\n\t\t\t\t// const ExpressServer = require('../servers/express_server')\r\n\t\t\t\t// console.log(arg_settings.get('runtime').is_base_runtime ? 'RUNTIME FOUND FOR SERVER ' + arg_name : '!!! RUNTIME NOT FOUND FOR SERVER ' + arg_name)\r\n\t\t\t\t// console.log(arg_settings.get('logger_manager').is_logger_manager ? 'LOGGER MANAGER FOUND FOR SERVER ' + arg_name : '!!! LOGGER MANAGER NOT FOUND FOR SERVER ' + arg_name)\r\n\t\t\t\treturn new ExpressServer(arg_name, arg_settings)\r\n\t\t\t}\r\n\t\t\tcase ServerTypes.SERVER_TYPE_RESTIFY: {\r\n\t\t\t\treturn new RestifyServer(arg_name, arg_settings)\r\n\t\t\t}\r\n\t\t\tcase ServerTypes.SERVER_TYPE_CLUSTER: {\r\n\t\t\t\treturn new ExpressServer(arg_name, arg_settings)\r\n\t\t\t}\r\n\t\t\tcase ServerTypes.SERVER_TYPE_LOGS: {\r\n\t\t\t\treturn new LogsServer(arg_name, arg_settings)\r\n\t\t\t}\r\n\t\t\tcase ServerTypes.SERVER_TYPE_METRICS: {\r\n\t\t\t\treturn new MetricsServer(arg_name, arg_settings)\r\n\t\t\t}\r\n\t\t\tdefault:{\r\n\t\t\t\tassert(false, context + ':ServersNodeFeature.create_server:bad server type [' + arg_type + '] for name [' + arg_name + ']')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/nodes/servers_node_feature.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 397,
    "kind": "variable",
    "name": "context",
    "memberof": "js/nodes/servers_node_feature.js",
    "static": true,
    "longname": "js/nodes/servers_node_feature.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/nodes/servers_node_feature.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 398,
    "kind": "class",
    "name": "ServersNodeFeature",
    "memberof": "js/nodes/servers_node_feature.js",
    "static": true,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/nodes/servers_node_feature.js",
    "importStyle": "ServersNodeFeature",
    "description": "",
    "lineNumber": 27,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Node feature: manages a set of servers."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/nodes/node_feature.js~NodeFeature"
    ]
  },
  {
    "__docId__": 399,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#constructor",
    "access": null,
    "description": "Create a ServersNodefeature instance.",
    "lineNumber": 38,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "NodeFeature"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Node"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_node",
        "description": "node instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 400,
    "kind": "member",
    "name": "is_servers_node_feature",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#is_servers_node_feature",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 401,
    "kind": "member",
    "name": "servers",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#servers",
    "access": null,
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 402,
    "kind": "method",
    "name": "load",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#load",
    "access": null,
    "description": "Load Node settings.",
    "lineNumber": 54,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 403,
    "kind": "method",
    "name": "start",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#start",
    "access": null,
    "description": "Starts node servers.",
    "lineNumber": 96,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 404,
    "kind": "method",
    "name": "stop",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#stop",
    "access": null,
    "description": "Stops node servers.",
    "lineNumber": 127,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 405,
    "kind": "method",
    "name": "create_server",
    "memberof": "js/nodes/servers_node_feature.js~ServersNodeFeature",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/nodes/servers_node_feature.js~ServersNodeFeature#create_server",
    "access": null,
    "description": "Create a server instance on this node.",
    "lineNumber": 160,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Server} - a new Server instance"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "server type string"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server name string"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "server settings object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Server"
      ],
      "spread": false,
      "description": "a new Server instance"
    }
  },
  {
    "__docId__": 406,
    "kind": "file",
    "name": "js/plugins/features_manager.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport PluginsManager from './plugins_manager'\r\n\r\n\r\nlet context = 'server/plugins/features_manager'\r\n\r\n\r\n\r\n/**\r\n * @file Features manager class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class FeaturesManager extends PluginsManager\r\n{\r\n\t/**\r\n\t * Create a features manager instance.\r\n\t * @extends PluginsManager\r\n\t * \r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_features_manager = true\r\n\t\t\r\n\t\tthis.instances = { 'all':{} }\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Create a feature instance by lookup on self contained plugins.\r\n\t * \r\n     * @param {string} arg_class_name - type or class feature name.\r\n     * @param {string} arg_name - feature name.\r\n     * @param {object} arg_settings - feature settings plain object.\r\n     * @param {object} arg_state - feature initial state plain object (optional).\r\n\t * \r\n     * @returns {object} feature instance.\r\n     */\r\n\tcreate(arg_class_name, arg_name, arg_settings, arg_state)\r\n\t{\r\n\t\tassert( T.isString(arg_class_name), context + ':bad class string')\r\n\t\tassert( T.isString(arg_name), context + ':bad name string')\r\n\t\tassert( T.isObject(arg_settings), context + ':bad settings object')\r\n\t\tif (arg_state)\r\n\t\t{\r\n\t\t\tassert( T.isObject(arg_state), context + ':bad state object')\r\n\t\t}\r\n\t\targ_settings = arg_settings.set('runtime', this.get_runtime())\r\n\t\targ_settings = arg_settings.set('logger_manager', this.get_logger_manager())\r\n\t\t\r\n\t\tconst found_plugin = this.registered_plugins.find_by_filter( (plugin) => plugin.has(arg_class_name) )\r\n\t\t\r\n\t\tif (found_plugin)\r\n\t\t{\r\n\t\t\t// console.log(context + ':create:loop on plugin ' + found_plugin.get_name() + ' found with type=' + arg_class_name + ' name=' + arg_name)\r\n\r\n\t\t\tconst instance = found_plugin.create(arg_class_name, arg_name, arg_settings, arg_state)\r\n\t\t\t// console.log(context + ':create:loop on plugin ' + found_plugin.get_name() + ' found with type=' + arg_class_name + ' name=' + arg_name + ':CREATED')\r\n\r\n\t\t\t// this.instances[arg_class_name] = this.instances[arg_class_name] ? this.instances[arg_class_name] : {}\r\n\t\t\t// this.instances[arg_class_name][arg_name] = instance\r\n\t\t\t// this.instances['all'][arg_name] = instance\r\n\t\t\t\r\n\t\t\tthis.add_instance(instance)\r\n\t\t\t\r\n\t\t\treturn instance\r\n\t\t}\r\n\t\t\r\n\t\tconsole.error(context + ':create:feature not found with type=' + arg_class_name + ' name=' + arg_name)\r\n\t\t\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Register an instance which is created outside this plugins manager.\r\n\t * \r\n     * @param {object} arg_instance - feature instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tadd_instance(arg_instance)\r\n\t{\r\n\t\tconst arg_class_name = arg_instance.get_class()\r\n\t\tconst arg_name = arg_instance.get_name()\r\n\t\t\r\n\t\tthis.instances[arg_class_name] = this.instances[arg_class_name] ? this.instances[arg_class_name] : {}\r\n\t\tthis.instances[arg_class_name][arg_name] = arg_instance\r\n\t\tthis.instances['all'][arg_name] = arg_instance\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Has an instance?\r\n\t * \r\n     * @param {string} arg_class_name - type or class feature name.\r\n\t * @param {string} arg_name - feature instance name.\r\n\t * \r\n\t * @returns {boolean} - feature instance found ?\r\n\t */\r\n\thas_instance(arg_class_name, arg_name)\r\n\t{\r\n\t\tif (! T.isString(arg_class_name) )\r\n\t\t{\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tif (! T.isString(arg_name) )\r\n\t\t{\r\n\t\t\targ_name = arg_class_name\r\n\t\t\targ_class_name = 'all'\r\n\t\t}\r\n\t\t\r\n\t\treturn arg_name in this.instances[arg_class_name]\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get an instance.\r\n\t * \r\n     * @param {string} arg_class_name - type or class feature name.\r\n\t * @param {string} arg_name - feature instance name.\r\n\t * \r\n\t * @returns {object} - feature instance\r\n\t */\r\n\tget_instance(arg_class_name, arg_name)\r\n\t{\r\n\t\tif (! T.isString(arg_class_name) )\r\n\t\t{\r\n\t\t\treturn undefined\r\n\t\t}\r\n\t\t\r\n\t\tif (! T.isString(arg_name) )\r\n\t\t{\r\n\t\t\targ_name = arg_class_name\r\n\t\t\targ_class_name = 'all'\r\n\t\t}\r\n\t\t\r\n\t\tif (arg_class_name in this.instances)\r\n\t\t{\r\n\t\t\tif (arg_name in this.instances[arg_class_name])\r\n\t\t\t{\r\n\t\t\t\treturn this.instances[arg_class_name][arg_name]\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Remove an instance.\r\n\t * \r\n     * @param {string} arg_class_name - type or class feature name.\r\n\t * @param {string} arg_name - feature instance name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tremove_instance(arg_class_name, arg_name)\r\n\t{\r\n\t\tif (arg_class_name in this.instances)\r\n\t\t{\r\n\t\t\tif (arg_name in this.instances[arg_class_name])\r\n\t\t\t{\r\n\t\t\t\tdelete this.instances[arg_class_name][arg_name]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Test if a feature class is known into self contained plugins.\r\n     * @param {string} arg_class_name - feature class name.\r\n     * @returns {boolean} feature class found or not.\r\n     */\r\n\thas(arg_class_name)\r\n\t{\r\n\t\tassert( T.isString(arg_class_name), context + ':has:bad class string')\r\n\t\t\r\n\t\t// const plugin = this.enabled_plugins.find_by_filter( (plugin) => plugin.has(arg_class_name) )\r\n\t\tconst plugin = this.registered_plugins.find_by_filter( (plugin) => plugin.has(arg_class_name) )\r\n\t\t\r\n\t\treturn plugin != undefined\r\n\t}\r\n\t\r\n\t\r\n    \r\n\t/**\r\n     * Get a feature class.\r\n     * @param {string} arg_class_name - feature class name.\r\n     * @returns {boolean} feature class found or not.\r\n     */\r\n\tget_feature_class(arg_class_name)\r\n\t{\r\n\t\tassert( T.isString(arg_class_name), context + ':get_class:bad class string')\r\n\t\t\r\n\t\t// const plugin = this.enabled_plugins.find_by_filter( (plugin) => plugin.has(arg_class_name) )\r\n\t\tconst plugin = this.registered_plugins.find_by_filter( (plugin) => plugin.has(arg_class_name) )\r\n\t\t\r\n\t\treturn plugin ? plugin.get_feature_class(arg_class_name) : undefined\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/features_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 407,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/features_manager.js",
    "static": true,
    "longname": "js/plugins/features_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/features_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 408,
    "kind": "class",
    "name": "FeaturesManager",
    "memberof": "js/plugins/features_manager.js",
    "static": true,
    "longname": "js/plugins/features_manager.js~FeaturesManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/features_manager.js",
    "importStyle": "FeaturesManager",
    "description": "",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Features manager class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/plugins_manager.js~PluginsManager"
    ]
  },
  {
    "__docId__": 409,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#constructor",
    "access": null,
    "description": "Create a features manager instance.",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "PluginsManager"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 410,
    "kind": "member",
    "name": "is_features_manager",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#is_features_manager",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 411,
    "kind": "member",
    "name": "instances",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#instances",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{\"all\": *}"
      ]
    }
  },
  {
    "__docId__": 412,
    "kind": "method",
    "name": "create",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#create",
    "access": null,
    "description": "Create a feature instance by lookup on self contained plugins.",
    "lineNumber": 52,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} feature instance."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "type or class feature name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "feature settings plain object."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_state",
        "description": "feature initial state plain object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "feature instance."
    }
  },
  {
    "__docId__": 413,
    "kind": "method",
    "name": "add_instance",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#add_instance",
    "access": null,
    "description": "Register an instance which is created outside this plugins manager.",
    "lineNumber": 96,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_instance",
        "description": "feature instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 414,
    "kind": "method",
    "name": "has_instance",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#has_instance",
    "access": null,
    "description": "Has an instance?",
    "lineNumber": 116,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - feature instance found ?"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "type or class feature name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature instance name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "feature instance found ?"
    }
  },
  {
    "__docId__": 415,
    "kind": "method",
    "name": "get_instance",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#get_instance",
    "access": null,
    "description": "Get an instance.",
    "lineNumber": 142,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - feature instance"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "type or class feature name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature instance name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "feature instance"
    }
  },
  {
    "__docId__": 416,
    "kind": "method",
    "name": "remove_instance",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#remove_instance",
    "access": null,
    "description": "Remove an instance.",
    "lineNumber": 177,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "type or class feature name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "feature instance name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 417,
    "kind": "method",
    "name": "has",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#has",
    "access": null,
    "description": "Test if a feature class is known into self contained plugins.",
    "lineNumber": 195,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} feature class found or not."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "feature class name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "feature class found or not."
    }
  },
  {
    "__docId__": 418,
    "kind": "method",
    "name": "get_feature_class",
    "memberof": "js/plugins/features_manager.js~FeaturesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/features_manager.js~FeaturesManager#get_feature_class",
    "access": null,
    "description": "Get a feature class.",
    "lineNumber": 212,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} feature class found or not."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class_name",
        "description": "feature class name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "feature class found or not."
    }
  },
  {
    "__docId__": 419,
    "kind": "file",
    "name": "js/plugins/plugins_factory.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\n// import DefaultServicePlugin from '../default_plugins/services_default_plugin'\r\nimport ServicesManager from './services_manager'\r\nimport RenderingManager from './rendering_manager'\r\n\r\n\r\nconst context = 'server/plugins/plugins_factory'\r\n\r\n\r\n\r\n\r\n/**\r\n * Plugin class for renderers plugin.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class PluginsFactory\r\n{\r\n    /**\r\n     * Create a PluginsFactory instance.\r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_runtime)\r\n\t{\r\n\t\tthis.is_plugins_factory = true\r\n\t\t\r\n\t\tassert( T.isObject(arg_runtime) && arg_runtime.is_base_runtime, context + ':constructor:bad runtime instance' )\r\n\r\n\t\t// SERVICES PLUGINS MANAGER\r\n\t\tthis.services_manager = new ServicesManager(arg_runtime, context, arg_runtime.get_logger_manager())\r\n\t\t// const default_svc_plugin = new DefaultServicePlugin(arg_runtime, this.services_manager)\r\n\t\t// this.services_manager.register_plugin(default_svc_plugin)\r\n\t\t\r\n\t\t\r\n\t\t// RENDERING PLUGINS MANAGER\r\n\t\t// const default_plugin_path = arg_runtime.context.get_absolute_path(__dirname, '../../../node_modules', 'devapt-core-common/dist/js/default_plugins/rendering_default_plugin')\r\n\t\t// const plugins = [default_plugin_path]\r\n\t\tconst plugins = []\r\n\t\tthis.rendering_manager = new RenderingManager(arg_runtime, context, arg_runtime.get_logger_manager())\r\n\t\tthis.rendering_manager.load(plugins)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get services plugins manager.\r\n\t * @returns {FeaturesManager}\r\n\t */\r\n\tget_services_manager()\r\n\t{\r\n\t\tassert( T.isObject(this.services_manager), context + ':get_services_manager:bad services manager object')\r\n\t\treturn this.services_manager\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get rendering plugins manager.\r\n\t * @returns {FeaturesManager}\r\n\t */\r\n\tget_rendering_manager()\r\n\t{\r\n\t\tassert( T.isObject(this.rendering_manager), context + ':get_rendering_manager:bad rendering manager object')\r\n\t\treturn this.rendering_manager\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/plugins_factory.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 420,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/plugins_factory.js",
    "static": true,
    "longname": "js/plugins/plugins_factory.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/plugins_factory.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 421,
    "kind": "class",
    "name": "PluginsFactory",
    "memberof": "js/plugins/plugins_factory.js",
    "static": true,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/plugins_factory.js",
    "importStyle": "PluginsFactory",
    "description": "Plugin class for renderers plugin.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false
  },
  {
    "__docId__": 422,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#constructor",
    "access": null,
    "description": "Create a PluginsFactory instance.",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_runtime",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 423,
    "kind": "member",
    "name": "is_plugins_factory",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#is_plugins_factory",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 424,
    "kind": "member",
    "name": "services_manager",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#services_manager",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 425,
    "kind": "member",
    "name": "rendering_manager",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#rendering_manager",
    "access": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 426,
    "kind": "method",
    "name": "get_services_manager",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#get_services_manager",
    "access": null,
    "description": "Get services plugins manager.",
    "lineNumber": 54,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{FeaturesManager}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "FeaturesManager"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 427,
    "kind": "method",
    "name": "get_rendering_manager",
    "memberof": "js/plugins/plugins_factory.js~PluginsFactory",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_factory.js~PluginsFactory#get_rendering_manager",
    "access": null,
    "description": "Get rendering plugins manager.",
    "lineNumber": 65,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{FeaturesManager}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "FeaturesManager"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 428,
    "kind": "file",
    "name": "js/plugins/plugins_manager.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T          from 'devapt-core-common/dist/js/utils/types'\r\nimport Errorable  from 'devapt-core-common/dist/js/base/errorable'\r\nimport Collection from 'devapt-core-common/dist/js/base/collection'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\n\r\n\r\nlet context = 'server/plugins/plugins_manager'\r\n\r\n\r\n\r\n/**\r\n * @file Plugins manager class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class PluginsManager extends Errorable\r\n{\r\n\t/**\r\n\t * Create a plugins manager instance.\r\n\t * @extends Errorable\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_plugins_manager = true\r\n\t\t\r\n\t\tthis._runtime = arg_runtime\r\n\t\tthis.registered_plugins = new Collection()\r\n\t\tthis.enabled_plugins = new Collection()\r\n\t}\r\n\r\n\r\n\tget_runtime()\r\n\t{\r\n\t\treturn this._runtime\r\n\t}\r\n\t\r\n\t\r\n    /**\r\n     * Load a map of plugins.\r\n     * @param {array} arg_plugins - plugins file name or class array.\r\n     * @returns {nothing}\r\n     */\r\n\tload(arg_plugins)\r\n\t{\r\n\t\tthis.update_trace_enabled()\r\n\t\t\r\n\t\t// console.log(arg_plugins, 'arg_plugins')\r\n\t\t// const base_dir = get_base_dir()\r\n        \r\n\t\tfor(let plugin of arg_plugins)\r\n\t\t{\r\n\t\t\t// GIVEN PLUGIN IS A RELATIVE FILE PATH NAME\r\n\t\t\tif ( T.isString(plugin) )\r\n\t\t\t{\r\n\t\t\t\t// const plugin_dir = plugin != default_plugin_path ? base_dir : __dirname\r\n\r\n\t\t\t\t// const file_path_name = path.isAbsolute(plugin) ? plugin : path.join(plugin_dir, plugin)\r\n\t\t\t\tconst file_path_name = runtime.context.get_absolute_plugin_path(plugin)\r\n\t\t\t\tconsole.info('loading plugin [' + plugin + '] at [' + (file_path_name == plugin ? 'same' : file_path_name) + ']')\r\n\r\n\t\t\t\ttry\r\n\t\t\t\t{\r\n\t\t\t\t\tconst required = require(file_path_name)\r\n\t\t\t\t\tconst PluginClass = ('default' in required) ? required.default : required\r\n\t\t\t\t\t// console.log('loading rendering plugin class', PluginClass)\r\n\t\t\t\t\t\r\n\t\t\t\t\tplugin = new PluginClass(this._runtime, this)\r\n\t\t\t\t}\r\n\t\t\t\tcatch(e)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.error(context + '.load:' + plugin + 'failed', e)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// GIVEN PLUGIN IS A PLUGIN CLASS INSTANCE\r\n\t\t\tif ( T.isObject(plugin) && this.plugin_is_valid(plugin) )\r\n\t\t\t{\r\n\t\t\t\tconst plugin_name = plugin.get_name()\r\n\t\t\t\tif ( T.isString(plugin_name) )\r\n\t\t\t\t{\r\n\t\t\t\t\t// this.plugins[plugin_name] = plugin\r\n\t\t\t\t\t// this.plugins_ordered.push(plugin)\r\n\t\t\t\t\tthis.register_plugin(plugin)\r\n\t\t\t\t\tcontinue\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// UNKNOW PLUGIN TYPE\r\n\t\t\tconsole.error(plugin, 'plugin')\r\n\t\t\tassert(false, context + ':bad plugin')\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Load plugin at first position\r\n\t * @param {Plugin} arg_plugin - plugin instance\r\n\t * @returns {nothing}\r\n\t */\r\n\tload_at_first(arg_plugin)\r\n\t{\r\n\t\tassert( T.isObject(arg_plugin) && this.plugin_is_valid(arg_plugin), context + ':load_at_first:bad plugin object')\r\n\t\tthis.register_plugin(arg_plugin, 0)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Test if plugin is valid.\r\n\t * @abstract\r\n\t * @method plugin_is_valid\r\n\t * @param {Plugin} arg_plugin - plugin instance.\r\n\t * @returns {boolean} - given plugin is valid for this manager.\r\n\t */\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get registered plugins list.\r\n\t * @returns {array} - plugins list \r\n\t */\r\n\tget_plugins()\r\n\t{\r\n\t\treturn this.registered_plugins.get_all()\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get registered plugins list with a filtered type.\r\n\t * @param {string|array} arg_type_or_types - type name or types names array\r\n\t * @returns {array} - plugins list \r\n\t */\r\n\tget_typed_plugins(arg_type_or_types)\r\n\t{\r\n\t\treturn this.registered_plugins.get_all(arg_type_or_types)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Register a plugin to be used later, do not active it now.\r\n\t * @param {object} arg_plugin - plugin instance.\r\n\t * @param {integer} arg_position - index in array (0:first or undefined)\r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n\t */\r\n\tregister_plugin(arg_plugin, arg_position)\r\n\t{\r\n\t\tassert( T.isObject(arg_plugin) && arg_plugin.is_plugin, context + ':bad plugin object')\r\n\r\n\t\tconst plugin_name = arg_plugin.get_name()\r\n\t\tif (this.registered_plugins.find_by_name(plugin_name) )\r\n\t\t{\r\n\t\t\tthis.error_already_registered(plugin_name)\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t}\r\n\t\t\r\n\t\tif (arg_position === 0)\r\n\t\t{\r\n\t\t\tthis.registered_plugins.add_first(arg_plugin)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.registered_plugins.add(arg_plugin)\r\n\t\t}\r\n\t\t// arg_plugin.manager = this\r\n\r\n\t\treturn Promise.resolve(true)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Unregister a registered plugin and disble it before if needed.\r\n\t * @param {object} arg_plugin - plugin instance.\r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n\t */\r\n\tunregister_plugin(arg_plugin)\r\n\t{\r\n\t\tassert( T.isObject(arg_plugin) && arg_plugin.is_plugin, context + ':bad plugin object')\r\n\t\t\r\n\t\tconst plugin_name = arg_plugin.get_name()\r\n\t\t\r\n\t\t// PLUGIN IS REGISTERED ?\r\n\t\tif ( ! this.registered_plugins.has(arg_plugin) )\r\n\t\t{\r\n\t\t\tthis.error_not_registered(plugin_name)\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t}\r\n\t\t\r\n\t\tlet disable_promise = Promise.resolve(true)\r\n\t\t\r\n\t\t// PLUGIN IS ENABLED ?\r\n\t\tif (this.enabled_plugins.has(arg_plugin) )\r\n\t\t{\r\n\t\t\tthis.enabled_plugins.remove(arg_plugin)\r\n\t\t\tdisable_promise = arg_plugin.disable()\r\n\t\t}\r\n\t\t\r\n\t\t// UNREGISTER\r\n\t\tthis.registered_plugins.remove(arg_plugin)\r\n\t\targ_plugin.manager = null\r\n\t\tdelete arg_plugin.manager\r\n\t\t\r\n\t\treturn disable_promise\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get a registered plugin by its name and its enabled flag.\r\n\t * @param {string} arg_name - registered plugin name\r\n\t * @param {boolean} arg_enabled - plugin is enabled ?\r\n\t * @returns {Plugin}\r\n\t */\r\n\tplugin(arg_name, arg_enabled)\r\n\t{\r\n\t\tif (arg_enabled)\r\n\t\t{\r\n\t\t\treturn this.enabled_plugins.item(arg_name)\r\n\t\t}\r\n\t\treturn this.registered_plugins.item(arg_name)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get a registered plugin by its name.\r\n\t * @param {string} arg_name - registered plugin name\r\n\t * @returns {Plugin}\r\n\t */\r\n\tregistered_plugin(arg_name)\r\n\t{\r\n\t\treturn this.registered_plugins.item(arg_name)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get a enabled plugin by its name.\r\n\t * @param {string} arg_name - enabled plugin name\r\n\t * @returns {Plugin}\r\n\t */\r\n\tenabled_plugin(arg_name)\r\n\t{\r\n\t\treturn this.enabled_plugins.item(arg_name)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - on registering an already registered plugin\r\n\t * @param {string} arg_plugin_name - plugin name\r\n\t * @returns {nothing}\r\n\t */\r\n\terror_already_registered(arg_plugin_name)\r\n\t{\r\n\t\tthis.error('plugin with name [' + arg_plugin_name + '] is already registered')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - a plugin is not registered\r\n\t * @param {string} arg_plugin_name - plugin name\r\n\t * @returns {nothing}\r\n\t */\r\n\terror_not_registered(arg_plugin_name)\r\n\t{\r\n\t\tthis.error('plugin with name [' + arg_plugin_name + '] is not registered')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/plugins_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 429,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/plugins_manager.js",
    "static": true,
    "longname": "js/plugins/plugins_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/plugins_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 430,
    "kind": "class",
    "name": "PluginsManager",
    "memberof": "js/plugins/plugins_manager.js",
    "static": true,
    "longname": "js/plugins/plugins_manager.js~PluginsManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/plugins_manager.js",
    "importStyle": "PluginsManager",
    "description": "",
    "lineNumber": 22,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Plugins manager class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/errorable~Errorable"
    ]
  },
  {
    "__docId__": 431,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#constructor",
    "access": null,
    "description": "Create a plugins manager instance.",
    "lineNumber": 33,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Errorable"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 432,
    "kind": "member",
    "name": "is_plugins_manager",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#is_plugins_manager",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 433,
    "kind": "member",
    "name": "_runtime",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#_runtime",
    "access": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 434,
    "kind": "member",
    "name": "registered_plugins",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#registered_plugins",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 435,
    "kind": "member",
    "name": "enabled_plugins",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#enabled_plugins",
    "access": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 436,
    "kind": "method",
    "name": "get_runtime",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#get_runtime",
    "access": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 437,
    "kind": "method",
    "name": "load",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#load",
    "access": null,
    "description": "Load a map of plugins.",
    "lineNumber": 56,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugins",
        "description": "plugins file name or class array."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 438,
    "kind": "method",
    "name": "load_at_first",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#load_at_first",
    "access": null,
    "description": "Load plugin at first position",
    "lineNumber": 113,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Plugin"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 439,
    "kind": "method",
    "name": "get_plugins",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#get_plugins",
    "access": null,
    "description": "Get registered plugins list.",
    "lineNumber": 134,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{array} - plugins list "
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "array"
      ],
      "spread": false,
      "description": "plugins list"
    }
  },
  {
    "__docId__": 440,
    "kind": "method",
    "name": "get_typed_plugins",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#get_typed_plugins",
    "access": null,
    "description": "Get registered plugins list with a filtered type.",
    "lineNumber": 145,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{array} - plugins list "
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type_or_types",
        "description": "type name or types names array"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "array"
      ],
      "spread": false,
      "description": "plugins list"
    }
  },
  {
    "__docId__": 441,
    "kind": "method",
    "name": "register_plugin",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#register_plugin",
    "access": null,
    "description": "Register a plugin to be used later, do not active it now.",
    "lineNumber": 157,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance."
      },
      {
        "nullable": null,
        "types": [
          "integer"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_position",
        "description": "index in array (0:first or undefined)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 442,
    "kind": "method",
    "name": "unregister_plugin",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#unregister_plugin",
    "access": null,
    "description": "Unregister a registered plugin and disble it before if needed.",
    "lineNumber": 187,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 443,
    "kind": "method",
    "name": "plugin",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#plugin",
    "access": null,
    "description": "Get a registered plugin by its name and its enabled flag.",
    "lineNumber": 224,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Plugin}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "registered plugin name"
      },
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_enabled",
        "description": "plugin is enabled ?"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Plugin"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 444,
    "kind": "method",
    "name": "registered_plugin",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#registered_plugin",
    "access": null,
    "description": "Get a registered plugin by its name.",
    "lineNumber": 239,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Plugin}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "registered plugin name"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Plugin"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 445,
    "kind": "method",
    "name": "enabled_plugin",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#enabled_plugin",
    "access": null,
    "description": "Get a enabled plugin by its name.",
    "lineNumber": 250,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Plugin}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "enabled plugin name"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Plugin"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 446,
    "kind": "method",
    "name": "error_already_registered",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#error_already_registered",
    "access": null,
    "description": "Error wrapper - on registering an already registered plugin",
    "lineNumber": 261,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin_name",
        "description": "plugin name"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 447,
    "kind": "method",
    "name": "error_not_registered",
    "memberof": "js/plugins/plugins_manager.js~PluginsManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/plugins_manager.js~PluginsManager#error_not_registered",
    "access": null,
    "description": "Error wrapper - a plugin is not registered",
    "lineNumber": 272,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin_name",
        "description": "plugin name"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 448,
    "kind": "file",
    "name": "js/plugins/rendering_manager.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport FeaturesManager from './features_manager'\r\n\r\n\r\n\r\nconst context = 'server/plugins/rendering_manager'\r\n\r\n\r\n\r\n\r\n/**\r\n * Rendering manager class for renderer plugins managing.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class RenderingManager extends FeaturesManager\r\n{\r\n    /**\r\n     * Create a RenderingManager instance\r\n\t * @extends FeaturesManager\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_rendering_manager = true\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Test if plugin is valid.\r\n\t * @param {Plugin} arg_plugin - plugin instance.\r\n\t * @returns {boolean} - given plugin is valid for this manager.\r\n\t */\r\n\tplugin_is_valid(arg_plugin)\r\n\t{\r\n\t\treturn arg_plugin.is_rendering_plugin\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get all plugin public assets (CSS, JS, HTML...).\r\n\t * @returns {object} - a map of assets: plugin name => type => public name => absolute file path\r\n\t */\r\n\tget_public_assets()\r\n\t{\r\n\t\tlet assets = {}\r\n\t\tthis.registered_plugins.forEach(\r\n\t\t\t(plugin) => {\r\n\t\t\t\tassets[plugin.get_name()] = plugin.get_public_assets()\r\n\t\t\t}\r\n\t\t)\r\n\t\treturn assets\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get all plugin public  assets.\r\n\t * @param {string} arg_type - asset type: js, css, html...\r\n\t * @returns {object} - a map of assets:public name => absolute file path\r\n\t */\r\n\tget_public_assets_of_type(arg_type)\r\n\t{\r\n\t\tassert( T.isString(arg_type), context + ':get_public_assets_of_type:bad asset type string')\r\n\t\targ_type = arg_type.toLocaleLowerCase()\r\n\t\t\r\n\t\tlet assets = {}\r\n\t\tthis.registered_plugins.forEach(\r\n\t\t\t(plugin) => {\r\n\t\t\t\tconst plugin_assets = plugin.get_public_assets_of_type(arg_type)\r\n\t\t\t\tassets = Object.assign(assets, plugin_assets)\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\treturn assets\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get all plugin public JS assets.\r\n\t * @returns {object} - a map of assets:public name => absolute file path\r\n\t */\r\n\tget_public_js_assets()\r\n\t{\r\n\t\treturn this.get_public_assets_of_type('js')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get all plugin public css assets.\r\n\t * @returns {object} - a map of assets:public name => absolute file path\r\n\t */\r\n\tget_public_css_assets()\r\n\t{\r\n\t\treturn this.get_public_assets_of_type('css')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get all plugin public html assets.\r\n\t * @returns {object} - a map of assets:public name => absolute file path\r\n\t */\r\n\tget_public_html_assets()\r\n\t{\r\n\t\treturn this.get_public_assets_of_type('html')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/rendering_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 449,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/rendering_manager.js",
    "static": true,
    "longname": "js/plugins/rendering_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/rendering_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 450,
    "kind": "class",
    "name": "RenderingManager",
    "memberof": "js/plugins/rendering_manager.js",
    "static": true,
    "longname": "js/plugins/rendering_manager.js~RenderingManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/rendering_manager.js",
    "importStyle": "RenderingManager",
    "description": "Rendering manager class for renderer plugins managing.",
    "lineNumber": 22,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/features_manager.js~FeaturesManager"
    ]
  },
  {
    "__docId__": 451,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#constructor",
    "access": null,
    "description": "Create a RenderingManager instance",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "FeaturesManager"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 452,
    "kind": "member",
    "name": "is_rendering_manager",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#is_rendering_manager",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 453,
    "kind": "method",
    "name": "plugin_is_valid",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#plugin_is_valid",
    "access": null,
    "description": "Test if plugin is valid.",
    "lineNumber": 44,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - given plugin is valid for this manager."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Plugin"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "given plugin is valid for this manager."
    }
  },
  {
    "__docId__": 454,
    "kind": "method",
    "name": "get_public_assets",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#get_public_assets",
    "access": null,
    "description": "Get all plugin public assets (CSS, JS, HTML...).",
    "lineNumber": 55,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a map of assets: plugin name => type => public name => absolute file path"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a map of assets: plugin name => type => public name => absolute file path"
    }
  },
  {
    "__docId__": 455,
    "kind": "method",
    "name": "get_public_assets_of_type",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#get_public_assets_of_type",
    "access": null,
    "description": "Get all plugin public  assets.",
    "lineNumber": 72,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a map of assets:public name => absolute file path"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "asset type: js, css, html..."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a map of assets:public name => absolute file path"
    }
  },
  {
    "__docId__": 456,
    "kind": "method",
    "name": "get_public_js_assets",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#get_public_js_assets",
    "access": null,
    "description": "Get all plugin public JS assets.",
    "lineNumber": 93,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a map of assets:public name => absolute file path"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a map of assets:public name => absolute file path"
    }
  },
  {
    "__docId__": 457,
    "kind": "method",
    "name": "get_public_css_assets",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#get_public_css_assets",
    "access": null,
    "description": "Get all plugin public css assets.",
    "lineNumber": 103,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a map of assets:public name => absolute file path"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a map of assets:public name => absolute file path"
    }
  },
  {
    "__docId__": 458,
    "kind": "method",
    "name": "get_public_html_assets",
    "memberof": "js/plugins/rendering_manager.js~RenderingManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/rendering_manager.js~RenderingManager#get_public_html_assets",
    "access": null,
    "description": "Get all plugin public html assets.",
    "lineNumber": 113,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a map of assets:public name => absolute file path"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a map of assets:public name => absolute file path"
    }
  },
  {
    "__docId__": 459,
    "kind": "file",
    "name": "js/plugins/servers_manager.js",
    "content": "// SERVER IMPORTS\r\nimport FeaturesManager from './features_manager'\r\n\r\n\r\nconst context = 'server/plugins/servers_manager'\r\n\r\n\r\n\r\n/**\r\n * Servers manager class for plugins managing.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ServersManager extends FeaturesManager\r\n{\r\n    /**\r\n     * Create a ServersManager instance\r\n\t * @extends FeaturesManager\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_service_manager = true\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Test if plugin is valid.\r\n\t * @param {Plugin} arg_plugin - plugin instance.\r\n\t * @returns {boolean} - given plugin is valid for this manager.\r\n\t */\r\n\tplugin_is_valid(arg_plugin)\r\n\t{\r\n\t\treturn arg_plugin.is_servers_plugin\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/servers_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 460,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/servers_manager.js",
    "static": true,
    "longname": "js/plugins/servers_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/servers_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 461,
    "kind": "class",
    "name": "ServersManager",
    "memberof": "js/plugins/servers_manager.js",
    "static": true,
    "longname": "js/plugins/servers_manager.js~ServersManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/servers_manager.js",
    "importStyle": "ServersManager",
    "description": "Servers manager class for plugins managing.",
    "lineNumber": 14,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/features_manager.js~FeaturesManager"
    ]
  },
  {
    "__docId__": 462,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/servers_manager.js~ServersManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/servers_manager.js~ServersManager#constructor",
    "access": null,
    "description": "Create a ServersManager instance",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "FeaturesManager"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 463,
    "kind": "member",
    "name": "is_service_manager",
    "memberof": "js/plugins/servers_manager.js~ServersManager",
    "static": false,
    "longname": "js/plugins/servers_manager.js~ServersManager#is_service_manager",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 464,
    "kind": "method",
    "name": "plugin_is_valid",
    "memberof": "js/plugins/servers_manager.js~ServersManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/servers_manager.js~ServersManager#plugin_is_valid",
    "access": null,
    "description": "Test if plugin is valid.",
    "lineNumber": 36,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - given plugin is valid for this manager."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Plugin"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "given plugin is valid for this manager."
    }
  },
  {
    "__docId__": 465,
    "kind": "file",
    "name": "js/plugins/servers_plugin.js",
    "content": "// COMMON IMPORTS\r\nimport FeaturesPlugin from 'devapt-core-common/dist/js/plugins/features_plugin'\r\n\r\n\r\nconst context = 'server/plugins/servers_plugin'\r\n\r\n\r\n\r\n/**\r\n * Plugin class for servers plugin.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ServersPlugin extends FeaturesPlugin\r\n{\r\n    /**\r\n     * Create a ServersPlugin instance.\r\n\t * @extends Instance\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime instance.\r\n\t * @param {PluginsManager} arg_manager - plugins manager3\r\n\t * @param {string} arg_name - plugin name3\r\n\t * @param {string} arg_version - plugin version.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tconstructor(arg_runtime, arg_manager, arg_name, arg_version)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_manager, arg_name, 'ServersPlugin', { version: arg_version }, context)\r\n\t\t\r\n\t\tthis.is_servers_plugin = true\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/servers_plugin.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 466,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/servers_plugin.js",
    "static": true,
    "longname": "js/plugins/servers_plugin.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/servers_plugin.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 467,
    "kind": "class",
    "name": "ServersPlugin",
    "memberof": "js/plugins/servers_plugin.js",
    "static": true,
    "longname": "js/plugins/servers_plugin.js~ServersPlugin",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/servers_plugin.js",
    "importStyle": "ServersPlugin",
    "description": "Plugin class for servers plugin.",
    "lineNumber": 14,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/plugins/features_plugin~FeaturesPlugin"
    ]
  },
  {
    "__docId__": 468,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/servers_plugin.js~ServersPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/servers_plugin.js~ServersPlugin#constructor",
    "access": null,
    "description": "Create a ServersPlugin instance.",
    "lineNumber": 27,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Instance"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime instance."
      },
      {
        "nullable": null,
        "types": [
          "PluginsManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_manager",
        "description": "plugins manager3"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "plugin name3"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_version",
        "description": "plugin version."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 469,
    "kind": "member",
    "name": "is_servers_plugin",
    "memberof": "js/plugins/servers_plugin.js~ServersPlugin",
    "static": false,
    "longname": "js/plugins/servers_plugin.js~ServersPlugin#is_servers_plugin",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 470,
    "kind": "file",
    "name": "js/plugins/services_manager.js",
    "content": "// SERVER IMPORTS\r\nimport FeaturesManager from './features_manager'\r\n\r\n\r\nconst context = 'server/plugins/services_manager'\r\n\r\n\r\n\r\n/**\r\n * Services manager class for plugins managing.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ServicesManager extends FeaturesManager\r\n{\r\n    /**\r\n     * Create a ServicesManager instance\r\n\t * @extends FeaturesManager\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_service_manager = true\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Test if plugin is valid.\r\n\t * @param {Plugin} arg_plugin - plugin instance.\r\n\t * @returns {boolean} - given plugin is valid for this manager.\r\n\t */\r\n\tplugin_is_valid(arg_plugin)\r\n\t{\r\n\t\treturn arg_plugin.is_services_plugin\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/plugins/services_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 471,
    "kind": "variable",
    "name": "context",
    "memberof": "js/plugins/services_manager.js",
    "static": true,
    "longname": "js/plugins/services_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/plugins/services_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 472,
    "kind": "class",
    "name": "ServicesManager",
    "memberof": "js/plugins/services_manager.js",
    "static": true,
    "longname": "js/plugins/services_manager.js~ServicesManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/plugins/services_manager.js",
    "importStyle": "ServicesManager",
    "description": "Services manager class for plugins managing.",
    "lineNumber": 14,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/features_manager.js~FeaturesManager"
    ]
  },
  {
    "__docId__": 473,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/plugins/services_manager.js~ServicesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/services_manager.js~ServicesManager#constructor",
    "access": null,
    "description": "Create a ServicesManager instance",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "FeaturesManager"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 474,
    "kind": "member",
    "name": "is_service_manager",
    "memberof": "js/plugins/services_manager.js~ServicesManager",
    "static": false,
    "longname": "js/plugins/services_manager.js~ServicesManager#is_service_manager",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 475,
    "kind": "method",
    "name": "plugin_is_valid",
    "memberof": "js/plugins/services_manager.js~ServicesManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/plugins/services_manager.js~ServicesManager#plugin_is_valid",
    "access": null,
    "description": "Test if plugin is valid.",
    "lineNumber": 36,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - given plugin is valid for this manager."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Plugin"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin",
        "description": "plugin instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "given plugin is valid for this manager."
    }
  },
  {
    "__docId__": 476,
    "kind": "file",
    "name": "js/runtime/index.js",
    "content": "\r\nimport RuntimeStage0Executable from './stage0_create_local_node_executable'\r\nimport RuntimeStage1Executable from './stage1_define_topology_executable'\r\nimport RuntimeStage2Executable from './stage2_load_local_topology_executable'\r\nimport RuntimeStage3Executable from './stage3_start_local_node_executable'\r\n\r\n\r\n\r\nexport {\r\n\tRuntimeStage0Executable,\r\n\tRuntimeStage1Executable,\r\n\tRuntimeStage2Executable,\r\n\tRuntimeStage3Executable\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/index.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 477,
    "kind": "file",
    "name": "js/runtime/runtime_executable.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T          from 'devapt-core-common/dist/js/utils/types'\r\nimport Executable from 'devapt-core-common/dist/js/base/executable'\r\n\r\n\r\nlet context = 'server/runtime/runtime_sexecutable'\r\n\r\n\r\n\r\n/**\r\n * @file Runtime stages base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n*/\r\nexport default class RuntimeExecutable extends Executable\r\n{\r\n    /**\r\n     * Create a runtime executable base class.\r\n\t * @extends Executable\r\n\t * @abstract\r\n     * @param {string|undefined} arg_log_context - (optional).\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\tthis.$name = 'no name'\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Prepare an execution with contextual informations.\r\n     * @param {object} arg_settings - execution settings.\r\n     * @returns {nothing}\r\n     */\r\n\tprepare(arg_settings)\r\n\t{\r\n\t\tassert( T.isObject(arg_settings), context + ':prepare:bad settings object')\r\n\t\tassert(T.isObject(arg_settings.runtime), context + ':bad runtime object')\r\n\t\tthis.runtime = arg_settings.runtime\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n     * Execution with contextual informations.\r\n     * @abstract\r\n     * @returns {Promise} - promise of a result.\r\n     */\r\n\texecute()\r\n\t{\r\n\t\tthis.enter_group('execute')\r\n\t\t\r\n\t\tthis.info('not yet implemented')\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\treturn Promise.reject(context + ':execute:not yet implemented')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/runtime_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 478,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/runtime_executable.js",
    "static": true,
    "longname": "js/runtime/runtime_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/runtime_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 479,
    "kind": "class",
    "name": "RuntimeExecutable",
    "memberof": "js/runtime/runtime_executable.js",
    "static": true,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/runtime_executable.js",
    "importStyle": "RuntimeExecutable",
    "description": "",
    "lineNumber": 18,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Runtime stages base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/executable~Executable"
    ]
  },
  {
    "__docId__": 480,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable#constructor",
    "access": null,
    "description": "Create a runtime executable base class.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Executable"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "(optional)."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 481,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "static": false,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable#$name",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 482,
    "kind": "method",
    "name": "prepare",
    "memberof": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable#prepare",
    "access": null,
    "description": "Prepare an execution with contextual informations.",
    "lineNumber": 40,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "execution settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 483,
    "kind": "member",
    "name": "runtime",
    "memberof": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "static": false,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable#runtime",
    "access": null,
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 484,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/runtime_executable.js~RuntimeExecutable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/runtime_executable.js~RuntimeExecutable#execute",
    "access": null,
    "description": "Execution with contextual informations.",
    "lineNumber": 53,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - promise of a result."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "promise of a result."
    },
    "abstract": true
  },
  {
    "__docId__": 485,
    "kind": "file",
    "name": "js/runtime/stage0_create_local_node_executable.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// SERVER IMPORTS\r\nimport Node from '../nodes/node'\r\nimport RuntimeExecutable from './runtime_executable'\r\n\r\n\r\nlet context = 'server/runtime/runtime_stage0_executable'\r\n\r\n\r\n\r\n/**\r\n * Runtime Stage 0 consists of:\r\n * \t\t- create node\r\n * \t\t- create bus or connect to bus\r\n*/\r\nexport default class RuntimeStage0Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 0'\r\n\t}\r\n\t\r\n\t\r\n\texecute()\r\n\t{\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = true || this.runtime.get_setting(['trace', 'stages', 'RuntimeStage0', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\r\n\r\n\t\t// EXECUTES ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\t\t\r\n\t\tconst node_name = this.runtime.get_setting('name', null)\r\n\t\tconst master_name = this.runtime.get_setting(['master','name'])\r\n\t\t\r\n\t\tif (this.runtime.is_master)\r\n\t\t{\r\n\t\t\tthis.info('Node is master')\r\n\t\t\t// console.log(context + ':execute:Node is master')\r\n\t\t\tassert(node_name == master_name, context + ':node name [' + node_name + '] not equals master name [' + master_name + ']')\r\n\t\t\t\r\n\t\t\t// CREATE MASTER NODE\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.info('Node is not master')\r\n\t\t\t// console.log(context + ':execute:Node is not master')\r\n\t\t}\r\n\r\n\t\t// CREATE NODE\r\n\t\tthis.info('Create Node and load it')\r\n\t\tconst node_settings = this.runtime.get_settings()\r\n\t\tnode_settings.runtime = this.runtime\r\n\t\tnode_settings.logger_manager = this.get_logger_manager()\r\n\t\tthis.runtime.node = new Node(node_name, node_settings)\r\n\t\tthis.runtime.node.load()\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\r\n\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\r\n\t\treturn Promise.resolve()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/stage0_create_local_node_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 486,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/stage0_create_local_node_executable.js",
    "static": true,
    "longname": "js/runtime/stage0_create_local_node_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/stage0_create_local_node_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 487,
    "kind": "class",
    "name": "RuntimeStage0Executable",
    "memberof": "js/runtime/stage0_create_local_node_executable.js",
    "static": true,
    "longname": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/stage0_create_local_node_executable.js",
    "importStyle": "RuntimeStage0Executable",
    "description": "Runtime Stage 0 consists of:\n\t\t- create node\n\t\t- create bus or connect to bus",
    "lineNumber": 18,
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 488,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 489,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable",
    "static": false,
    "longname": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 490,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage0_create_local_node_executable.js~RuntimeStage0Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 491,
    "kind": "file",
    "name": "js/runtime/stage1_define_topology_executable.js",
    "content": "// NPM IMPORTS\r\n\r\n// COMMON IMPORTS\r\nimport T                   from 'devapt-core-common/dist/js/utils/types'\r\nimport JsonProviderFactory from 'devapt-core-common/dist/js/json_provider/json_provider_factory'\r\nimport TopologyDefineWorld from 'devapt-core-common/dist/js/topology/define/topology_define_world'\r\n\r\n// SERVER IMPORTS\r\nimport PluginsFactory      from '../plugins/plugins_factory'\r\nimport RuntimeExecutable   from './runtime_executable'\r\n\r\n\r\nlet context = 'server/runtime/runtime_stage1_executable'\r\n\r\n\r\n\r\n/**\r\n * @file Runtime Stage 1 loading class.\r\n * \r\n * Runtime Stage 1 consists of:\r\n * \t  - get world topology definition settings from registry\r\n *\t  - create world topology definition\r\n *    - load word topology definition\r\n * \r\n * @author Luc BORIES\r\n * \r\n * @license Apache-2.0\r\n*/\r\nexport default class RuntimeStage1Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 1'\r\n\t}\r\n\t\r\n\t// TODO MONITOR EXECUTE PROMISE !!!\r\n\texecute()\r\n\t{\r\n\t\tconst self = this\r\n\t\t\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = true || this.runtime.get_setting(['trace', 'stages', 'RuntimeStage1', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\t\t\r\n\r\n\t\t// EXECUTE ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\t\t\r\n\t\t\r\n\t\t// GET REGISTRY SETTINGS PROVIDER\r\n\t\tthis.info('Get registry settings provider')\r\n\t\tconst settings_provider = this.runtime.get_setting('settings_provider', null)\r\n\t\t\r\n\r\n\t\t// GET WORLD TOPOLOGY SETTINGS\r\n\t\tlet promise = null\r\n\t\tconst runtime = this.runtime\r\n\t\tconst logger_manager = this.runtime.get_logger_manager()\r\n\t\tif ( T.isObject(settings_provider) )\r\n\t\t{\r\n\t\t\tthis.info('Settings provider found for master')\r\n\t\t\t\r\n\t\t\tconst provider = JsonProviderFactory.create( settings_provider.set('runtime', runtime) )\r\n\t\t\tpromise = provider.provide_json()\r\n\t\t\t.then(\r\n\t\t\t\t// SUCCESS\r\n\t\t\t\tfunction(arg_json)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.info('Dispatching master settings into store')\r\n\t\t\t\t\t\r\n\t\t\t\t\t// console.log(arg_json, 'arg_json')\r\n\r\n\t\t\t\t\tconst base_dir = runtime.get_setting('base_dir', undefined)\r\n\t\t\t\t\tconst topology_dir = runtime.get_setting('world_dir', undefined)\r\n\t\t\t\t\tconst load_registry = runtime.get_registry().load(arg_json, base_dir, topology_dir)\r\n\t\t\t\t\tif ( ! load_registry)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst error = runtime.get_registry().get_error()\r\n\t\t\t\t\t\tconst str = runtime.get_registry().format_error(error)\r\n\t\t\t\t\t\tconsole.error(context + ':runtime.topology_registry.load:error', str)\r\n\t\t\t\t\t\tself.error(context + ':runtime.topology_registry.load:error:' + str)\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t.catch(\r\n\t\t\t\t// FAILURE\r\n\t\t\t\tfunction(arg_reason)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.error(context + ':Master settings loading failure:' + arg_reason)\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.error('Settings provider not found')\r\n\t\t\tpromise = Promise.reject('Settings provider not found for master')\r\n\t\t}\r\n\r\n\t\t\r\n\t\t// DEFINE WORLD TOPOLOGY\r\n\t\tthis.info('CREATE WORLD TOPOLOGY ITEM')\r\n\t\tpromise = promise.then(\r\n\t\t\tfunction()\r\n\t\t\t{\r\n\t\t\t\t// CREATE PLUGINS MANAGERS\r\n\t\t\t\tself.info('Creating plugins manager')\r\n\t\t\t\truntime.plugins_factory = new PluginsFactory(runtime)\r\n\t\t\t}\r\n\t\t)\r\n\t\t.catch(\r\n\t\t\t// FAILURE\r\n\t\t\tfunction(arg_reason)\r\n\t\t\t{\r\n\t\t\t\tself.error(context + ':World creation and loading failure:Creating plugins manager:' + arg_reason)\r\n\t\t\t\tconsole.error(context + ':World creation and loading failure:Creating plugins manager:' + arg_reason)\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t)\r\n\t\t.then(\r\n\t\t\tfunction()\r\n\t\t\t{\r\n\t\t\t\t// GET REGISTRY SETTINGS\r\n\t\t\t\tself.info('Get world definition settings from registry')\r\n\t\t\t\tconst world_settings = {\r\n\t\t\t\t\tnodes:runtime.get_registry().root.get('nodes').toJS(),\r\n\t\t\t\t\ttenants:runtime.get_registry().root.get('tenants').toJS(),\r\n\t\t\t\t\tplugins:runtime.get_registry().root.get('plugins').toJS(),\r\n\t\t\t\t\tsecurity:runtime.get_registry().root.get('security').toJS(),\r\n\t\t\t\t\tloggers:runtime.get_registry().root.get('loggers').toJS(),\r\n\t\t\t\t\ttraces:runtime.get_registry().root.get('traces').toJS()\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// CREATE WORLD TOPOLOGY DEFINITION ROOT\r\n\t\t\t\tself.info('Creating world topology definition root')\r\n\t\t\t\truntime.defined_world_topology = new TopologyDefineWorld('world', world_settings, runtime, logger_manager)\r\n\t\t\t}\r\n\t\t)\r\n\t\t.catch(\r\n\t\t\t// FAILURE\r\n\t\t\tfunction(arg_reason)\r\n\t\t\t{\r\n\t\t\t\tself.error(context + ':World creation and loading failure:Creating world topology definition root:' + arg_reason)\r\n\t\t\t\tconsole.error(context + ':World creation and loading failure:Creating world topology definition root:' + arg_reason)\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t)\r\n\t\t.then(\r\n\t\t\tfunction()\r\n\t\t\t{\r\n\t\t\t\t// LOAD WORLD TOPOLOGY DEFINITION\r\n\t\t\t\tself.info('Loading world topology definition')\r\n\t\t\t\treturn runtime.defined_world_topology.load()\r\n\t\t\t}\r\n\t\t)\r\n\t\t.catch(\r\n\t\t\t// FAILURE\r\n\t\t\tfunction(arg_reason)\r\n\t\t\t{\r\n\t\t\t\tself.error(context + ':World creation and loading failure:Loading world topology definition:' + arg_reason)\r\n\t\t\t\tconsole.error(context + ':World creation and loading failure:Loading world topology definition:' + arg_reason)\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\t\t\r\n\t\t\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\t\t\r\n\t\treturn promise\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/stage1_define_topology_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 492,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/stage1_define_topology_executable.js",
    "static": true,
    "longname": "js/runtime/stage1_define_topology_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/stage1_define_topology_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 493,
    "kind": "class",
    "name": "RuntimeStage1Executable",
    "memberof": "js/runtime/stage1_define_topology_executable.js",
    "static": true,
    "longname": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/stage1_define_topology_executable.js",
    "importStyle": "RuntimeStage1Executable",
    "description": "",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Runtime Stage 1 loading class.\n\nRuntime Stage 1 consists of:\n\t  - get world topology definition settings from registry\n  - create world topology definition\n   - load word topology definition"
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 494,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 495,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable",
    "static": false,
    "longname": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 34,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 496,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage1_define_topology_executable.js~RuntimeStage1Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 497,
    "kind": "file",
    "name": "js/runtime/stage2_load_local_topology_executable.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport RuntimeExecutable from './runtime_executable'\r\nimport TopologyDeployLocalNode from 'devapt-core-common/dist/js/topology/deploy/topology_deploy_local_node'\r\n\r\n\r\nlet context = 'server/runtime/runtime_stage2_executable'\r\n\r\n\r\n\r\n/**\r\n * Runtime Stage 2 consists of:\r\n * \t\t- Process previous loading errors\r\n * \t\t- Get world topology deployment from registry\r\n * \t\t- Create, load and apply world topology deployment\r\n*/\r\nexport default class RuntimeStage2Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 2'\r\n\t}\r\n\t\r\n\t\r\n\texecute()\r\n\t{\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = this.runtime.get_setting(['trace', 'stages', 'RuntimeStage2', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\t\t\r\n\r\n\t\t// EXECUTE ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\r\n\r\n\t\t// PROCESS ERROR\r\n\t\tthis.info('Process nodes settings loading error')\r\n\t\tconst nodes_cfg = this.runtime.get_registry().root.get('nodes')\r\n\t\tassert( T.isFunction(nodes_cfg.has), context + ':execute:bad nodes_cfg object')\r\n\t\tif ( nodes_cfg.has('error') )\r\n\t\t{\r\n\t\t\tthis.info('local node settings loading failure', nodes_cfg.get('error'))\r\n\t\t\tthis.error('local node settings loading failure')\r\n\t\t\t\r\n\t\t\tthis.leave_group('execute:error')\r\n\t\t\tthis.separate_level_1()\r\n\t\t\tthis.set_trace(saved_trace)\r\n\t\t\treturn Promise.reject('master settings loading failure')\r\n\t\t}\r\n\t\t\r\n\r\n\t\t// GET WORLD TOPOLOGY DEPLOYMENT FROM REGISTRY\r\n\t\tthis.info('Get world topology deployment from registry')\r\n\t\tconst node_settings = this.runtime.get_registry().get_collection_item('nodes', this.runtime.node.get_name())\r\n\t\tconsole.log(context + ':node_settings:' + this.runtime.node.get_name() + ':', node_settings)\r\n\t\t\r\n\t\tthis.runtime.node.load_topology_settings(node_settings)\r\n\r\n\r\n\t\t// CREATE, LOAD AND APPLY WORLD TOPOLOGY DEPLOYMENT\r\n\t\tthis.info('Deploy local topology')\r\n\t\tconst rt_factory = this.runtime.plugins_factory\r\n\t\tconst svc_mgr = rt_factory.get_services_manager()\r\n\t\tconst deploy_name = this.runtime.node.get_name()\r\n\t\tconst defined_item = this.runtime.defined_world_topology.node(deploy_name)\r\n\t\t\r\n\t\tlet deploy_settings = this.runtime.get_registry().root.get('deployments', fromJS({}) )\r\n\t\tdeploy_settings = deploy_settings.set('runtime', this.runtime)\r\n\t\tdeploy_settings = deploy_settings.set('logger_manager', this.runtime.get_logger_manager() )\r\n\t\t\r\n\t\tconst deploy_factory = {\r\n\t\t\tcreate:(arg_type, arg_name, arg_settings)=>{\r\n\t\t\t\tswitch(arg_type) {\r\n\t\t\t\t\tcase 'service':{\r\n\t\t\t\t\t\tconst svc_type = arg_settings.get('type', undefined)\r\n\t\t\t\t\t\tif (svc_mgr.has(svc_type))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn svc_mgr.create(svc_type, arg_name, arg_settings, {})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.error(context + ':DEPLOY LOCAL TOPOLOGY:deploy_factory.create:not found for type ' + arg_type)\r\n\t\t\t\treturn undefined\r\n\t\t\t}\r\n\t\t}\r\n\t\tassert( T.isObject(defined_item) && defined_item.is_topology_define_node, context + ':DEPLOY LOCAL TOPOLOGY:defined topology node not found for ' + deploy_name)\r\n\t\tthis.runtime.deployed_local_topology = new TopologyDeployLocalNode(deploy_name, defined_item, deploy_settings, deploy_factory)\r\n\t\tthis.runtime.deployed_local_topology.load()\r\n\t\tthis.runtime.deployed_local_topology.deploy()\r\n\r\n\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\t\t\r\n\t\t\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/stage2_load_local_topology_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 498,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/stage2_load_local_topology_executable.js",
    "static": true,
    "longname": "js/runtime/stage2_load_local_topology_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/stage2_load_local_topology_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 499,
    "kind": "class",
    "name": "RuntimeStage2Executable",
    "memberof": "js/runtime/stage2_load_local_topology_executable.js",
    "static": true,
    "longname": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/stage2_load_local_topology_executable.js",
    "importStyle": "RuntimeStage2Executable",
    "description": "Runtime Stage 2 consists of:\n\t\t- Process previous loading errors\n\t\t- Get world topology deployment from registry\n\t\t- Create, load and apply world topology deployment",
    "lineNumber": 23,
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 500,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 501,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable",
    "static": false,
    "longname": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 502,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage2_load_local_topology_executable.js~RuntimeStage2Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 503,
    "kind": "file",
    "name": "js/runtime/stage3_start_local_node_executable.js",
    "content": "// NPM IMPORTS\r\n// import assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\n// import T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport RuntimeExecutable from './runtime_executable'\r\n\r\n\r\nlet context = 'server/runtime/stage3_start_local_node_executable'\r\n\r\n\r\n\r\n/**\r\n * Runtime Stage 3 consists of:\r\n * \t\t- start local node: start all node features (serves...)\r\n*/\r\nexport default class RuntimeStage3Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 5'\r\n\t}\r\n\t\r\n\r\n\t\r\n\texecute()\r\n\t{\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = this.runtime.get_setting(['trace', 'stages', 'RuntimeStage3', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// EXECUTE ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\r\n\t\t\r\n\t\t// START NODE AND ITS SERVERS\r\n\t\tthis.runtime.node.start()\r\n\t\t\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\t\t\r\n\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve()\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/stage3_start_local_node_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 504,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/stage3_start_local_node_executable.js",
    "static": true,
    "longname": "js/runtime/stage3_start_local_node_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/stage3_start_local_node_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 505,
    "kind": "class",
    "name": "RuntimeStage3Executable",
    "memberof": "js/runtime/stage3_start_local_node_executable.js",
    "static": true,
    "longname": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/stage3_start_local_node_executable.js",
    "importStyle": "RuntimeStage3Executable",
    "description": "Runtime Stage 3 consists of:\n\t\t- start local node: start all node features (serves...)",
    "lineNumber": 19,
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 506,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 507,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable",
    "static": false,
    "longname": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 24,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 508,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/stage3_start_local_node_executable.js~RuntimeStage3Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 509,
    "kind": "file",
    "name": "js/runtime/unused_runtime_stage3_executable.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\n// import Module from 'devapt-core-common/dist/js/topology/runtime/topology_runtime_module'\r\n// import Database from 'devapt-core-common/dist/js/topology/runtime/topology_runtime_database'\r\n\r\n// SERVER IMPORTS\r\nimport RuntimeExecutable from './runtime_executable'\r\n\r\n\r\nlet context = 'server/runtime/runtime_stage3_executable'\r\n\r\n\r\n\r\n/**\r\n * Runtime Stage 3 consists of:\r\n * \t\t- create connexions, modules and plugins\r\n*/\r\nexport default class RuntimeStage3Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 3'\r\n\t}\r\n\t\r\n\t\r\n\texecute()\r\n\t{\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = this.runtime.get_setting(['trace', 'stages', 'RuntimeStage3', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// EXECUTE ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\t\t\r\n\t\tthis.load_tenants()\r\n\t\t// this.make_connexions()\r\n\t\t// this.make_modules()\r\n\t\tthis.make_plugins()\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\t\t\r\n\t\t\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve()\r\n\t}\r\n\t\r\n\t\r\n\tload_tenants()\r\n\t{\r\n\r\n\t}\r\n\r\n\r\n\t/*make_connexions()\r\n\t{\r\n\t\tthis.enter_group('make_connexions')\r\n\t\t\r\n\t\tif ( this.runtime.get_registry().root.hasIn( ['security', 'resources_by_name'] ) )\r\n\t\t{\r\n\t\t\tconst cfg_all_cx = this.runtime.get_registry().root.getIn( ['security', 'resources_by_name'] ).toArray()\r\n\t\t\tcfg_all_cx.forEach(\r\n\t\t\t\t(cfg_cx) => {\r\n\t\t\t\t\tconst cx_name = cfg_cx.get('name')\r\n\t\t\t\t\tthis.info('Processing connexion creation of:' + cx_name)\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet cx = new Database(cx_name, cfg_cx)\r\n\t\t\t\t\tcx.load()\r\n\t\t\t\t\tthis.runtime.get_topology().resources.add(cx)\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t\t\r\n\t\tthis.leave_group('make_connexions')\r\n\t}\r\n\t\r\n\t\r\n\tmake_modules()\r\n\t{\r\n\t\tthis.enter_group('make_modules')\r\n\t\t\r\n\t\t\r\n\t\t// CREATE MODULES\r\n\t\tlet cfg_modules = this.runtime.get_registry().get_collection('modules')\r\n\t\tcfg_modules.forEach(\r\n\t\t\t(module_cfg, module_name) => {\r\n\t\t\t\tif (module_name == 'error')\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.log(module_cfg, 'error')\r\n\t\t\t\t\tassert(false, context + ':an error occures in the modules loading process')\t\r\n\t\t\t\t}\r\n\t\t\t\tthis.info('Processing module creation of:' + module_name)\r\n\t\t\t\t\r\n\t\t\t\tlet module_obj = new Module(module_name, module_cfg)\r\n\t\t\t\tthis.info('Module created:' + module_name)\r\n\r\n\t\t\t\tmodule_obj.load()\r\n\t\t\t\tthis.info('Module loaded:' + module_name)\r\n\r\n\t\t\t\tthis.runtime.get_topology().modules.add(module_obj)\r\n\t\t\t\tthis.info('Module added to runtime topology:' + module_name)\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\t\r\n\t\t// LOOP MODULES RESOURCES AND LOAD MODELS ASSOCIATIONS AFTER ALL MODELS ARE CREATED\r\n\t\tfor(let module_obj of this.runtime.get_topology().modules.get_all())\r\n\t\t{\r\n\t\t\tthis.info('make_modules for [' + module_obj.$name + ']')\r\n\t\t\t\r\n\t\t\tfor(let res_obj of module_obj.resources.get_all() )\r\n\t\t\t{\r\n\t\t\t\tthis.runtime.get_topology().resources.add(res_obj)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor(let res_obj of module_obj.resources.get_all() )\r\n\t\t\t{\r\n\t\t\t\tif (res_obj.is_topology_model)\r\n\t\t\t\t{\r\n\t\t\t\t\t// this.info('make_modules for [' + module_obj.$name + '] for model [' + res_obj.$name + ']')\r\n\t\t\t\t\t\r\n\t\t\t\t\tres_obj.load_associations()\r\n\t\t\t\t\tres_obj.load_includes()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tthis.leave_group('make_modules')\r\n\t}*/\r\n\t\r\n\t\r\n\tmake_plugins()\r\n\t{\r\n\t\tthis.enter_group('make_plugins')\r\n\t\t\r\n\t\t// TODO\r\n\t\t/*\r\n\t\tlet cfg_plugins = store.get_collection('plugins')\r\n\t\tcfg_plugins.forEach(\r\n\t\t\t(plugin_cfg, plugin_name) => {\r\n\t\t\t\tthis.info('Processing plugin creation of:' + plugin_name)\r\n\t\t\t\t\r\n\t\t\t\tlet plugin = new Plugin(plugin_name, plugin_cfg)\r\n\t\t\t\tplugin.load()\r\n\t\t\t\tthis.runtime.get_topology().plugins.add(plugin)\r\n\t\t\t}\r\n\t\t)*/\r\n\t\t\r\n\t\tthis.leave_group('make_plugins')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage3_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 510,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/unused_runtime_stage3_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 511,
    "kind": "class",
    "name": "RuntimeStage3Executable",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/unused_runtime_stage3_executable.js",
    "importStyle": "RuntimeStage3Executable",
    "description": "Runtime Stage 3 consists of:\n\t\t- create connexions, modules and plugins",
    "lineNumber": 20,
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 512,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 513,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "static": false,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 514,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 515,
    "kind": "method",
    "name": "load_tenants",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable#load_tenants",
    "access": null,
    "description": null,
    "lineNumber": 63,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": []
  },
  {
    "__docId__": 516,
    "kind": "method",
    "name": "make_plugins",
    "memberof": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage3_executable.js~RuntimeStage3Executable#make_plugins",
    "access": null,
    "description": null,
    "lineNumber": 147,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": []
  },
  {
    "__docId__": 517,
    "kind": "file",
    "name": "js/runtime/unused_runtime_stage4_executable.js",
    "content": "// COMMON IMPORTS\r\n// import Application from 'devapt-core-common/dist/js/topology/runtime/topology_runtime_application'\r\n\r\n// SERVER IMPORTS\r\nimport RuntimeExecutable from './runtime_executable'\r\n\r\n\r\nlet context = 'server/runtime/runtime_stage4_executable'\r\n\r\n\r\n\r\n/**\r\n * Runtime Stage 4 consists of:\r\n * \t\t- create applications\r\n*/\r\nexport default class RuntimeStage4Executable extends RuntimeExecutable\r\n{\r\n\tconstructor(arg_logger_manager)\r\n\t{\r\n\t\tsuper(context, arg_logger_manager)\r\n\t\tthis.$name = 'stage 4'\r\n\t}\r\n\t\r\n\t\r\n\texecute()\r\n\t{\r\n\t\t// SAVE TRACES STATE\r\n\t\tconst saved_trace = this.get_trace()\r\n\t\tconst has_trace = this.runtime.get_setting(['trace', 'stages', 'RuntimeStage4', 'enabled'], false)\r\n\t\tif (has_trace)\r\n\t\t{\r\n\t\t\tthis.enable_trace()\r\n\t\t}\r\n\t\t\r\n\r\n\t\t// EXECUTE ACTIONS\r\n\t\tthis.separate_level_1()\r\n\t\tthis.enter_group('execute')\r\n\t\t\r\n\t\t// this.make_applications()\r\n\t\t\r\n\t\tthis.leave_group('execute')\r\n\t\tthis.separate_level_1()\r\n\t\t\r\n\t\t\r\n\t\t// RESTORE TRACES STATE\r\n\t\tif (! saved_trace && has_trace)\r\n\t\t{\r\n\t\t\tthis.disable_trace()\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.resolve()\r\n\t}\r\n\t\r\n\t\r\n\t// make_applications()\r\n\t// {\r\n\t// \tthis.enter_group('make_applications')\r\n\t\t\r\n\t// \tlet applications = this.runtime.get_registry().get_collection_names('applications')\r\n\t// \tapplications.forEach(\r\n\t// \t\t(application_name) => {\r\n\t// \t\t\tthis.info('Create application:' + application_name)\r\n\t\t\t\t\r\n\t// \t\t\tlet application = new Application(application_name)\r\n\t\t\t\t\r\n\t// \t\t\tapplication.load()\r\n\t\t\t\t\r\n\t// \t\t\tthis.runtime.get_topology().applications.add(application)\r\n\t// \t\t}\r\n\t// \t)\r\n\t\t\r\n\t// \tthis.leave_group('make_applications')\r\n\t// }\r\n}\r\n",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage4_executable.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 518,
    "kind": "variable",
    "name": "context",
    "memberof": "js/runtime/unused_runtime_stage4_executable.js",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage4_executable.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/runtime/unused_runtime_stage4_executable.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 519,
    "kind": "class",
    "name": "RuntimeStage4Executable",
    "memberof": "js/runtime/unused_runtime_stage4_executable.js",
    "static": true,
    "longname": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/runtime/unused_runtime_stage4_executable.js",
    "importStyle": "RuntimeStage4Executable",
    "description": "Runtime Stage 4 consists of:\n\t\t- create applications",
    "lineNumber": 16,
    "interface": false,
    "extends": [
      "js/runtime/runtime_executable.js~RuntimeExecutable"
    ]
  },
  {
    "__docId__": 520,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable#constructor",
    "access": null,
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "arg_logger_manager",
        "types": [
          "*"
        ]
      }
    ]
  },
  {
    "__docId__": 521,
    "kind": "member",
    "name": "$name",
    "memberof": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable",
    "static": false,
    "longname": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable#$name",
    "access": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 522,
    "kind": "method",
    "name": "execute",
    "memberof": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/runtime/unused_runtime_stage4_executable.js~RuntimeStage4Executable#execute",
    "access": null,
    "description": null,
    "lineNumber": 25,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 523,
    "kind": "file",
    "name": "js/security/authentication_manager.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T            from 'devapt-core-common/dist/js/utils/types'\r\nimport {is_browser} from 'devapt-core-common/dist/js/utils/is_browser'\r\n\r\nlet  forge = undefined\r\nif ( is_browser() )\r\n{\r\n\tforge = require('forge-browser').forge\r\n} else {\r\n\tforge = require('node-forge')\r\n}\r\n\r\n// COMMON IMPORTS\r\nimport Credentials from 'devapt-core-common/dist/js/base/credentials'\r\n\r\n// SERVER IMPORTS\r\nimport PluginsManager from '../plugins/plugins_manager'\r\n\r\n// import AuthenticationPluginPassportLocalDb from './authentication_plugin_passport_local_db'\r\n// import AuthenticationPluginPassportLocalFile from './authentication_plugin_passport_local_file'\r\nimport AuthenticationLowDbPlugin from './authentication_plugin_lowdb'\r\n\r\n\r\nlet context = 'server/security/authentication_manager'\r\n\r\n\r\n\r\n\r\n/**\r\n * Authentication class to manage authentication plugins.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationManager extends PluginsManager\r\n{\r\n\t/**\r\n\t * Create an Authentication manager class: load and create all authentication plugins.\r\n\t * AuthenticationWrapper use created plugins.\r\n\t * @extends PluginsManager\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_authentication_manager = true\r\n\t\t\r\n\t\tthis.authentication_is_enabled = true\r\n\t\tthis.authentication_mode = null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security settings.\r\n\t * \r\n\t * @param {object} arg_settings - authentication settings (Immutable object).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload(arg_settings)\r\n\t{\r\n\t\tthis.enter_group('load')\r\n\t\t\r\n\t\tassert(T.isObject(arg_settings), context + ':load:bad settings object')\r\n\t\tassert(T.isFunction(arg_settings.has), context + ':load:bad settings immutable')\r\n\t\tassert(arg_settings.has('enabled'), context + ':load:bad settings.enabled')\r\n\t\tassert(arg_settings.has('plugins'), context + ':load:bad settings.plugins')\r\n\t\tassert(arg_settings.has('default_plugins'), context + ':load:bad settings.default_plugins')\r\n\t\t\r\n\t\t// LOAD AUTHENTICATION SETTINGS\r\n\t\tthis.authentication_is_enabled = arg_settings.get('enabled')\r\n\t\tthis.authentication_plugins = arg_settings.get('plugins')\r\n\t\tthis.authentication_default_plugins = arg_settings.get('default_plugins')\r\n\t\t\r\n\t\t// LOAD PLUGINS\r\n\t\tconst keys = this.authentication_plugins.toMap().keySeq().toArray()\r\n\t\tkeys.forEach(\r\n\t\t\t(key) => {\r\n\t\t\t\tconst plugin_cfg = this.authentication_plugins.get(key)\r\n\t\t\t\tplugin_cfg.name = key\r\n\t\t\t\tconst result = this.load_plugin(plugin_cfg)\r\n\t\t\t\tif (! result)\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.error_bad_plugin(this.authentication_mode)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\t\r\n\t\t// TODO: default security plugin ?\r\n\t\t// TODO: alt plugin settings ?\r\n\t\t\r\n\t\tthis.leave_group('load')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security plugin from settings.\r\n\t * \r\n\t * @param {object} arg_settings - authentication settings (Immutable object).\r\n\t * \r\n\t * @returns {boolean}\r\n\t */\r\n\tload_plugin(arg_settings)\r\n\t{\r\n\t\tthis.enter_group('load_plugin')\r\n\t\t// console.log(arg_settings, context + ':load_plugin:arg_settings')\r\n\t\t\r\n\t\tconst self = this\r\n\t\t\r\n\t\tassert( T.isObject(arg_settings), context + ':load_plugin:bad settings object')\r\n\t\tassert( T.isFunction(arg_settings.has), context + ':load_plugin:bad settings immutable')\r\n\t\tassert( arg_settings.has('mode'), context + ':load_plugin:bad settings.mode')\r\n\t\tassert( T.isString(arg_settings.name) && arg_settings.name.length > 0, context + ':load_plugin:bad settings.name')\r\n\t\t\r\n\t\t// console.log(arg_settings.name, context + ':load_plugin:arg_settings.name')\r\n\t\targ_settings = arg_settings.set('runtime', this.get_runtime() )\r\n\t\targ_settings = arg_settings.set('logger_manager', this.get_logger_manager() )\r\n\t\t\r\n\t\t// LOAD PLUGIN\r\n\t\tconst mode = arg_settings.get('mode').toLocaleLowerCase()\r\n\t\tswitch(mode)\r\n\t\t{\r\n\t\t\tcase 'database':\r\n\t\t\t// {\r\n\t\t\t//\t const plugin = new AuthenticationPluginPassportLocalDb(context)\r\n\t\t\t//\t this.register_plugin(plugin)\r\n\t\t\t//\t plugin.enable(arg_settings)\r\n\t\t\t//\t return true\r\n\t\t\t// }\r\n\t\t\tcase 'jsonfile': {\r\n\t\t\t//\t const plugin = new AuthenticationPluginPassportLocalFile(context)\r\n\t\t\t//\t this.register_plugin(plugin)\r\n\t\t\t//\t plugin.enable(arg_settings)\r\n\t\t\t//\t return true\r\n\t\t\t// }\r\n\t\t\t// default: {\r\n\t\t\t\tconst plugin = new AuthenticationLowDbPlugin(this, arg_settings.name, context)\r\n\t\t\t\t// self.info(context + ':load_plugin:create plugin for mode [' + mode + '] for name [' + plugin.get_name() + ']')\r\n\t\t\t\t\r\n\t\t\t\tthis.register_plugin(plugin)\r\n\t\t\t\t.then(\r\n\t\t\t\t\t(result) => {\r\n\t\t\t\t\t\tif (result)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tplugin.enable(arg_settings)\r\n\t\t\t\t\t\t\tself.info(context + ':load_plugin:success for mode [' + mode + '] for name [' + plugin.get_name() + ']')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.error(context + ':load_plugin:failure for mode [' + mode + '] for name [' + plugin.get_name() + ']')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t.catch(\r\n\t\t\t\t\t(reason) => {\r\n\t\t\t\t\t\tself.error(context + ':load_plugin:failure for mode [' + mode + '] for name [' + plugin.get_name() + ']:' + reason)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t\r\n\t\t\t\tthis.leave_group('load_plugin:jsonfile or database')\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\tcase 'token': {\r\n\t\t\t\tthis.leave_group('load_plugin:token')\r\n\t\t\t\treturn true // TODO: plugin auth token\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.leave_group('load_plugin:error')\r\n\t\treturn false\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with giving credentials.\r\n\t * \r\n\t * @param {Credentials} arg_credentials - credentials object.\r\n\t * \r\n\t * @returns {Promise} - a promise of boolean.\r\n\t */\r\n\tauthenticate(arg_credentials)\r\n\t{\r\n\t\tthis.enter_group('authenticate')\r\n\t\t\r\n\t\t// console.log(context + ':authenticate:arg_credentials', arg_credentials)\r\n\t\t\r\n\t\tlet all_promises = []\r\n\t\tthis.registered_plugins.forEach(\r\n\t\t\t(plugin) => {\r\n\t\t\t\tconst promise = plugin.authenticate(arg_credentials)\r\n\t\t\t\tall_promises.push(promise)\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tconst promise = Promise.all(all_promises).then(\r\n\t\t\t(promise_results) => {\r\n\t\t\t\tfor(let result of promise_results)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tthis.leave_group('authenticate')\r\n\t\treturn promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Hash a password.\r\n\t * \r\n\t * @param {string} arg_password - password to hash.\r\n\t * @param {string|undefined} arg_digest_method - digest method name (sha1,sha256,sha384,sha512,md5)\r\n\t * @param {string|undefined} arg_encoding_method - encoding method name (hex,utf8,utf16,binary,base64,hexstr)\r\n\t * \r\n\t * @returns {string} - hashed password\r\n\t */\r\n\thash_password(arg_password, arg_digest_method, arg_encoding_method)\r\n\t{\r\n\t\tassert(T.isString(arg_password), context + ':bad password string')\r\n\t\targ_digest_method = T.isString(arg_digest_method) ? arg_digest_method : 'sha1'\r\n\t\targ_encoding_method = T.isString(arg_encoding_method) ? arg_encoding_method : 'hex'\r\n\t\t\r\n\t\t// GET MESSAGE DIGEST FUNCTION\r\n\t\tlet md = null\r\n\t\tswitch(arg_digest_method.toLocaleLowerCase())\r\n\t\t{\r\n\t\t\tcase 'sha1':   md = forge.md.sha1.create(); break\r\n\t\t\tcase 'sha256': md = forge.md.sha256.create(); break\r\n\t\t\tcase 'sha384': md = forge.md.sha384.create(); break\r\n\t\t\tcase 'sha512': md = forge.md.sha512.create(); break\r\n\t\t\tcase 'md5':\tmd = forge.md.md5.create(); break\r\n\t\t\tdefault: this.error_bad_digest_method(arg_digest_method); return null\r\n\t\t}\r\n\t\tassert(md, context + ':bad message digest object')\r\n\t\tmd.update(arg_password)\r\n\t\t\r\n\t\t// GET ENCODED MESSAGE\r\n\t\tlet encoded = null\r\n\t\tswitch(arg_encoding_method.toLocaleLowerCase())\r\n\t\t{\r\n\t\t\tcase 'hex':\r\n\t\t\t\tencoded = md.digest().toHex(); break\r\n\t\t\tcase 'utf8':\r\n\t\t\tcase 'utf-8':\r\n\t\t\t\tencoded = md.digest().toString('utf8'); break\r\n\t\t\tcase 'utf16':\r\n\t\t\tcase 'utf-16':\r\n\t\t\t\tencoded = md.digest().toString('utf16'); break\r\n\t\t\tcase 'binary':\r\n\t\t\t\tencoded = md.digest().toString('binary'); break\r\n\t\t\tcase 'base64':\r\n\t\t\t\tencoded = md.digest().toString('base64'); break\r\n\t\t\tcase 'hexstr':\r\n\t\t\t\tencoded = md.digest().toString('hex'); break\r\n\t\t\tdefault: this.error_bad_encoding_method(arg_encoding_method); return null\r\n\t\t}\r\n\t\tassert(encoded, context + ':bad message encoding result')\r\n\t\t\r\n\t\treturn encoded\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Check request credentials authentication.\r\n\t *\tRequest format:\r\n\t *\t\treq.username=...\r\n\t *\t\treq.authorization={\r\n\t *\t\t\tscheme: <Basic|Signature|...>,\r\n\t *\t\t\tcredentials: <Undecoded value of header>,\r\n\t *\t\t\tbasic: {\r\n\t *\t\t\t\tusername: $user\r\n\t *\t\t\t\tpassword: $password\r\n\t *\t\t\t}\r\n\t *\t\t}\r\n\t *\r\n\t * @param {object} arg_request - request object.\r\n\t * \r\n\t * @returns {boolean}\r\n\t */\r\n\tcheck_request_authentication(arg_request)\r\n\t{\r\n\t\tif ( !this.authentication_is_enabled )\r\n\t\t{\r\n\t\t\treturn true\r\n\t\t}\r\n\t\ttry{\r\n\t\t\tconst credentials = this.get_credentials(arg_request).get_credentials()\r\n\t\t\t\r\n\t\t\tif (arg_request.is_authenticated && credentials.username && credentials.password)\r\n\t\t\t{\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t} catch(e)\r\n\t\t{\r\n\t\t\tthis.error(context + ':check_request_authentication:exception', e)\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get request credentials from headers.\r\n\t *\tRequest format:\r\n\t *\t\treq.username=...\r\n\t *\t\treq.authorization={\r\n\t *\t\t\tscheme: <Basic|Signature|...>,\r\n\t *\t\t\tcredentials: <Undecoded value of header>,\r\n\t *\t\t\tbasic: {\r\n\t *\t\t\t\tusername: $user\r\n\t *\t\t\t\tpassword: $password\r\n\t *\t\t\t}\r\n\t *\t\t}\r\n\t * \r\n\t * @param {object} arg_request - request object.\r\n\t * \r\n\t * @returns {Credentials|undefined} - credentials instance.\r\n\t */\r\n\tget_credentials(arg_request)\r\n\t{\r\n\t\tthis.info('get_credentials')\r\n\t\t\r\n\t\t// DEBUG\r\n\t\t// console.log(arg_request.url, 'arg_request.url')\r\n\t\t// console.log(arg_request.queries, 'arg_request.queries')\r\n\t\t// console.log(arg_request.password, 'arg_request')\r\n\t\t// console.log(arg_request.query(), 'arg_request.query')\r\n\t\t// console.log(arg_request.params, 'arg_request.params')\r\n\t\t\r\n\t\t\r\n\t\t// CHECK REQUEST\r\n\t\t// let credentials = { 'user_name':null, 'password':null, 'token':null, 'expire':null }\r\n\t\tif (!arg_request)\r\n\t\t{\r\n\t\t\treturn undefined\r\n\t\t}\r\n\r\n\r\n\t\t// DEFINE EMPTY CREDENTIALS\r\n\t\tlet credentials = Credentials.get_empty_credentials()\r\n\t\t\r\n\t\tcredentials.tenant = 'tenantA' // TODO\r\n\t\tcredentials.env = 'dev' // TODO\r\n\t\tcredentials.application = 'devtools' // TODO\r\n\r\n\t\tcredentials.token = '' // TODO\r\n\r\n\t\tcredentials.ts_login = Date.now()\r\n\t\tcredentials.ts_expiration = Date.now() + 999999999 // TODO\r\n\t\t\r\n\t\t\r\n\t\t// REQUEST ALREADY HAVE PROCESSED CREDENTIAL\r\n\t\tif ( T.isObject(arg_request.devapt_credentials) && arg_request.devapt_credentials.is_credentials )\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication from cache')\r\n\t\t\treturn arg_request.devapt_credentials\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// EXPRESS REQUEST\r\n\t\tif (arg_request && arg_request.query && arg_request.query.username && arg_request.query.password)\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication with query map')\r\n\t\t\t\r\n\t\t\tcredentials.user_name = arg_request.query.username\r\n\t\t\tcredentials.user_pass_digest = arg_request.query.password\r\n\t\t\targ_request.devapt_credentials = new Credentials(credentials)\r\n\t\t\t\r\n\t\t\treturn arg_request.devapt_credentials\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// RESTIFY WITH QUERY STRING\r\n\t\tlet query_str = null\r\n\t\tif (arg_request && T.isString(arg_request.query) )\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication with query string')\r\n\t\t\tquery_str = arg_request.query\r\n\t\t}\r\n\t\tif (arg_request && T.isFunction(arg_request.query) )\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication with query function')\r\n\t\t\tquery_str = arg_request.query()\r\n\t\t}\r\n\t\tif ( T.isString(query_str) )\r\n\t\t{\r\n\t\t\tconst queries = query_str.split('&')\r\n\t\t\t// console.log(queries, 'queries part')\r\n\t\t\t\r\n\t\t\tqueries.forEach(\r\n\t\t\t\t(item/*, index, arr*/) => {\r\n\t\t\t\t\tconst parts = item.split('=')\r\n\t\t\t\t\tif ( T.isArray(parts) && parts.length == 2 )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst key = parts[0]\r\n\t\t\t\t\t\tconst value = parts[1]\r\n\t\t\t\t\t\tif (key == 'username')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcredentials.user_name = value\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (key == 'password')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcredentials.user_pass_digest = value\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\tif (credentials.user_name && credentials.user_pass_digest)\r\n\t\t\t{\r\n\t\t\t\targ_request.devapt_credentials = new Credentials(credentials)\r\n\t\t\t\treturn arg_request.devapt_credentials\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// RESTIFY QUERY PARSER PLUGIN (NOT WORKING YET)\r\n\t\tif (arg_request && arg_request.params && arg_request.params.username && arg_request.params.password)\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication with params args')\r\n\t\t\t\r\n\t\t\tcredentials.user_name = arg_request.params.username\r\n\t\t\tcredentials.user_pass_digest = arg_request.params.password\r\n\t\t\targ_request.devapt_credentials = new Credentials(credentials)\r\n\t\t\treturn arg_request.devapt_credentials\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// RESTIFY AUTHORIZATION PLUGIN\r\n\t\tif (arg_request && arg_request.authorization)\r\n\t\t{\r\n\t\t\tthis.info('get_credentials:authentication with basic auth header args')\r\n\t\t\t\r\n\t\t\tif (!arg_request.authorization.basic)\r\n\t\t\t{\r\n\t\t\t\treturn credentials\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcredentials.user_name = arg_request.authorization.basic.username\r\n\t\t\tcredentials.user_pass_digest = arg_request.authorization.basic.password\r\n\t\t\targ_request.devapt_credentials = new Credentials(credentials)\r\n\t\t\treturn arg_request.devapt_credentials\r\n\t\t}\r\n\t\t\r\n\t\tthis.error_bad_credentials_format()\r\n\t\t\r\n\t\tconsole.log(arg_request.url, 'arg_request.url')\r\n\t\tconsole.log(arg_request.queries, 'arg_request.queries')\r\n\t\tconsole.log(arg_request.password, 'arg_request')\r\n\t\tconsole.log( T.isFunction(arg_request.query) ? arg_request.query() : arg_request.query, 'arg_request.query')\r\n\t\tconsole.log(arg_request.params, 'arg_request.params')\r\n\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - error during plugin loading.\r\n\t * \r\n\t * @param {string} arg_plugin_mode - plugin mode.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_plugin(arg_plugin_mode)\r\n\t{\r\n\t\tthis.error('bad plugin [' + arg_plugin_mode + ']')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - unknow digest method.\r\n\t * \r\n\t * @param {string} arg_digest_method - digest method name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_digest_method(arg_digest_method)\r\n\t{\r\n\t\tthis.error('bad digest method [' + arg_digest_method + ']')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - unknow encoding method.\r\n\t * \r\n\t * @param {string} arg_encoding_method - encoding method name.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_encoding_method(arg_encoding_method)\r\n\t{\r\n\t\tthis.error('bad encoding method [' + arg_encoding_method + ']')\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - unknow request credentials format.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_credentials_format()\r\n\t{\r\n\t\tthis.error('bad request credentials format')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/authentication_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 524,
    "kind": "variable",
    "name": "forge",
    "memberof": "js/security/authentication_manager.js",
    "static": true,
    "longname": "js/security/authentication_manager.js~forge",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authentication_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 525,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/authentication_manager.js",
    "static": true,
    "longname": "js/security/authentication_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authentication_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 526,
    "kind": "class",
    "name": "AuthenticationManager",
    "memberof": "js/security/authentication_manager.js",
    "static": true,
    "longname": "js/security/authentication_manager.js~AuthenticationManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/authentication_manager.js",
    "importStyle": "AuthenticationManager",
    "description": "Authentication class to manage authentication plugins.",
    "lineNumber": 37,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/plugins_manager.js~PluginsManager"
    ]
  },
  {
    "__docId__": 527,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#constructor",
    "access": null,
    "description": "Create an Authentication manager class: load and create all authentication plugins.\nAuthenticationWrapper use created plugins.",
    "lineNumber": 50,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "PluginsManager"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 528,
    "kind": "member",
    "name": "is_authentication_manager",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#is_authentication_manager",
    "access": null,
    "description": null,
    "lineNumber": 54,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 529,
    "kind": "member",
    "name": "authentication_is_enabled",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authentication_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 56,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 530,
    "kind": "member",
    "name": "authentication_mode",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authentication_mode",
    "access": null,
    "description": null,
    "lineNumber": 57,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 531,
    "kind": "method",
    "name": "load",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#load",
    "access": null,
    "description": "Load security settings.",
    "lineNumber": 69,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "authentication settings (Immutable object)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 532,
    "kind": "member",
    "name": "authentication_is_enabled",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authentication_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 80,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 533,
    "kind": "member",
    "name": "authentication_plugins",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authentication_plugins",
    "access": null,
    "description": null,
    "lineNumber": 81,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 534,
    "kind": "member",
    "name": "authentication_default_plugins",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authentication_default_plugins",
    "access": null,
    "description": null,
    "lineNumber": 82,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 535,
    "kind": "method",
    "name": "load_plugin",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#load_plugin",
    "access": null,
    "description": "Load security plugin from settings.",
    "lineNumber": 114,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "authentication settings (Immutable object)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 536,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#authenticate",
    "access": null,
    "description": "Authenticate a user with giving credentials.",
    "lineNumber": 193,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise} - a promise of boolean."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Credentials"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "credentials object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "a promise of boolean."
    }
  },
  {
    "__docId__": 537,
    "kind": "method",
    "name": "hash_password",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#hash_password",
    "access": null,
    "description": "Hash a password.",
    "lineNumber": 235,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - hashed password"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_password",
        "description": "password to hash."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_digest_method",
        "description": "digest method name (sha1,sha256,sha384,sha512,md5)"
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_encoding_method",
        "description": "encoding method name (hex,utf8,utf16,binary,base64,hexstr)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "hashed password"
    }
  },
  {
    "__docId__": 538,
    "kind": "method",
    "name": "check_request_authentication",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#check_request_authentication",
    "access": null,
    "description": "Check request credentials authentication.\nRequest format:\n\treq.username=...\n\treq.authorization={\n\t\tscheme: <Basic|Signature|...>,\n\t\tcredentials: <Undecoded value of header>,\n\t\tbasic: {\n\t\t\tusername: $user\n\t\t\tpassword: $password\n\t\t}\n\t}",
    "lineNumber": 299,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_request",
        "description": "request object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 539,
    "kind": "method",
    "name": "get_credentials",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#get_credentials",
    "access": null,
    "description": "Get request credentials from headers.\nRequest format:\n\treq.username=...\n\treq.authorization={\n\t\tscheme: <Basic|Signature|...>,\n\t\tcredentials: <Undecoded value of header>,\n\t\tbasic: {\n\t\t\tusername: $user\n\t\t\tpassword: $password\n\t\t}\n\t}",
    "lineNumber": 338,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Credentials|undefined} - credentials instance."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_request",
        "description": "request object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Credentials",
        "undefined"
      ],
      "spread": false,
      "description": "credentials instance."
    }
  },
  {
    "__docId__": 540,
    "kind": "method",
    "name": "error_bad_plugin",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#error_bad_plugin",
    "access": null,
    "description": "Error wrapper - error during plugin loading.",
    "lineNumber": 486,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin_mode",
        "description": "plugin mode."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 541,
    "kind": "method",
    "name": "error_bad_digest_method",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#error_bad_digest_method",
    "access": null,
    "description": "Error wrapper - unknow digest method.",
    "lineNumber": 500,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_digest_method",
        "description": "digest method name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 542,
    "kind": "method",
    "name": "error_bad_encoding_method",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#error_bad_encoding_method",
    "access": null,
    "description": "Error wrapper - unknow encoding method.",
    "lineNumber": 514,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_encoding_method",
        "description": "encoding method name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 543,
    "kind": "method",
    "name": "error_bad_credentials_format",
    "memberof": "js/security/authentication_manager.js~AuthenticationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_manager.js~AuthenticationManager#error_bad_credentials_format",
    "access": null,
    "description": "Error wrapper - unknow request credentials format.",
    "lineNumber": 525,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 544,
    "kind": "file",
    "name": "js/security/authentication_plugin.js",
    "content": "// COMMON IMPORTS\r\nimport Plugin from 'devapt-core-common/dist/js/plugins/plugin'\r\n\r\n\r\nlet context = 'server/security/authentication_plugin'\r\n\r\n\r\n\r\n/**\r\n * Authentication plugin base class.\r\n * @abstract\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationPlugin extends Plugin\r\n{\r\n\t/**\r\n\t * Create an Authentication base class.\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime instance.\r\n\t * @param {AuhtenticationManager} arg_manager - authentication plugins manager.\r\n\t * @param {string} arg_name - plugin name.\r\n\t * @param {string} arg_class - plugin class name.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_manager, arg_name, arg_class, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_manager, arg_name, (arg_class ? arg_class.toString() : 'AuthenticationPlugin'), { version: '1.0.0' }, arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication_plugin = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Enable authentication plugin with contextual informations.\r\n\t * @abstract\r\n\t * \r\n\t * @param {object|undefined} arg_settings - optional contextual settings.\r\n\t * \r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false).\r\n\t */\r\n\tenable(arg_settings)\r\n\t{\r\n\t\tthis.info('enable')\r\n\t\t\r\n\t\tconst resolved_promise = super.enable(arg_settings)\r\n\t\treturn resolved_promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Disable authentication plugin with contextual informations.\r\n\t * @abstract\r\n\t * \r\n\t * @param {object|undefined} arg_settings - optional contextual settings.\r\n\t * \r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false).\r\n\t */\r\n\tdisable(arg_settings)\r\n\t{\r\n\t\tthis.info('disable')\r\n\t\t\r\n\t\tconst resolved_promise = super.disable(arg_settings)\r\n\t\treturn resolved_promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Apply authentication plugin io given server. Use a middleware.\r\n\t * @abstract\r\n\t * @param {object} arg_server - Runtime server (Express/Restify server for example)\r\n\t * @returns {nothing}\r\n\t */\r\n\tapply_on_server(/*arg_server*/)\r\n\t{\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get a authentication middleware to use on servers (see Connect/Express middleware signature).\r\n\t * @abstract\r\n\t * \r\n\t * @param {boolean} arg_should_401 - should send an 401 error on authentication failure.\r\n\t * @param {Function} arg_next_auth_mw - next authentication middleware.\r\n\t * \r\n\t * @returns {Function} - function(request,response,next){...}.\r\n\t */\r\n\tcreate_middleware(/*arg_should_401, arg_next_auth_mw*/)\r\n\t{\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with request credentials.\r\n\t * @abstract\r\n\t * \r\n\t * @param {Credentials|undefined} arg_credentials - request credentials object.\r\n\t * \r\n\t * @returns {object} - a promise of boolean.\r\n\t */\r\n\tauthenticate(/*arg_credentials*/)\r\n\t{\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Login current request (alias of authenticate).\r\n\t * @abstract\r\n\t * \r\n\t * @returns {object} - a promise of boolean.\r\n\t */\r\n\tlogin()\r\n\t{\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Logout current authenticated user.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {object} - a promise of boolean.\r\n\t */\r\n\tlogout()\r\n\t{\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get credentials token of authenticated user.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {string} - credentials token.\r\n\t */\r\n\tget_token()\r\n\t{\r\n\t\treturn null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Create a new credentials token for authenticated user.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {string} - credentials token.\r\n\t */\r\n\trenew_token()\r\n\t{\r\n\t\treturn null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Check a credentials token.\r\n\t * @abstract\r\n\t * \r\n\t * @returns {boolean} - request token is valid.\r\n\t */\r\n\tcheck_token()\r\n\t{\r\n\t\treturn false\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/authentication_plugin.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 545,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/authentication_plugin.js",
    "static": true,
    "longname": "js/security/authentication_plugin.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authentication_plugin.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 546,
    "kind": "class",
    "name": "AuthenticationPlugin",
    "memberof": "js/security/authentication_plugin.js",
    "static": true,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/authentication_plugin.js",
    "importStyle": "AuthenticationPlugin",
    "description": "Authentication plugin base class.",
    "lineNumber": 15,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "abstract": true,
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/plugins/plugin~Plugin"
    ]
  },
  {
    "__docId__": 547,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#constructor",
    "access": null,
    "description": "Create an Authentication base class.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime instance."
      },
      {
        "nullable": null,
        "types": [
          "AuhtenticationManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_manager",
        "description": "authentication plugins manager."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "plugin name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class",
        "description": "plugin class name."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 548,
    "kind": "member",
    "name": "is_authentication_plugin",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#is_authentication_plugin",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 549,
    "kind": "method",
    "name": "enable",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#enable",
    "access": null,
    "description": "Enable authentication plugin with contextual informations.",
    "lineNumber": 45,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)."
    },
    "abstract": true
  },
  {
    "__docId__": 550,
    "kind": "method",
    "name": "disable",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#disable",
    "access": null,
    "description": "Disable authentication plugin with contextual informations.",
    "lineNumber": 63,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)."
    },
    "abstract": true
  },
  {
    "__docId__": 551,
    "kind": "method",
    "name": "apply_on_server",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#apply_on_server",
    "access": null,
    "description": "Apply authentication plugin io given server. Use a middleware.",
    "lineNumber": 79,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_server",
        "description": "Runtime server (Express/Restify server for example)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 552,
    "kind": "method",
    "name": "create_middleware",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#create_middleware",
    "access": null,
    "description": "Get a authentication middleware to use on servers (see Connect/Express middleware signature).",
    "lineNumber": 94,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Function} - function(request,response,next){...}."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_should_401",
        "description": "should send an 401 error on authentication failure."
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_next_auth_mw",
        "description": "next authentication middleware."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Function"
      ],
      "spread": false,
      "description": "function(request,response,next){...}."
    },
    "abstract": true
  },
  {
    "__docId__": 553,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#authenticate",
    "access": null,
    "description": "Authenticate a user with request credentials.",
    "lineNumber": 109,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Credentials",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean."
    },
    "abstract": true
  },
  {
    "__docId__": 554,
    "kind": "method",
    "name": "login",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#login",
    "access": null,
    "description": "Login current request (alias of authenticate).",
    "lineNumber": 122,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean."
    },
    "abstract": true
  },
  {
    "__docId__": 555,
    "kind": "method",
    "name": "logout",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#logout",
    "access": null,
    "description": "Logout current authenticated user.",
    "lineNumber": 135,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean."
    },
    "abstract": true
  },
  {
    "__docId__": 556,
    "kind": "method",
    "name": "get_token",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#get_token",
    "access": null,
    "description": "Get credentials token of authenticated user.",
    "lineNumber": 148,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - credentials token."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "credentials token."
    },
    "abstract": true
  },
  {
    "__docId__": 557,
    "kind": "method",
    "name": "renew_token",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#renew_token",
    "access": null,
    "description": "Create a new credentials token for authenticated user.",
    "lineNumber": 161,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - credentials token."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "credentials token."
    },
    "abstract": true
  },
  {
    "__docId__": 558,
    "kind": "method",
    "name": "check_token",
    "memberof": "js/security/authentication_plugin.js~AuthenticationPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin.js~AuthenticationPlugin#check_token",
    "access": null,
    "description": "Check a credentials token.",
    "lineNumber": 174,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - request token is valid."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "request token is valid."
    },
    "abstract": true
  },
  {
    "__docId__": 559,
    "kind": "file",
    "name": "js/security/authentication_plugin_lowdb.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport lowdb from 'lowdb'\r\nimport path from 'path'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\nimport AuthenticationPlugin from './authentication_plugin'\r\n\r\n\r\nlet context = 'server/security/authentication_lowdb_plugin'\r\n\r\n\r\n\r\n/**\r\n * Authentication class with a LowDb user/login database.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationLowDbPlugin extends AuthenticationPlugin\r\n{\r\n\t/**\r\n\t * Create an Authentication plugin class based on query parameters.\r\n\t * \r\n\t * @param {AuhtenticationManager} arg_manager - authentication plugins manager.\r\n\t * @param {string} arg_name - plugin name.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_manager, arg_name, arg_log_context)\r\n\t{\r\n\t\tsuper(runtime, arg_manager, arg_name, 'AuthenticationLowDbPlugin', arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication_lowdb_plugin = true\r\n\t\t\r\n\t\t// this.is_trace_enabled = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Enable authentication plugin with contextual informations.\r\n\t * \r\n\t * @param {object|undefined} arg_settings - optional contextual settings.\r\n\t * \r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n\t */\r\n\tenable(arg_settings)\r\n\t{\r\n\t\tthis.enter_group('enable')\r\n\t\t\r\n\t\tconst self = this\r\n\t\t\r\n\t\t// console.log(arg_settings, 'arg_settings')\r\n\t\t\r\n\t\t// GET SETTINGS PLAIN OBJECT\r\n\t\targ_settings = T.isFunction(arg_settings.toJS) ? arg_settings.toJS() : arg_settings\r\n\t\t\r\n\t\t// CALL BASE CLASS METHOD\r\n\t\tlet resolved_promise = super.enable(arg_settings)\r\n\t\t\r\n\t\t// SET FIELD NAMES FOR USER NAME\r\n\t\tif (arg_settings && T.isString(arg_settings.username_fieldname) )\r\n\t\t{\r\n\t\t\tthis.username_fieldname = arg_settings.username_fieldname\r\n\t\t}\r\n\t\t\r\n\t\t// SET FIELD NAMES FOR PASSWORD\r\n\t\tif (arg_settings && T.isString(arg_settings.password_fieldname) )\r\n\t\t{\r\n\t\t\tthis.password_fieldname = arg_settings.password_fieldname\r\n\t\t}\r\n\t\t\r\n\t\t// SET FIELD NAMES FOR ID\r\n\t\tif (arg_settings && T.isString(arg_settings.id_fieldname) )\r\n\t\t{\r\n\t\t\tthis.id_fieldname = arg_settings.id_fieldname\r\n\t\t}\r\n\t\t\r\n\t\t// SET REDIRECTION ROUTE ON SUCCESS\r\n\t\tif (arg_settings && T.isString(arg_settings.success_redirect) )\r\n\t\t{\r\n\t\t\tthis.success_redirect = arg_settings.success_redirect\r\n\t\t}\r\n\t\t\r\n\t\t// SET REDIRECTION ROUTE ON FAILURE\r\n\t\tif (arg_settings && T.isString(arg_settings.failure_redirect) )\r\n\t\t{\r\n\t\t\tthis.failure_redirect = arg_settings.failure_redirect\r\n\t\t}\r\n\t\t\r\n\t\t// SET USE OF SESSION FLAG\r\n\t\tif (arg_settings && T.isBoolean(arg_settings.use_session) )\r\n\t\t{\r\n\t\t\tthis.use_session = arg_settings.use_session\r\n\t\t}\r\n\t\t\r\n\t\t// SET FILE NAME\r\n\t\tthis.file_name = null\r\n\t\tif (arg_settings && T.isString(arg_settings.file_name) )\r\n\t\t{\r\n\t\t\tthis.file_name = arg_settings.file_name\r\n\t\t}\r\n\t\t\r\n\t\t// LOAD FILE DB\r\n\t\tthis.file_db = null\r\n\t\tif (this.file_name)\r\n\t\t{\r\n\t\t\tresolved_promise = resolved_promise.then(\r\n\t\t\t\tfunction()\r\n\t\t\t\t{\r\n\t\t\t\t\tconst base_dir = runtime.get_setting('base_dir', null)\r\n\t\t\t\t\tassert( T.isString(base_dir), context + ':enable:bad base dir string')\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst json_full_path = path.join(base_dir, 'resources', self.file_name)\r\n\t\t\t\t\t// console.log(json_full_path, 'json_full_path')\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst storage = require('lowdb/lib/file-sync')\r\n\t\t\t\t\tself.file_db = lowdb(json_full_path, {storage})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// console.log(self.file_db.object, 'self.file_db.object')\r\n\t\t\t\t\t// console.log( require(json_full_path), 'self.file_db JSON file')\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.leave_group('enable (async:resolved)')\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\tresolved_promise.catch(\r\n\t\t\t\t(reason) => {\r\n\t\t\t\t\tself.leave_group('enable (async:error)')\r\n\t\t\t\t\tself.error('failed to load db file:' + reason)\r\n\t\t\t\t\tconsole.error('failed to load db file:' + reason)\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t\t\r\n\t\tthis.leave_group('enable (async:waiting)')\r\n\t\treturn resolved_promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Disable authentication plugin with contextual informations.\r\n\t * \r\n\t * @param {object|undefined} arg_settings - optional contextual settings.\r\n\t * \r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n\t */\r\n\tdisable(arg_settings)\r\n\t{\r\n\t\tconst resolved_promise = super.disable(arg_settings)\r\n\t\treturn resolved_promise\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get a authentication middleware to use on servers (see Connect/Express middleware signature).\r\n\t * \r\n\t * @param {boolean} arg_should_401 - should send an 401 error on authentication failure.\r\n\t * @param {Function} arg_next_auth_mw - next authentication middleware.\r\n\t * \r\n\t * @returns {Function} - function(request,response,next){...}\r\n\t */\r\n\tcreate_middleware(arg_should_401, arg_next_auth_mw)\r\n\t{\r\n\t\tconst self = this\r\n\t\tself.debug('create_middleware')\r\n\t\t// console.log('auth_lowdb_plugin.create_middleware')\r\n\t\t\r\n\t\tconst auth_mgr = runtime.security().get_authentication_manager()\r\n\t\t\r\n\t\treturn (req, res, next) => {\r\n\t\t\ttry{\r\n\t\t\t\tconst credentials = auth_mgr.get_credentials(req)\r\n\t\t\t} catch(e)\r\n\t\t\t{\r\n\t\t\t\tconsole.error(context + ':create_middleware:middleware:exception', e)\r\n\t\t\t\tself.error(context + ':create_middleware:middleware:exception', e)\r\n\t\t\t\tnext('Authentication failure(exception)')\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// console.log('auth_lowdb_plugin.create_middleware', credentials)\r\n\t\t\t\t\r\n\t\t\tif ( auth_mgr.check_request_authentication(req) )\r\n\t\t\t{\r\n\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.request is already authenticated')\r\n\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.request is already authenticated')\r\n\t\t\t\tnext()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware:not authenticated with credentials'/*, credentials*/)\r\n\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware:not authenticated with credentials'/*, credentials*/)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tthis.authenticate(credentials)\r\n\t\t\t.then(\r\n\t\t\t\t(result) => {\r\n\t\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.authenticate then')\r\n\t\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.authenticate then')\r\n\t\t\t\t\t\r\n\t\t\t\t\t// SUCCESS\r\n\t\t\t\t\tif (result)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.authenticate then:next')\r\n\t\t\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.authenticate then:next')\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treq.is_authenticated = true\r\n\t\t\t\t\t\tnext()\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// FAILURE WITH ERROR\r\n\t\t\t\t\tif (arg_should_401)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// SEND OUTPUT\r\n\t\t\t\t\t\tres.status(401)\r\n\t\t\t\t\t\tres.contentType = 'json'\r\n\t\t\t\t\t\tres.send({ message: 'Authentication failure' })\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.authenticate then:auth failure')\r\n\t\t\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.authenticate then:auth failure')\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tnext('Authentication failure')\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// FAILURE WITHOUT ERROR\r\n\t\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.authenticate failure without error:next')\r\n\t\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.authenticate failure without error:next')\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (arg_next_auth_mw)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\targ_next_auth_mw(req, res, next)\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnext()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t.catch(\r\n\t\t\t\t(reason) => {\r\n\t\t\t\t\t// console.log(context + ':auth_lowdb_plugin.create_middleware.authenticate exception', reason)\r\n\t\t\t\t\tself.debug('auth_lowdb_plugin.create_middleware.authenticate exception', reason)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// SEND OUTPUT\r\n\t\t\t\t\tres.status(401)\r\n\t\t\t\t\tres.contentType = 'json'\r\n\t\t\t\t\tres.send({ message: reason })\r\n\t\t\t\t\t\r\n\t\t\t\t\tnext(reason)\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with a file giving request credentials.\r\n\t * \r\n\t * @param {Credentials|undefined} arg_credentials - request credentials object.\r\n\t * \r\n\t * @returns {object} - a promise of boolean.\r\n\t */\r\n\tauthenticate(arg_credentials)\r\n\t{\r\n\t\tthis.debug('authenticate')\r\n\t\t// console.log(arg_credentials, context + ':authenticate:arg_credentials')\r\n\t\t\r\n\t\tif (! this.file_db)\r\n\t\t{\r\n\t\t\tthis.debug('authenticate:failure:bad db')\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t}\r\n\t\t// assert( T.isFunction(this.file_db), context + ':authenticate:bad db object')\r\n\t\tassert( T.isObject(arg_credentials) && arg_credentials.is_credentials, context + ':authenticate:bad credentials object')\r\n\t\targ_credentials = arg_credentials.get_credentials()\r\n\r\n\t\t// HAS AUTHENTICATION INFORMATIONS\r\n\t\tif ( !(T.isString(arg_credentials.user_name) && T.isString(arg_credentials.user_pass_digest)) )\r\n\t\t{\r\n\t\t\tthis.debug('authenticate:failure:no credentials', arg_credentials)\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t}\r\n\t\t// assert( T.isString(arg_credentials.user_name), context + ':authenticate:bad credentials.user_name string')\r\n\t\t// assert( T.isString(arg_credentials.user_pass_digest), context + ':authenticate:bad credentials.user_pass_digest string')\r\n\t\t\r\n\t\t// CREATE QUERY\r\n\t\tconst username_field = this.username_fieldname ? this.username_fieldname : 'username'\r\n\t\tconst password_field = this.id_password_fieldnamefieldname ? this.password_fieldname : 'password'\r\n\t\tlet query = {}\r\n\t\tquery[username_field] = arg_credentials.user_name\r\n\t\tquery[password_field] = arg_credentials.user_pass_digest\r\n\t\t\r\n\t\t// EXECUTE QUERY\r\n\t\ttry{\r\n\t\t\t// console.log(context + '.authenticate:db', this.file_db)\r\n\t\t\t// console.log(context + '.authenticate:db', this.file_db.object)\r\n\t\t\t// console.log(context + '.authenticate:query', query)\r\n\t\t\t\r\n\t\t\tconst users = this.file_db('users').find(query)\r\n\t\t\tif (users)\r\n\t\t\t{\r\n\t\t\t\tconst first_user = (T.isArray(users) && users.length > 0) ? users[0] : (T.isObject(users) ? users : null)\r\n\t\t\t\tif ( T.isFunction(arg_credentials.done_cb) )\r\n\t\t\t\t{\r\n\t\t\t\t\targ_credentials.done_cb(first_user)\r\n\t\t\t\t}\r\n\t\t\t\t// console.log('authenticate user found')\r\n\t\t\t\t\r\n\t\t\t\tthis.debug('authenticate:success')\r\n\t\t\t\treturn Promise.resolve(true)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t\tconsole.error('authenticate user error', e)\r\n\t\t}\r\n\t\t\r\n\t\t// console.log('authenticate user NOT found')\r\n\t\t\r\n\t\tthis.debug('authenticate:failure for', arg_credentials)\r\n\t\treturn Promise.resolve(false)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get user id from a user record.\r\n\t * \r\n\t * @param {object} arg_user_record - user record object.\r\n\t * \r\n\t * @returns {string} - user id.\r\n\t */\r\n\tget_user_id(arg_user_record)\r\n\t{\r\n\t\tconst id_field = this.id_fieldname ? this.id_fieldname : 'id'\r\n\t\treturn ( T.isObject(arg_user_record) && (id_field in arg_user_record) ) ? arg_user_record[id_field] : null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get user record by its id.\r\n\t * \r\n\t * @param {string} arg_user_id - user id.\r\n\t * \r\n\t * @returns {string} - user id.\r\n\t */\r\n\tget_user_by_id(arg_user_id)\r\n\t{\r\n\t\tassert( T.isFunction(this.file_db), context + ':get_user_by_id:bad db object')\r\n\t\t\r\n\t\t// CREATE QUERY\r\n\t\tconst id_field = this.id_fieldname ? this.id_fieldname : 'id'\r\n\t\tlet query = {}\r\n\t\tquery[id_field] = arg_user_id\r\n\t\t\r\n\t\t// EXECUTE QUERY\r\n\t\ttry{\r\n\t\t\tlet users = this.file_db('users').find(query)\r\n\t\t\tif (users)\r\n\t\t\t{\r\n\t\t\t\treturn (T.isArray(users) && users.length > 0) ? users[0] : (T.isObject(users) ? users : null)\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(e)\r\n\t\t{\r\n\t\t}\r\n\t\t\r\n\t\treturn null\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/authentication_plugin_lowdb.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 560,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/authentication_plugin_lowdb.js",
    "static": true,
    "longname": "js/security/authentication_plugin_lowdb.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authentication_plugin_lowdb.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 561,
    "kind": "class",
    "name": "AuthenticationLowDbPlugin",
    "memberof": "js/security/authentication_plugin_lowdb.js",
    "static": true,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/authentication_plugin_lowdb.js",
    "importStyle": "AuthenticationLowDbPlugin",
    "description": "Authentication class with a LowDb user/login database.",
    "lineNumber": 23,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/security/authentication_plugin.js~AuthenticationPlugin"
    ]
  },
  {
    "__docId__": 562,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#constructor",
    "access": null,
    "description": "Create an Authentication plugin class based on query parameters.",
    "lineNumber": 34,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "AuhtenticationManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_manager",
        "description": "authentication plugins manager."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "plugin name."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 563,
    "kind": "member",
    "name": "is_authentication_lowdb_plugin",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#is_authentication_lowdb_plugin",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 564,
    "kind": "method",
    "name": "enable",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#enable",
    "access": null,
    "description": "Enable authentication plugin with contextual informations.",
    "lineNumber": 52,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 565,
    "kind": "member",
    "name": "username_fieldname",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#username_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 69,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 566,
    "kind": "member",
    "name": "password_fieldname",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#password_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 75,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 567,
    "kind": "member",
    "name": "id_fieldname",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#id_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 81,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 568,
    "kind": "member",
    "name": "success_redirect",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#success_redirect",
    "access": null,
    "description": null,
    "lineNumber": 87,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 569,
    "kind": "member",
    "name": "failure_redirect",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#failure_redirect",
    "access": null,
    "description": null,
    "lineNumber": 93,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 570,
    "kind": "member",
    "name": "use_session",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#use_session",
    "access": null,
    "description": null,
    "lineNumber": 99,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 571,
    "kind": "member",
    "name": "file_name",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#file_name",
    "access": null,
    "description": null,
    "lineNumber": 103,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 572,
    "kind": "member",
    "name": "file_name",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#file_name",
    "access": null,
    "description": null,
    "lineNumber": 106,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 573,
    "kind": "member",
    "name": "file_db",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#file_db",
    "access": null,
    "description": null,
    "lineNumber": 110,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 574,
    "kind": "method",
    "name": "disable",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#disable",
    "access": null,
    "description": "Disable authentication plugin with contextual informations.",
    "lineNumber": 153,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 575,
    "kind": "method",
    "name": "create_middleware",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#create_middleware",
    "access": null,
    "description": "Get a authentication middleware to use on servers (see Connect/Express middleware signature).",
    "lineNumber": 169,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Function} - function(request,response,next){...}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_should_401",
        "description": "should send an 401 error on authentication failure."
      },
      {
        "nullable": null,
        "types": [
          "Function"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_next_auth_mw",
        "description": "next authentication middleware."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Function"
      ],
      "spread": false,
      "description": "function(request,response,next){...}"
    }
  },
  {
    "__docId__": 576,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#authenticate",
    "access": null,
    "description": "Authenticate a user with a file giving request credentials.",
    "lineNumber": 274,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Credentials",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean."
    }
  },
  {
    "__docId__": 577,
    "kind": "method",
    "name": "get_user_id",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#get_user_id",
    "access": null,
    "description": "Get user id from a user record.",
    "lineNumber": 344,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - user id."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_user_record",
        "description": "user record object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "user id."
    }
  },
  {
    "__docId__": 578,
    "kind": "method",
    "name": "get_user_by_id",
    "memberof": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_plugin_lowdb.js~AuthenticationLowDbPlugin#get_user_by_id",
    "access": null,
    "description": "Get user record by its id.",
    "lineNumber": 359,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - user id."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_user_id",
        "description": "user id."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "user id."
    }
  },
  {
    "__docId__": 579,
    "kind": "file",
    "name": "js/security/authentication_wrapper.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T            from 'devapt-core-common/dist/js/utils/types'\r\nimport Settingsable from 'devapt-core-common/dist/js/base/settingsable'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\n\r\n\r\nlet context = 'server/security/authentication_wrapper'\r\n\r\n\r\n\r\n/**\r\n * @file Authentication wrapper class to interact with authentication plugins.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationWrapper extends Settingsable\r\n{\r\n\t/**\r\n\t * Create an Authentication wrapper class to interact with authentication plugins.\r\n\t * @extends Settingsable\r\n\t * \r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_log_context=context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(undefined, arg_log_context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_authentication_wrapper = true\r\n\t\tthis.authentication_is_enabled = true\r\n\t\tthis.authentication_plugins = []\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security settings.\r\n\t * \r\n\t * @param {object} arg_settings - authentication settings (Immutable object).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload(arg_settings)\r\n\t{\r\n\t\t// console.log(arg_settings, context + ':load:arg_settings')\r\n\t\t\r\n\t\tconst self = this\r\n\t\tassert(T.isObject(arg_settings), context + ':bad settings object')\r\n\t\tassert(T.isFunction(arg_settings.has), context + ':bad settings immutable')\r\n\t\tassert(arg_settings.has('enabled'), context + ':bad settings.enabled')\r\n\t\tassert(arg_settings.has('plugins'), context + ':bad settings.plugins')\r\n\t\t\r\n\t\tconst auth_mgr = runtime.security().get_authentication_manager()\r\n\t\t\r\n\t\t\r\n\t\t// LOAD AUTHENTICATION SETTINGS\r\n\t\tthis.authentication_is_enabled = arg_settings.get('enabled')\r\n\t\tthis.authentication_plugins = []\r\n\t\tconst plugins = arg_settings.get('plugins')\r\n\t\t\r\n\t\t// SEARCH PLUGINS\r\n\t\tplugins.forEach(\r\n\t\t\t(plugin_name) => {\r\n\t\t\t\tconst plugin = auth_mgr.registered_plugins.find_by_name(plugin_name)\r\n\t\t\t\tif ( T.isObject(plugin) && plugin.is_authentication_plugin )\r\n\t\t\t\t{\r\n\t\t\t\t\tself.authentication_plugins.push(plugin)\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tself.info('plugin not found for name [' + plugin_name + ']')\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Apply all plugins authentication middleware on a Server instance.\r\n\t * \r\n\t * @param {Server} arg_server - server instance.\r\n\t * \r\n\t * @returns {boolean}\r\n\t */\r\n\tapply_middlewares(arg_server)\r\n\t{\r\n\t\tthis.enter_group('apply_middlewares')\r\n\t\t// assert( T.isObject(arg_server) && T.isObject(arg_server.server), context + ':apply_middlewares:bad arg_server.server object')\r\n\t\t// assert( T.isFunction(arg_server.server.use), context + ':apply_middlewares:bad arg_server.server.user function')\r\n\t\t\r\n\t\t// CHECK SERVER\r\n\t\tif (! arg_server || ! arg_server.server || ! T.isFunction(arg_server.server.use) )\r\n\t\t{\r\n\t\t\tthis.leave_group('apply_middlewares:bad server')\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tconst plugins = this.authentication_plugins\r\n\t\tconst auth_mgr = runtime.security().get_authentication_manager()\r\n\t\t\r\n\t\t// LAST MIDDLEWARE\r\n\t\tconst last_mw = (req, res, next) => {\r\n\t\t\t// AUTHENTICATION IS VALID\r\n\t\t\tif ( ! this.authentication_is_enabled || auth_mgr.check_request_authentication(req) )\r\n\t\t\t{\r\n\t\t\t\t// console.log('apply_middlewares:last_mw:auth success')\r\n\t\t\t\tnext()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// SEND ERROR OUTPUT\r\n\t\t\tres.status(401)\r\n\t\t\tres.contentType = 'json'\r\n\t\t\tres.send({ message: 'Authentication failure' })\r\n\t\t\t\r\n\t\t\t// console.log('apply_middlewares:last_mw:auth failure', req.originalUrl)\r\n\t\t\tnext('Authentication failure')\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// LOOP ON PLUGINS\r\n\t\tconst should_send_error_on_failure = false\r\n\t\tfor(let plugin of plugins)\r\n\t\t{\r\n\t\t\tif ( T.isFunction(plugin.create_middleware) )\r\n\t\t\t{\r\n\t\t\t\t// self.debug('apply_middlewares:get_mw:call plugin.create_middleware()')\r\n\t\t\t\t// console.log('apply_middlewares:loop on plugin:' + plugin.get_name())\r\n\t\t\t\t\r\n\t\t\t\tconst mw = plugin.create_middleware(should_send_error_on_failure)\r\n\t\t\t\targ_server.server.use(mw)\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// ADD LAST MIDDLEWARE\r\n\t\targ_server.server.use(last_mw)\r\n\t\t\r\n\t\tthis.leave_group('apply_middlewares')\r\n\t\treturn true\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/authentication_wrapper.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 580,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/authentication_wrapper.js",
    "static": true,
    "longname": "js/security/authentication_wrapper.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authentication_wrapper.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 581,
    "kind": "class",
    "name": "AuthenticationWrapper",
    "memberof": "js/security/authentication_wrapper.js",
    "static": true,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/authentication_wrapper.js",
    "importStyle": "AuthenticationWrapper",
    "description": "",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Authentication wrapper class to interact with authentication plugins."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/settingsable~Settingsable"
    ]
  },
  {
    "__docId__": 582,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#constructor",
    "access": null,
    "description": "Create an Authentication wrapper class to interact with authentication plugins.",
    "lineNumber": 32,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Settingsable"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 583,
    "kind": "member",
    "name": "is_authentication_wrapper",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#is_authentication_wrapper",
    "access": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 584,
    "kind": "member",
    "name": "authentication_is_enabled",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#authentication_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 585,
    "kind": "member",
    "name": "authentication_plugins",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#authentication_plugins",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 586,
    "kind": "method",
    "name": "load",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#load",
    "access": null,
    "description": "Load security settings.",
    "lineNumber": 50,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "authentication settings (Immutable object)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 587,
    "kind": "member",
    "name": "authentication_is_enabled",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#authentication_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 64,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 588,
    "kind": "member",
    "name": "authentication_plugins",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#authentication_plugins",
    "access": null,
    "description": null,
    "lineNumber": 65,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 589,
    "kind": "method",
    "name": "apply_middlewares",
    "memberof": "js/security/authentication_wrapper.js~AuthenticationWrapper",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authentication_wrapper.js~AuthenticationWrapper#apply_middlewares",
    "access": null,
    "description": "Apply all plugins authentication middleware on a Server instance.",
    "lineNumber": 91,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Server"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_server",
        "description": "server instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 590,
    "kind": "file",
    "name": "js/security/authorization_manager.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport PluginsManager from '../plugins/plugins_manager'\r\n\r\n\r\nlet context = 'server/security/authorization_manager'\r\n\r\n\r\n\r\n/**\r\n * Authorization class to manage authorization plugins.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthorizationManager extends PluginsManager\r\n{\r\n\t/**\r\n\t * Create an Authorization manager class.\r\n\t * \r\n\t * @param {RuntimeBase} arg_runtime - runtime.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @param {LoggerManager} arg_logger_manager - logger manager object (optional).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_runtime, arg_log_context, arg_logger_manager)\r\n\t{\r\n\t\tsuper(arg_runtime, arg_log_context ? arg_log_context : context, arg_logger_manager)\r\n\t\t\r\n\t\tthis.is_authorization_manager = true\r\n\t\t\r\n\t\tthis.authorization_is_enabled = true\r\n\t\tthis.authorization_mode = null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security settings\r\n\t * @param {object} arg_settings - authorization settings (Immutable object)\r\n\t * @returns {nothing}\r\n\t */\r\n\tload(arg_settings)\r\n\t{\r\n\t\tassert(T.isObject(arg_settings), context + ':bad settings object')\r\n\t\tassert(T.isFunction(arg_settings.has), context + ':bad settings immutable')\r\n\t\tassert(arg_settings.has('enabled'), context + ':bad settings.enabled')\r\n\t\t// assert(arg_settings.has('mode'), context + ':bad settings.mode')\r\n\t\t\r\n\t\t// LOAD AUTHORIZATION SETTINGS\r\n\t\tthis.authorization_is_enabled = arg_settings.get('enabled')\r\n\t\t// this.authorization_mode = arg_settings.get('mode')\r\n\t\t\r\n\t\t// LOAD PLUGIN\r\n\t\t// const result = this.load_plugin(arg_settings)\r\n\t\t// if (! result)\r\n\t\t// {\r\n\t\t//\t this.error_bad_plugin(this.authorization_mode)\r\n\t\t// }\r\n\t\t\r\n\t\t// TODO: default security plugin ?\r\n\t\t// TODO: alt plugin settings ?\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load security plugin from settings.\r\n\t * \r\n\t * @param {object} arg_settings - authorization settings (Immutable object).\r\n\t * \r\n\t * @returns {boolean}\r\n\t */\r\n\tload_plugin(arg_settings)\r\n\t{\r\n\t\tassert(T.isObject(arg_settings), context + ':bad settings object')\r\n\t\tassert(T.isFunction(arg_settings.has), context + ':bad settings immutable')\r\n\t\tassert(arg_settings.has('mode'), context + ':bad settings.mode')\r\n\t\t\r\n\t\t// LOAD PLUGIN\r\n\t\tconst mode = arg_settings.get('mode').toLocaleLowerCase()\r\n\t\tswitch(mode)\r\n\t\t{\r\n\t\t\tcase 'database':\r\n\t\t\t{\r\n\t\t\t\t// const plugin = new AuthorizationPluginPassportLocalDb(context)\r\n\t\t\t\t// this.register_plugin(plugin)\r\n\t\t\t\t// plugin.enable(arg_settings)\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\tcase 'jsonfile':\r\n\t\t\t{\r\n\t\t\t\t// const plugin = new AuthorizationPluginPassportLocalFile(context)\r\n\t\t\t\t// this.register_plugin(plugin)\r\n\t\t\t\t// plugin.enable(arg_settings)\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn false\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Chech permission authorization of a user.\r\n\t * \r\n\t * @param {object} arg_permission - permission plain object.\r\n\t * @param {Credentials} arg_credentials - user credentials plain object.\r\n\t * \r\n\t * @returns {object} - a promise of boolean\r\n\t */\r\n\tauthorize(/*arg_permission, arg_credentials*/)\r\n\t{\r\n\t\tthis.enter_group('authenticate')\r\n\t\t\r\n\t\t// let all_promises = []\r\n\t\t// this.registered_plugins.find(\r\n\t\t// \t(plugin) => {\r\n\t\t// \t\tconst promise = plugin.authorize(arg_permission, arg_credentials)\r\n\t\t// \t\tall_promises.push(promise)\r\n\t\t// \t}\r\n\t\t// )\r\n\t\t\r\n\t\t// const promise = promise.all(all_promises).then(\r\n\t\t// \t(promise_results) => {\r\n\t\t// \t\tfor(let result of promise_results)\r\n\t\t// \t\t{\r\n\t\t// \t\t\tif (result)\r\n\t\t// \t\t\t{\r\n\t\t// \t\t\t\treturn true\r\n\t\t// \t\t\t}\r\n\t\t// \t\t}\r\n\t\t// \t\treturn false\r\n\t\t// \t}\r\n\t\t// )\r\n\t\t\r\n\t\tthis.leave_group('authenticate')\r\n\t\t// return promise\r\n\t\t\r\n\t\treturn Promise.resolve(true)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Error wrapper - error during plugin loading.\r\n\t * @param {string} arg_plugin_mode - plugin mode\r\n\t * @returns {nothing}\r\n\t */\r\n\terror_bad_plugin(arg_plugin_mode)\r\n\t{\r\n\t\tthis.error('bad plugin [' + arg_plugin_mode + ']')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/authorization_manager.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 591,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/authorization_manager.js",
    "static": true,
    "longname": "js/security/authorization_manager.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/authorization_manager.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 592,
    "kind": "class",
    "name": "AuthorizationManager",
    "memberof": "js/security/authorization_manager.js",
    "static": true,
    "longname": "js/security/authorization_manager.js~AuthorizationManager",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/authorization_manager.js",
    "importStyle": "AuthorizationManager",
    "description": "Authorization class to manage authorization plugins.",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/plugins/plugins_manager.js~PluginsManager"
    ]
  },
  {
    "__docId__": 593,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#constructor",
    "access": null,
    "description": "Create an Authorization manager class.",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "RuntimeBase"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime",
        "description": "runtime."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      },
      {
        "nullable": null,
        "types": [
          "LoggerManager"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_logger_manager",
        "description": "logger manager object (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 594,
    "kind": "member",
    "name": "is_authorization_manager",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#is_authorization_manager",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 595,
    "kind": "member",
    "name": "authorization_is_enabled",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#authorization_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 596,
    "kind": "member",
    "name": "authorization_mode",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#authorization_mode",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 597,
    "kind": "method",
    "name": "load",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#load",
    "access": null,
    "description": "Load security settings",
    "lineNumber": 48,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "authorization settings (Immutable object)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 598,
    "kind": "member",
    "name": "authorization_is_enabled",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#authorization_is_enabled",
    "access": null,
    "description": null,
    "lineNumber": 56,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 599,
    "kind": "method",
    "name": "load_plugin",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#load_plugin",
    "access": null,
    "description": "Load security plugin from settings.",
    "lineNumber": 79,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "authorization settings (Immutable object)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 600,
    "kind": "method",
    "name": "authorize",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#authorize",
    "access": null,
    "description": "Chech permission authorization of a user.",
    "lineNumber": 118,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_permission",
        "description": "permission plain object."
      },
      {
        "nullable": null,
        "types": [
          "Credentials"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "user credentials plain object."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean"
    }
  },
  {
    "__docId__": 601,
    "kind": "method",
    "name": "error_bad_plugin",
    "memberof": "js/security/authorization_manager.js~AuthorizationManager",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/authorization_manager.js~AuthorizationManager#error_bad_plugin",
    "access": null,
    "description": "Error wrapper - error during plugin loading.",
    "lineNumber": 156,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_plugin_mode",
        "description": "plugin mode"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 602,
    "kind": "file",
    "name": "js/security/todo/authentication_plugin_passport.js",
    "content": "\r\n// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport passport from 'passport'\r\n\r\n// COMMON IMPORTS\r\nimport T           from 'devapt-core-common/dist/js/utils/types'\r\nimport Credentials from 'devapt-core-common/dist/js/base/credentials'\r\n\r\nimport AuthenticationPlugin from './authentication_plugin'\r\n\r\n\r\n\r\nlet context = 'common/security/authentication_plugin_passport'\r\n\r\n\r\n\r\n/**\r\n * Authentication base class for Passport strategies.\r\n * @abstract\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationPluginPassport extends AuthenticationPlugin\r\n{\r\n    /**\r\n     * Create an Authentication class for all Passport strategies.\r\n\t * @param {string} arg_name - plugin name.\r\n\t * @param {string} arg_class - plugin class name.\r\n     * @param {string|undefined} arg_log_context - optional.\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_name, arg_class, arg_log_context)\r\n\t{\r\n\t\tsuper(arg_name, 'AuthenticationPluginPassport', arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication = true\r\n\t\t\r\n\t\tthis.passport = passport\r\n\t\tthis.strategies = {}\r\n\t\tthis.strategies_names = []\r\n\t}\r\n\t\r\n    \r\n\t/**\r\n     * Enable authentication plugin with contextual informations.\r\n     * @param {object|undefined} arg_settings - optional contextual settings.\r\n     * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n     */\r\n\tenable(arg_settings)\r\n\t{\r\n        const resolved_promise = super.enable(arg_settings)\r\n        \r\n        // SET FIELD NAMES FOR USER NAME\r\n        if (arg_settings && T.isString(arg_settings.username_fieldname) )\r\n        {\r\n            this.username_fieldname = arg_settings.username_fieldname\r\n        }\r\n        \r\n        // SET FIELD NAMES FOR PASSWORD\r\n        if (arg_settings && T.isString(arg_settings.password_fieldname) )\r\n        {\r\n            this.password_fieldname = arg_settings.password_fieldname\r\n        }\r\n        \r\n        // SET FIELD NAMES FOR ID\r\n        if (arg_settings && T.isString(arg_settings.id_fieldname) )\r\n        {\r\n            this.id_fieldname = arg_settings.id_fieldname\r\n        }\r\n        \r\n        // SET REDIRECTION ROUTE ON SUCCESS\r\n        if (arg_settings && T.isString(arg_settings.success_redirect) )\r\n        {\r\n            this.success_redirect = arg_settings.success_redirect\r\n        }\r\n        \r\n        // SET REDIRECTION ROUTE ON FAILURE\r\n        if (arg_settings && T.isString(arg_settings.failure_redirect) )\r\n        {\r\n            this.failure_redirect = arg_settings.failure_redirect\r\n        }\r\n        \r\n        // SET USE OF SESSION FLAG\r\n        if (arg_settings && T.isBoolean(arg_settings.use_session) )\r\n        {\r\n            this.use_session = arg_settings.use_session\r\n        }\r\n        \r\n        return resolved_promise\r\n\t}\r\n    \r\n    \r\n\t/**\r\n     * Disable authentication plugin with contextual informations.\r\n     * @param {object|undefined} arg_settings - optional contextual settings.\r\n     * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n     */\r\n\tdisable(arg_settings)\r\n\t{\r\n        const resolved_promise = super.disable(arg_settings)\r\n        return resolved_promise\r\n\t}\r\n    \r\n    \r\n    /**\r\n     * Apply authentication plugin io given server. Use a middleware.\r\n     * @param {object} arg_server - Runtime server (Express/Restify server for example)\r\n     * @returns {nothing}\r\n     */\r\n    apply_on_server(arg_server)\r\n    {\r\n        this.info('apply authentication on ' + arg_server.get_name())\r\n        \r\n        assert(T.isObject(arg_server), context + ':apply_on_server:bad server object')\r\n        assert(arg_server.is_server, context + ':apply_on_server:bad server instance')\r\n        \r\n        // SERVER INIT MW: f(req,res,next)\r\n        const mw_init = this.passport.initialize()\r\n        assert(T.isFunction(mw_init), context + ':apply_on_server:bad middleware init function')\r\n        arg_server.server.use(mw_init)\r\n        \r\n        // ENABLE PASSPORT SESSION\r\n        if (this.use_session)\r\n        {\r\n            const mw_session = this.passport.session()\r\n            assert(T.isFunction(mw_session), context + ':apply_on_server:bad middleware session function')\r\n            arg_server.server.use(mw_session)\r\n        }\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get a authentication middleware to use on servers (see Connect/Express middleware signature).\r\n     * @returns {function} - function(request,response,next){...}\r\n     */\r\n    create_middleware()\r\n    {\r\n        // USE PASSPORT STRATEGY\r\n        const strategy = this.get_passport_strategy()\r\n        assert(T.isObject(strategy), context + ':create_middleware:bad strategy object')\r\n        this.passport.use(strategy)\r\n        \r\n        // STRATEGY NAME\r\n        assert(T.isFunction(this.get_passport_strategy_name), context + ':create_middleware:bad strategy name function')\r\n        const strategy_name = this.get_passport_strategy_name()\r\n        assert(T.isString(strategy_name), context + ':create_middleware:bad stragegy name')\r\n        \r\n        const mw = passport.authenticate(strategy_name, { session: this.use_session })\r\n        assert(T.isFunction(mw), context + ':create_middleware:bad middleware function')\r\n        return mw\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get a authentication route middleware to use on servers (see Connect/Express middleware signature).\r\n     * @returns {function} - function(request,response){...}\r\n     */\r\n    create_route_middleware()\r\n    {\r\n        // USE PASSPORT STRATEGY\r\n        const strategy = this.get_passport_strategy()\r\n        assert(T.isObject(strategy), context + ':create_middleware:bad strategy object')\r\n        this.passport.use(strategy)\r\n        \r\n        // STRATEGY NAME\r\n        assert(T.isFunction(this.get_passport_strategy_name), context + ':create_middleware:bad strategy name function')\r\n        const strategy_name = this.get_passport_strategy_name()\r\n        assert(T.isString(strategy_name), context + ':create_middleware:bad stragegy name')\r\n        \r\n        // ROUTE MW: f(req,res)\r\n        const mw = passport.authenticate(strategy_name, { session: this.use_session })\r\n        assert(T.isFunction(mw), context + ':create_middleware:bad middleware function')\r\n        \r\n        return mw\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get Passport strategy provided by this class.\r\n     * @abstract\r\n     * @returns {object} - Passport strategy instance\r\n     */\r\n    // get_passport_strategy()\r\n    // {\r\n    //     this.error_not_implemented()\r\n    //     return null\r\n    // }\r\n    \r\n    add_strategy(arg_name, arg_instance)\r\n    {\r\n        this.strategies_names.push('local')\r\n    }\r\n    \r\n    \r\n    add_local_strategy()\r\n    {\r\n        const self = this\r\n        \r\n        const LocalStrategy = passport_local.Strategy\r\n        // const LocalStrategy = passport_local.BasicStrategy\r\n        \r\n        // BUILD LOCAL STRATEGY SETTINGS\r\n        const settings = {}\r\n        if (this.username_fieldname)\r\n        {\r\n            settings.usernameField = this.username_fieldname\r\n        }\r\n        if (this.password_fieldname)\r\n        {\r\n            settings.passwordField = this.password_fieldname\r\n        }\r\n        if (this.success_redirect)\r\n        {\r\n            settings.successRedirect = this.success_redirect\r\n        }\r\n        if (this.failure_redirect)\r\n        {\r\n            settings.failureRedirect = this.failure_redirect\r\n        }\r\n        settings.failureFlash = true\r\n        \r\n        // CREATE AND RETURN A LOCAL STRATEGY INSTANCE\r\n        const strategy = new LocalStrategy(\r\n            settings,\r\n            function(arg_username, arg_password, arg_done_cb)\r\n            {\r\n                self.debug('LocalStrategy.authenticate')\r\n                console.log(context + '.LocalStrategy:mw')\r\n                \r\n                const credentials = { 'user':arg_username, 'password':arg_password }\r\n                const instance = new Credentials(credentials)\r\n                instance.done_cb = arg_done_cb\r\n                this.authenticate(instance)\r\n            }\r\n        )\r\n        \r\n        \r\n        this.add_strategy('local', strategy)\r\n    }\r\n}\r\n",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 603,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/todo/authentication_plugin_passport.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 604,
    "kind": "class",
    "name": "AuthenticationPluginPassport",
    "memberof": "js/security/todo/authentication_plugin_passport.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport.js",
    "importStyle": "AuthenticationPluginPassport",
    "description": "Authentication base class for Passport strategies.",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "abstract": true,
    "interface": false,
    "extends": [
      "js/security/todo/authentication_plugin.js~AuthenticationPlugin"
    ]
  },
  {
    "__docId__": 605,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#constructor",
    "access": null,
    "description": "Create an Authentication class for all Passport strategies.",
    "lineNumber": 33,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "plugin name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class",
        "description": "plugin class name."
      },
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 606,
    "kind": "member",
    "name": "is_authentication",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#is_authentication",
    "access": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 607,
    "kind": "member",
    "name": "passport",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#passport",
    "access": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 608,
    "kind": "member",
    "name": "strategies",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#strategies",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 609,
    "kind": "member",
    "name": "strategies_names",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#strategies_names",
    "access": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 610,
    "kind": "method",
    "name": "enable",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#enable",
    "access": null,
    "description": "Enable authentication plugin with contextual informations.",
    "lineNumber": 50,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 611,
    "kind": "member",
    "name": "username_fieldname",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#username_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 57,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 612,
    "kind": "member",
    "name": "password_fieldname",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#password_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 63,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 613,
    "kind": "member",
    "name": "id_fieldname",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#id_fieldname",
    "access": null,
    "description": null,
    "lineNumber": 69,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 614,
    "kind": "member",
    "name": "success_redirect",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#success_redirect",
    "access": null,
    "description": null,
    "lineNumber": 75,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 615,
    "kind": "member",
    "name": "failure_redirect",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#failure_redirect",
    "access": null,
    "description": null,
    "lineNumber": 81,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 616,
    "kind": "member",
    "name": "use_session",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#use_session",
    "access": null,
    "description": null,
    "lineNumber": 87,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 617,
    "kind": "method",
    "name": "disable",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#disable",
    "access": null,
    "description": "Disable authentication plugin with contextual informations.",
    "lineNumber": 99,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 618,
    "kind": "method",
    "name": "apply_on_server",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#apply_on_server",
    "access": null,
    "description": "Apply authentication plugin io given server. Use a middleware.",
    "lineNumber": 111,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_server",
        "description": "Runtime server (Express/Restify server for example)"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 619,
    "kind": "method",
    "name": "create_middleware",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#create_middleware",
    "access": null,
    "description": "Get a authentication middleware to use on servers (see Connect/Express middleware signature).",
    "lineNumber": 137,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{function} - function(request,response,next){...}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "function"
      ],
      "spread": false,
      "description": "function(request,response,next){...}"
    }
  },
  {
    "__docId__": 620,
    "kind": "method",
    "name": "create_route_middleware",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#create_route_middleware",
    "access": null,
    "description": "Get a authentication route middleware to use on servers (see Connect/Express middleware signature).",
    "lineNumber": 159,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{function} - function(request,response){...}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "function"
      ],
      "spread": false,
      "description": "function(request,response){...}"
    }
  },
  {
    "__docId__": 621,
    "kind": "method",
    "name": "add_strategy",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#add_strategy",
    "access": null,
    "description": "Get Passport strategy provided by this class.",
    "lineNumber": 190,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - Passport strategy instance"
      }
    ],
    "params": [
      {
        "name": "arg_name",
        "types": [
          "*"
        ]
      },
      {
        "name": "arg_instance",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "Passport strategy instance"
    },
    "abstract": true
  },
  {
    "__docId__": 622,
    "kind": "method",
    "name": "add_local_strategy",
    "memberof": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport#add_local_strategy",
    "access": null,
    "description": null,
    "lineNumber": 196,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": []
  },
  {
    "__docId__": 623,
    "kind": "file",
    "name": "js/security/todo/authentication_plugin_passport_local.js",
    "content": "\r\n// NPM IMPORTS\r\nimport passport_local from 'passport-local'\r\n// import passport_local from 'passport-http'\r\n\r\n// COMMON IMPORTS\r\n// import T           from 'devapt-core-common/dist/js/utils/types'\r\nimport Credentials from 'devapt-core-common/dist/js/base/credentials'\r\n\r\nimport AuthenticationPluginPassport from './authentication_plugin_passport'\r\n\r\n\r\nlet context = 'common/security/authentication_plugin_passport_local'\r\n\r\n\r\n\r\n/**\r\n * Authentication class for Passport Local strategy.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationPluginPassportLocal extends AuthenticationPluginPassport\r\n{\r\n    /**\r\n     * Create an Authentication plugin class based on passport local strategy.\r\n     * @param {string|undefined} arg_log_context - optional.\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_log_context)\r\n\t{\r\n\t\tsuper(arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication_passport_local = true\r\n\t}\r\n    \r\n    \r\n    /**\r\n     * Get Passport strategy name provided by this class.\r\n     * @returns {string} - Passport strategy name\r\n     */\r\n    get_passport_strategy_name()\r\n    {\r\n        return 'local'\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get Passport strategy provided by this class.\r\n     * @returns {object} - Passport strategy instance\r\n     */\r\n    get_passport_strategy()\r\n    {\r\n        const self = this\r\n        const LocalStrategy = passport_local.Strategy\r\n        // const LocalStrategy = passport_local.BasicStrategy\r\n        \r\n        // BUILD LOCAL STRATEGY SETTINGS\r\n        const settings = {}\r\n        if (this.username_fieldname)\r\n        {\r\n            settings.usernameField = this.username_fieldname\r\n        }\r\n        if (this.password_fieldname)\r\n        {\r\n            settings.passwordField = this.password_fieldname\r\n        }\r\n        if (this.success_redirect)\r\n        {\r\n            settings.successRedirect = this.success_redirect\r\n        }\r\n        if (this.failure_redirect)\r\n        {\r\n            settings.failureRedirect = this.failure_redirect\r\n        }\r\n        settings.failureFlash = true\r\n        \r\n        // CREATE AND RETURN A LOCAL STRATEGY INSTANCE\r\n        return new LocalStrategy(\r\n            settings,\r\n            function(arg_username, arg_password, arg_done_cb)\r\n            {\r\n                self.debug('LocalStrategy.authenticate')\r\n                console.log(context + '.LocalStrategy:mw')\r\n                \r\n                const credentials = { 'user':arg_username, 'password':arg_password }\r\n                const instance = new Credentials(credentials)\r\n                instance.done_cb = arg_done_cb\r\n                this.authenticate(instance)\r\n            }\r\n        )\r\n    }\r\n}\r\n",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 624,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 625,
    "kind": "class",
    "name": "AuthenticationPluginPassportLocal",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local.js",
    "importStyle": "AuthenticationPluginPassportLocal",
    "description": "Authentication class for Passport Local strategy.",
    "lineNumber": 22,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/security/todo/authentication_plugin_passport.js~AuthenticationPluginPassport"
    ]
  },
  {
    "__docId__": 626,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal#constructor",
    "access": null,
    "description": "Create an Authentication plugin class based on passport local strategy.",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 627,
    "kind": "member",
    "name": "is_authentication_passport_local",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal#is_authentication_passport_local",
    "access": null,
    "description": null,
    "lineNumber": 33,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 628,
    "kind": "method",
    "name": "get_passport_strategy_name",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal#get_passport_strategy_name",
    "access": null,
    "description": "Get Passport strategy name provided by this class.",
    "lineNumber": 41,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - Passport strategy name"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "Passport strategy name"
    }
  },
  {
    "__docId__": 629,
    "kind": "method",
    "name": "get_passport_strategy",
    "memberof": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal#get_passport_strategy",
    "access": null,
    "description": "Get Passport strategy provided by this class.",
    "lineNumber": 51,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - Passport strategy instance"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "Passport strategy instance"
    }
  },
  {
    "__docId__": 630,
    "kind": "file",
    "name": "js/security/todo/authentication_plugin_passport_local_db.js",
    "content": "\r\n// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport AuthenticationPluginPassportLocal from './authentication_plugin_passport_local'\r\n\r\n\r\nlet context = 'common/security/authentication_plugin_passport_local_db'\r\n\r\n\r\n\r\n/**\r\n * Authentication class for Passport Local database strategy.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationPluginPassportLocalDb extends AuthenticationPluginPassportLocal\r\n{\r\n\t/**\r\n\t * Create an Authentication plugin class based on passport local database strategy.\r\n\t * @param {string|undefined} arg_log_context - optional.\r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_log_context)\r\n\t{\r\n\t\tsuper(arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication_passport_local_db = true\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Enable authentication plugin with contextual informations.\r\n\t * @param {object|undefined} arg_settings - optional contextual settings.\r\n\t * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n\t */\r\n\tenable(arg_settings)\r\n\t{\r\n\t\tconst resolved_promise = super.enable(arg_settings)\r\n\r\n\t\t// SET MODEL NAME\r\n\t\tthis.model_name = null\r\n\t\tif (arg_settings && T.isString(arg_settings.model_name) )\r\n\t\t{\r\n\t\t\tthis.model_name = arg_settings.model_name\r\n\t\t}\r\n\r\n\t\treturn resolved_promise\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Authenticate a user with a database giving request credentials.\r\n\t * @param {object|undefined} arg_credentials - request credentials object\r\n\t * @returns {object} - a promise of boolean\r\n\t */\r\n\tauthenticate(arg_credentials)\r\n\t{\r\n\t\tassert( T.isObject(this.model), context + ':authenticate:bad model object')\r\n\t\tassert( T.isObject(arg_credentials), context + ':authenticate:bad credentials object')\r\n\t\tassert( T.isString(arg_credentials.username), context + ':authenticate:bad credentials.username string')\r\n\t\tassert( T.isString(arg_credentials.password), context + ':authenticate:bad credentials.password string')\r\n\t\t/*\r\n\t\tUser.findOne({ username: arg_username },\r\n\t\t\t\t\tfunction(err, user)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif (err) { return arg_done_cb(err); }\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!user)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn arg_done_cb(null, false, { message: 'Incorrect username.' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!user.validPassword(arg_password))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\treturn arg_done_cb(null, false, { message: 'Incorrect password.' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn arg_done_cb(null, user);\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t*/\r\n\t\t\r\n\t\tlet resolved_promise = Promise.resolve(true)\r\n\t\tif (arg_credentials.done_cb)\r\n\t\t{\r\n\t\t\tresolved_promise.then(arg_credentials.done_cb)\r\n\t\t}\r\n\t\t\r\n\t\treturn resolved_promise\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 631,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local_db.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 632,
    "kind": "class",
    "name": "AuthenticationPluginPassportLocalDb",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local_db.js",
    "importStyle": "AuthenticationPluginPassportLocalDb",
    "description": "Authentication class for Passport Local database strategy.",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal"
    ]
  },
  {
    "__docId__": 633,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#constructor",
    "access": null,
    "description": "Create an Authentication plugin class based on passport local database strategy.",
    "lineNumber": 28,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 634,
    "kind": "member",
    "name": "is_authentication_passport_local_db",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#is_authentication_passport_local_db",
    "access": null,
    "description": null,
    "lineNumber": 32,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 635,
    "kind": "method",
    "name": "enable",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#enable",
    "access": null,
    "description": "Enable authentication plugin with contextual informations.",
    "lineNumber": 41,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 636,
    "kind": "member",
    "name": "model_name",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#model_name",
    "access": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 637,
    "kind": "member",
    "name": "model_name",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#model_name",
    "access": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 638,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_db.js~AuthenticationPluginPassportLocalDb#authenticate",
    "access": null,
    "description": "Authenticate a user with a database giving request credentials.",
    "lineNumber": 61,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean"
    }
  },
  {
    "__docId__": 639,
    "kind": "file",
    "name": "js/security/todo/authentication_plugin_passport_local_file.js",
    "content": "\r\n// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport lowdb from 'lowdb'\r\nimport path from 'path'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\nimport AuthenticationPluginPassportLocal from './authentication_plugin_passport_local'\r\n\r\n\r\nlet context = 'common/security/authentication_plugin_passport_local_file'\r\n\r\n\r\n\r\n/**\r\n * Authentication class for Passport Local file strategy.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class AuthenticationPluginPassportLocalFile extends AuthenticationPluginPassportLocal\r\n{\r\n    /**\r\n     * Create an Authentication plugin class based on passport local file strategy.\r\n     * @param {string|undefined} arg_log_context - optional.\r\n     * @returns {nothing}\r\n     */\r\n\tconstructor(arg_log_context)\r\n\t{\r\n\t\tsuper(arg_log_context ? arg_log_context : context)\r\n\t\t\r\n\t\tthis.is_authentication_passport_local_file = true\r\n        \r\n        this.passport.serializeUser(\r\n            function(user, done)\r\n            {\r\n                done(null, this.get_user_id(user))\r\n            }\r\n        )\r\n        \r\n        this.passport.deserializeUser(\r\n            function(id, done)\r\n            {\r\n                this.get_user_by_id(id).then(\r\n                    function(user)\r\n                    {\r\n                        done(null, user)\r\n                    },\r\n                    function()\r\n                    {\r\n                        done('not found', false)\r\n                    }\r\n                )\r\n            }\r\n        )\r\n\t}\r\n    \r\n    \r\n\t/**\r\n     * Enable authentication plugin with contextual informations.\r\n     * @param {object|undefined} arg_settings - optional contextual settings.\r\n     * @returns {object} - a promise object of a boolean result (success:true, failure:false)\r\n     */\r\n\tenable(arg_settings)\r\n\t{\r\n        let resolved_promise = super.enable(arg_settings)\r\n        \r\n        // SET FILE NAME\r\n        this.file_name = null\r\n        if (arg_settings && T.isString(arg_settings.file_name) )\r\n        {\r\n            this.file_name = arg_settings.file_name\r\n        }\r\n        \r\n        // LOAD FILE DB\r\n        this.file_db = null\r\n        if (this.file_name)\r\n        {\r\n            resolved_promise = resolved_promise.then(\r\n                function()\r\n                {\r\n                    const base_dir = runtime.get_setting('base_dir', null)\r\n                    assert( T.isString(base_dir), context + ':enable:bad base dir string')\r\n                    \r\n                    const json_full_path = path.join(base_dir, this.file_name)\r\n                    \r\n                    // OPEN DATABASE\r\n                    const db_settings = {\r\n                        autosave:true,\r\n                        async:true\r\n                    }\r\n                    this.file_db = lowdb(json_full_path, db_settings)\r\n                }\r\n            )\r\n        }\r\n        \r\n        return resolved_promise\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Authenticate a user with a file giving request credentials.\r\n     * @param {object|undefined} arg_credentials - request credentials object\r\n     * @returns {object} - a promise of boolean\r\n     */\r\n    authenticate(arg_credentials)\r\n    {\r\n        this.debug('authenticate')\r\n        \r\n        assert( T.isObject(this.db), context + ':authenticate:bad db object')\r\n        assert( T.isObject(arg_credentials), context + ':authenticate:bad credentials object')\r\n        assert( T.isString(arg_credentials.username), context + ':authenticate:bad credentials.username string')\r\n        assert( T.isString(arg_credentials.password), context + ':authenticate:bad credentials.password string')\r\n        \r\n        // CREATE QUERY\r\n        const username_field = this.username_fieldname ? this.username_fieldname : 'username'\r\n        const password_field = this.id_password_fieldnamefieldname ? this.password_fieldname : 'password'\r\n        let query = {}\r\n        query[username_field] = arg_credentials.username\r\n        query[password_field] = arg_credentials.password\r\n        \r\n        // EXECUTE QUERY\r\n        try{\r\n            const users = this.db('users').find(query)\r\n            if (users)\r\n            {\r\n                const first_user = (T.isArray(users) && users.length > 0) ? users[0] : (T.isObject(users) ? users : null)\r\n                if ( T.isFunction(arg_credentials.done_cb) )\r\n                {\r\n                    arg_credentials.done_cb(first_user)\r\n                }\r\n                \r\n                this.debug('authenticate:success')\r\n                return Promise.resolve(true)\r\n            }\r\n        }\r\n        catch(e)\r\n        {\r\n        }\r\n        \r\n        this.debug('authenticate:failure')\r\n        return Promise.resolve(false)\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get user id from a user record.\r\n     * @param {object} arg_user_record - user record object\r\n     * @returns {string} - user id\r\n     */\r\n    get_user_id(arg_user_record)\r\n    {\r\n        const id_field = this.id_fieldname ? this.id_fieldname : 'id'\r\n        return ( T.isObject(arg_user_record) && (id_field in arg_user_record) ) ? arg_user_record[id_field] : null\r\n    }\r\n    \r\n    \r\n    /**\r\n     * Get user record by its id.\r\n     * @param {string} arg_user_id - user id\r\n     * @returns {string} - user id\r\n     */\r\n    get_user_by_id(arg_user_id)\r\n    {\r\n        assert( T.isObject(this.db), context + ':get_user_by_id:bad db object')\r\n        \r\n        // CREATE QUERY\r\n        const id_field = this.id_fieldname ? this.id_fieldname : 'id'\r\n        let query = {}\r\n        query[id_field] = arg_user_id\r\n        \r\n        // EXECUTE QUERY\r\n        try{\r\n            let users = this.db('users').find(query)\r\n            if (users)\r\n            {\r\n                return (T.isArray(users) && users.length > 0) ? users[0] : (T.isObject(users) ? users : null)\r\n            }\r\n        }\r\n        catch(e)\r\n        {\r\n        }\r\n        \r\n        return null\r\n    }\r\n}\r\n",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 640,
    "kind": "variable",
    "name": "context",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local_file.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 641,
    "kind": "class",
    "name": "AuthenticationPluginPassportLocalFile",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js",
    "static": true,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/security/todo/authentication_plugin_passport_local_file.js",
    "importStyle": "AuthenticationPluginPassportLocalFile",
    "description": "Authentication class for Passport Local file strategy.",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/security/todo/authentication_plugin_passport_local.js~AuthenticationPluginPassportLocal"
    ]
  },
  {
    "__docId__": 642,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#constructor",
    "access": null,
    "description": "Create an Authentication plugin class based on passport local file strategy.",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "optional."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 643,
    "kind": "member",
    "name": "is_authentication_passport_local_file",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#is_authentication_passport_local_file",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 644,
    "kind": "method",
    "name": "enable",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#enable",
    "access": null,
    "description": "Enable authentication plugin with contextual informations.",
    "lineNumber": 67,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise object of a boolean result (success:true, failure:false)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "optional contextual settings."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise object of a boolean result (success:true, failure:false)"
    }
  },
  {
    "__docId__": 645,
    "kind": "member",
    "name": "file_name",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#file_name",
    "access": null,
    "description": null,
    "lineNumber": 72,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 646,
    "kind": "member",
    "name": "file_name",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#file_name",
    "access": null,
    "description": null,
    "lineNumber": 75,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 647,
    "kind": "member",
    "name": "file_db",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#file_db",
    "access": null,
    "description": null,
    "lineNumber": 79,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 648,
    "kind": "member",
    "name": "file_db",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#file_db",
    "access": null,
    "description": null,
    "lineNumber": 95,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 649,
    "kind": "method",
    "name": "authenticate",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#authenticate",
    "access": null,
    "description": "Authenticate a user with a file giving request credentials.",
    "lineNumber": 109,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - a promise of boolean"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object",
          "undefined"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of boolean"
    }
  },
  {
    "__docId__": 650,
    "kind": "method",
    "name": "get_user_id",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#get_user_id",
    "access": null,
    "description": "Get user id from a user record.",
    "lineNumber": 154,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - user id"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_user_record",
        "description": "user record object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "user id"
    }
  },
  {
    "__docId__": 651,
    "kind": "method",
    "name": "get_user_by_id",
    "memberof": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/security/todo/authentication_plugin_passport_local_file.js~AuthenticationPluginPassportLocalFile#get_user_by_id",
    "access": null,
    "description": "Get user record by its id.",
    "lineNumber": 166,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{string} - user id"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_user_id",
        "description": "user id"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "string"
      ],
      "spread": false,
      "description": "user id"
    }
  },
  {
    "__docId__": 652,
    "kind": "file",
    "name": "js/servers/express_server.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport _ from 'lodash'\r\nimport express from 'express'\r\nimport http from 'http'\r\nimport socketio from 'socket.io'\r\nimport compression from 'compression'\r\n// import helmet from 'helmet'\r\nimport favicon from 'express-favicon'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\nimport RoutableServer from './routable_server'\r\nimport MetricsMiddleware from '../metrics/http/metrics_http_collector'\r\n\r\n\r\nconst context = 'server/servers/express_server'\r\n\r\n\r\n\r\n/**\r\n * @file Express server class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ExpressServer extends RoutableServer\r\n{\r\n\t/**\r\n\t * Create Express server instance.\r\n\t * @extends RoutableServer\r\n\t * \r\n\t * @param {string} arg_name - server name.\r\n\t * @param {object} arg_settings - plugin settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tsuper(arg_name, 'ExpressServer', arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_express_server = true\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Build private server instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tbuild_server()\r\n\t{\r\n\t\tthis.enter_group('build_server')\r\n\t\t\r\n\t\t\r\n\t\tassert( this.server_protocole == 'http' || this.server_protocole == 'https', context + ':bad protocole for express [' + this.server_protocole + ']')\r\n\t\t\r\n\t\t// CREATE SERVER\r\n\t\tthis.info('build_server:create Express server')\r\n\t\tthis.server = express()\r\n\t\t\r\n\t\t// USE COMPRESSED RESPONSE WITH GZIP\r\n\t\tthis.info('build_server:use compression')\r\n\t\tthis.server.use(compression())\r\n\t\t\r\n\t\t// USE SECURITY MIDDLEWARE (https://www.npmjs.com/package/helmet)\r\n\t\tthis.info('build_server:use security')\r\n\t\t// this.server.use(helmet)\r\n\t\tthis.server.disable('x-powered-by')\r\n\t\t\r\n\t\t\r\n\t\t// USE METRICS MIDDLEWARE\r\n\t\tthis.info('build_server:use metrics')\r\n\t\tthis.server.use( MetricsMiddleware.create_middleware(this) )\r\n\t\t\r\n\t\t\r\n\t\t// USE FAVICON MIDDLEWARE\r\n\t\tthis.info('build_server:use favicon')\r\n\t\tconst favicon_path = runtime.context.get_absolute_path('../../../public/img/favico.png')\r\n\t\t// console.log(favicon_path, 'favicon_path')\r\n\t\tthis.server.use( favicon(favicon_path) )\r\n\t\t\r\n\t\t\r\n\t\t// BUILD SOCKETIO\r\n\t\tthis.info('build_server:use socketio')\r\n\t\tconst use_socketio = this.get_setting('use_socketio', false)\r\n\t\tconsole.log(context + ':build_server:use socket io?', use_socketio)\r\n\t\t\r\n\t\tif (use_socketio)\r\n\t\t{\r\n\t\t\tconsole.log(context + ':build_server:creating Express socket io')\r\n\t\t\t\r\n\t\t\tthis.server_http = http.Server(this.server)\r\n\t\t\tthis.serverio = socketio(this.server_http)\r\n\t\t\t\r\n\t\t\truntime.add_socketio(this.get_name(), this.serverio)\r\n\t\t}\r\n\r\n\t\t\r\n\t\t// USE ALL MIDDLEWARES WITHOUT SECURITY\r\n\t\tthis.info('build_server:use all middleware without security')\r\n\t\tthis.services_without_security.forEach(\r\n\t\t\t(arg_record) => {\r\n\t\t\t\tthis.info('build_server:activate service=' + arg_record.svc.get_name())\r\n\t\t\t\targ_record.svc.activate_on_server(arg_record.app, this, arg_record.cfg)\r\n\t\t\t}\r\n\t\t)\r\n\r\n\r\n\t\t// USE AUTHENTICATION MIDDLEWARES\r\n\t\tthis.info('build_server:apply authentication middlewares')\r\n\t\tthis.authentication.apply_middlewares(this)\r\n\t\t\r\n\t\t\r\n\t\t// TODO: USE AUTHORIZATION MIDDLEWARE\r\n\t\t// this.server.use( this.authorization.create_middleware() )\r\n\t\t\r\n\r\n\t\t// USE ALL MIDDLEWARES WITH SECURITY\r\n\t\tthis.info('build_server:use all middleware with security')\r\n\t\tthis.services_with_security.forEach(\r\n\t\t\t(arg_record) => {\r\n\t\t\t\targ_record.svc.activate_on_server(arg_record.app, this, arg_record.cfg)\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\t\r\n\t\t// DEFAULT VIEW ENGINE\r\n\t\t// this.server.use( express.bodyParser() )\r\n\t\tthis.server.set('views', runtime.context.get_absolute_path('jade'))\r\n\t\tthis.server.set('view engine', 'jade')\r\n\t\t\r\n\t\t\r\n\t\tthis.leave_group('build_server')\r\n\t}\r\n\t\r\n\tfinaly()\r\n\t{\r\n\t\t// USE FILE NOT FOUND MIDDLEWARE\r\n\t\tthis.server.use(\r\n\t\t\tfunction(req, res/*, next*/)\r\n\t\t\t{\r\n\t\t\t\tconsole.log('EXPRESS: FILE NOT FOUND', req.url)\r\n\t\t\t\t\r\n\t\t\t\tres.status(404)\r\n\r\n\t\t\t\t// SEND HTML RESPONSE\r\n\t\t\t\tif (req.accepts('html'))\r\n\t\t\t\t{\r\n\t\t\t\t\tres.render('404', { url: req.url })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// SEND JSON RESPONSE\r\n\t\t\t\tif (req.accepts('json'))\r\n\t\t\t\t{\r\n\t\t\t\t\tres.send({ error: 'Not found' })\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// SEND PLAIN TEXT RESPONSE\r\n\t\t\t\tres.type('txt').send('Not found')\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\t\r\n\t\t// USE BAD REQUEST MIDDLEWARE\r\n\t\tthis.server.use(\r\n\t\t\tfunction(err, req, res, next)\r\n\t\t\t{\r\n\t\t\t\t// !!! RES COULD BE A http.ServerResponse AND NOT A Express.Response INSTANCE\r\n\t\t\t\tif (req.xhr)\r\n\t\t\t\t{\r\n\t\t\t\t\tres.status(500).send( { error: 'Something failed!' } );\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tnext(err)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\t\r\n\t\t// USE ERROR MIDDLEWARE\r\n\t\tthis.server.use(\r\n\t\t\tfunction(err, req, res/*, next*/)\r\n\t\t\t{\r\n\t\t\t\tconsole.log(req.url, 'request.url')\r\n\t\t\t\tconsole.error(err.stack)\r\n\t\t\t\tres.status(500)\r\n\t\t\t\tres.render('error', { error: err } )\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for static route.\r\n\t * \r\n     * @param {object} arg_cfg_route - plain object route configuration.\r\n\t * \r\n\t * @returns {middleware} - middleware function as f(req, res, next)\r\n\t */\r\n\tget_middleware_for_static_route(arg_cfg_route)\r\n\t{\r\n\t\tconst dir_path = runtime.context.get_absolute_public_path(arg_cfg_route.directory)\r\n\r\n\t\t// DEBUG\r\n\t\tconsole.log(context + ':get_middleware_for_static_route:express static route', arg_cfg_route)\r\n\t\tconsole.log(context + ':ROUTE FOR ASSETS IN DIRECTORY MODE => dir_path=', dir_path)\r\n\r\n\t\t// STATIC OPTIONS\r\n\t\tconst one_day = 86400000\r\n\t\tconst static_cfg = {\r\n\t\t\tmaxAge:one_day,\r\n\t\t\tredirect:false,\r\n\t\t\tfallthrough:false,\r\n\t\t\tsetHeaders:undefined, // function\r\n\t\t\tindex:arg_cfg_route.default\r\n\t\t}\r\n\r\n\t\treturn (req, res, next)=>{\r\n\t\t\tconst asset_path = req._parsedUrl.pathname\r\n\r\n\t\t\tconsole.log(context + ':get_middleware_for_static_route:express static middleware', arg_cfg_route.directory, req._parsedUrl, dir_path, asset_path)\r\n\t\t\t\r\n\t\t\tdebugger\r\n\t\t\t\r\n\t\t\t// TEST REQUIRED PREFIXES\r\n\t\t\tif ( T.isNotEmptyArray(arg_cfg_route.required_prefixes) )\r\n\t\t\t{\r\n\t\t\t\tlet match = false\r\n\t\t\t\t_.forEach(arg_cfg_route.required_prefixes,\r\n\t\t\t\t\t(value)=>{\r\n\t\t\t\t\t\tif ( asset_path.startsWith(value) )\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmatch = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\r\n\t\t\t\tif (! match)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.warn(context + ':get_middleware_for_static_route:not matching route prefix for ' + asset_path)\r\n\r\n\t\t\t\t\treturn next()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// TEST REQUIRED SUFFIXES\r\n\t\t\tif ( T.isNotEmptyArray(arg_cfg_route.required_suffixes) )\r\n\t\t\t{\r\n\t\t\t\tlet match = false\r\n\t\t\t\t_.forEach(arg_cfg_route.required_suffixes,\r\n\t\t\t\t\t(value)=>{\r\n\t\t\t\t\t\tif ( asset_path.endsWith(value) )\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tmatch = true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\r\n\t\t\t\tif (! match)\r\n\t\t\t\t{\r\n\t\t\t\t\tconsole.warn(context + ':get_middleware_for_static_route:not matching route suffix for ' + asset_path)\r\n\r\n\t\t\t\t\treturn next()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn express.static(dir_path, static_cfg)(req, res, next)\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for directory route.\r\n\t * \r\n     * @param {object}   arg_cfg_route - plain object route configuration.\r\n\t * @param {function} arg_callback - route handler callback.\r\n\t * \r\n\t * @returns {boolean} - success or failure.\r\n\t */\r\n\tadd_get_route(arg_cfg_route, arg_callback)\r\n\t{\r\n\t\tthis.enter_group('add_get_route')\r\n\r\n\t\tconst route = arg_cfg_route.route_regexp ? arg_cfg_route.route_regexp : arg_cfg_route.full_route\r\n\r\n\t\tassert( T.isObject(arg_cfg_route),  this.get_context() + '::bad route config object')\r\n\t\tassert( T.isFunction(arg_callback), this.get_context() + '::bad callback function for route [' + arg_cfg_route.full_route + ']')\r\n\t\tassert( T.isString(route) || T.isRegExp(route), this.get_context() + '::bad route string|RegExp for config [' + JSON.stringify(arg_cfg_route) + ']')\r\n\r\n\t\t// CHECK EXPRESS SERVER\r\n\t\tif ( ! this.server || ! T.isFunction(this.server.use) )\r\n\t\t{\r\n\t\t\tthis.leave_group('add_get_route:bad server error for route config [' + JSON.stringify(arg_cfg_route) + ']')\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tthis.server.use(route, arg_callback)\r\n\r\n\t\tthis.leave_group('add_get_route:[' + arg_cfg_route.full_route + ']')\r\n\t\treturn true\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/servers/express_server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 653,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/express_server.js",
    "static": true,
    "longname": "js/servers/express_server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/express_server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 654,
    "kind": "class",
    "name": "ExpressServer",
    "memberof": "js/servers/express_server.js",
    "static": true,
    "longname": "js/servers/express_server.js~ExpressServer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/express_server.js",
    "importStyle": "ExpressServer",
    "description": "",
    "lineNumber": 29,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Express server class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/servers/routable_server.js~RoutableServer"
    ]
  },
  {
    "__docId__": 655,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#constructor",
    "access": null,
    "description": "Create Express server instance.",
    "lineNumber": 41,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "RoutableServer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "plugin settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 656,
    "kind": "member",
    "name": "is_express_server",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#is_express_server",
    "access": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 657,
    "kind": "method",
    "name": "build_server",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#build_server",
    "access": null,
    "description": "Build private server instance.",
    "lineNumber": 55,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 658,
    "kind": "member",
    "name": "server",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#server",
    "access": null,
    "description": null,
    "lineNumber": 64,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 659,
    "kind": "member",
    "name": "server_http",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#server_http",
    "access": null,
    "description": null,
    "lineNumber": 97,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 660,
    "kind": "member",
    "name": "serverio",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#serverio",
    "access": null,
    "description": null,
    "lineNumber": 98,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 661,
    "kind": "method",
    "name": "finaly",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#finaly",
    "access": null,
    "description": null,
    "lineNumber": 141,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": []
  },
  {
    "__docId__": 662,
    "kind": "method",
    "name": "get_middleware_for_static_route",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#get_middleware_for_static_route",
    "access": null,
    "description": "Get server middleware for static route.",
    "lineNumber": 210,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{middleware} - middleware function as f(req, res, next)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "middleware"
      ],
      "spread": false,
      "description": "middleware function as f(req, res, next)"
    }
  },
  {
    "__docId__": 663,
    "kind": "method",
    "name": "add_get_route",
    "memberof": "js/servers/express_server.js~ExpressServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/express_server.js~ExpressServer#add_get_route",
    "access": null,
    "description": "Get server middleware for directory route.",
    "lineNumber": 291,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - success or failure."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      },
      {
        "nullable": null,
        "types": [
          "function"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_callback",
        "description": "route handler callback."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "success or failure."
    }
  },
  {
    "__docId__": 664,
    "kind": "file",
    "name": "js/servers/logs_server.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport _ from 'lodash'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\nimport Server from './server'\r\n\r\n\r\nconst context = 'server/servers/logs_server'\r\n\r\n\r\n\r\n/**\r\n * @file Logs server class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class LogsServer extends Server\r\n{\r\n\t/**\r\n\t * Create LogsServer instance to process logs records.\r\n\t * @extends Server\r\n\t * \r\n\t * @param {string} arg_name - server instance name\r\n\t * @param {Immutable.Map} arg_settings - server instance settings\r\n\t * @param {string} arg_context - logging context\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tsuper(arg_name, 'LogsServer', arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_logs_server = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Build server.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tbuild_server()\r\n\t{\r\n\t\tthis.enter_group('build_server')\r\n\t\t\r\n\t\tassert( this.server_protocole == 'bus', context + ':bad protocole for log server needed=[bus] settings=[' + this.server_protocole + ']')\r\n\t\t/*\r\n{\r\n\t\"timestamp\":\"9999999\",\r\n\t\"level\":\"debug\",\r\n\t\"source\":\"me\",\r\n\t\"values\":[\"hello1\", \"hello2\"]\r\n}\r\n\t\t*/\r\n\t\t// const logs_handler = (msg)=>{\r\n\t\t// \tconst logs_payload = msg.get_payload()\r\n\t\t// \tif (! logs_payload.timestamp || ! logs_payload.level || ! T.isNotEmptyArray(logs_payload.values) )\r\n\t\t// \t{\r\n\t\t// \t\tconsole.error(context + ':logs_handler:bad log msg payload format', logs_payload)\r\n\t\t// \t\treturn\r\n\t\t// \t}\r\n\t\t// \t// const mgr = this.get_logger_manager()\r\n\t\t// \t// logs_payload.values.forEach(\r\n\t\t// \t// \t(log)=>{\r\n\t\t// \t// \t\tswitch(logs_payload.level) {\r\n\t\t// \t// \t\t\tcase 'debug': return mgr.debug([logs_payload.timestamp, logs_payload.level, log])\r\n\t\t// \t// \t\t\tcase 'info':  return mgr.info([logs_payload.timestamp, logs_payload.level, log])\r\n\t\t// \t// \t\t\tcase 'warn':  return mgr.warn([logs_payload.timestamp, logs_payload.level, log])\r\n\t\t// \t// \t\t\tcase 'error': return mgr.error([logs_payload.timestamp, logs_payload.level, log])\r\n\t\t// \t// \t\t}\r\n\t\t// \t// \t}\r\n\t\t// \t// )\r\n\t\t// \tthis.process\r\n\t\t// }\r\n\t\t// runtime.node.logs_bus.msg_subscribe('logs', logs_handler, this.get_name())\r\n\r\n\t\truntime.node.logs_bus.msg_register(this, 'logs', 'receive_logs')\r\n\r\n\t\truntime.node.leave_group('build_server')\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Process received logs message.\r\n\t * \r\n\t * @param {DistributedLogs} arg_msg - logs message instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\treceive_logs(arg_msg)\r\n\t{\r\n\t\tthis.enter_group('receive_logs')\r\n\r\n\t\tconsole.log(context + ':receive_logs:from=%s payload=%s', arg_msg.get_sender(), JSON.stringify(arg_msg.get_payload()) )\r\n\r\n\t\t// DO NOT PROCESS MESSAGES FROM SELF\r\n\t\tif (arg_msg.get_sender() == this.get_name())\r\n\t\t{\r\n\t\t\tthis.leave_group('receive_logs:ignore message from itself')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.process_logs(arg_msg.get_payload())\r\n\r\n\t\tthis.leave_group('receive_logs')\r\n\t}\r\n    \r\n\t\r\n    \r\n    /**\r\n     * Process logs records.\r\n\t * \r\n\t * {object} arg_logs_record - logs record { ts, level, source, logs }.\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tprocess_logs(arg_logs_record)\r\n\t{\r\n\t\tthis.enter_group('process_logs')\r\n\t\t\r\n\t\tassert( T.isObject(arg_logs_record),           context + ':process_logs:bad logs object')\r\n\t\tassert( T.isString(arg_logs_record.ts),        context + ':process_logs:bad logs.ts string')\r\n\t\tassert( T.isString(arg_logs_record.level),     context + ':process_logs:bad logs.level string')\r\n\t\tassert( T.isString(arg_logs_record.source),    context + ':process_logs:bad logs.source string')\r\n\t\tassert( T.isArray(arg_logs_record.logs),       context + ':process_logs:bad logs.logs array')\r\n\t\t\r\n\t\t// DEBUG\r\n\t\t// console.log(context + ':process_logs:arg_logs_record=', arg_logs_record)\r\n\t\tthis.debug('log timestamp:'  + arg_logs_record.ts)\r\n\t\tthis.debug('log level:'      + arg_logs_record.level)\r\n\t\tthis.debug('log source:'     + arg_logs_record.source)\r\n\t\tthis.debug('log logs count:' + arg_logs_record.logs.length)\r\n\t\t\r\n\t\t_.forEach(arg_logs_record.logs,\r\n\t\t\t(log_item)=>{\r\n\t\t\t\tthis.process_log(arg_logs_record.ts, arg_logs_record.level, arg_logs_record.source, log_item)\r\n\t\t\t}\r\n\t\t)\r\n\r\n\t\tthis.leave_group('process_logs')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Process one log record.\r\n\t * \r\n\t * @param {string} arg_ts     - log timestamp.\r\n\t * @param {string} arg_level  - log level.\r\n\t * @param {string} arg_source - log source.\r\n\t * @param {string} arg_text   - log text.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tprocess_log(arg_ts, arg_level, arg_source, arg_text)\r\n\t{\r\n\t\t// TODO\r\n\t\tconsole.log(context + ':process_log:ts=[%s] level=[%s] source=[%s] text=[%s]', arg_ts, arg_level, arg_source, arg_text)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/servers/logs_server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 665,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/logs_server.js",
    "static": true,
    "longname": "js/servers/logs_server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/logs_server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 666,
    "kind": "class",
    "name": "LogsServer",
    "memberof": "js/servers/logs_server.js",
    "static": true,
    "longname": "js/servers/logs_server.js~LogsServer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/logs_server.js",
    "importStyle": "LogsServer",
    "description": "",
    "lineNumber": 22,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Logs server class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/servers/server.js~Server"
    ]
  },
  {
    "__docId__": 667,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#constructor",
    "access": null,
    "description": "Create LogsServer instance to process logs records.",
    "lineNumber": 34,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Server"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server instance name"
      },
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "server instance settings"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "logging context"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 668,
    "kind": "member",
    "name": "is_logs_server",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#is_logs_server",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 669,
    "kind": "method",
    "name": "build_server",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#build_server",
    "access": null,
    "description": "Build server.",
    "lineNumber": 48,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 670,
    "kind": "method",
    "name": "receive_logs",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#receive_logs",
    "access": null,
    "description": "Process received logs message.",
    "lineNumber": 97,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "DistributedLogs"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_msg",
        "description": "logs message instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 671,
    "kind": "method",
    "name": "process_logs",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#process_logs",
    "access": null,
    "description": "Process logs records.\n\n{object} arg_logs_record - logs record { ts, level, source, logs }.",
    "lineNumber": 124,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_logs_record",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 672,
    "kind": "method",
    "name": "process_log",
    "memberof": "js/servers/logs_server.js~LogsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/logs_server.js~LogsServer#process_log",
    "access": null,
    "description": "Process one log record.",
    "lineNumber": 162,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_ts",
        "description": "log timestamp."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_level",
        "description": "log level."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_source",
        "description": "log source."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_text",
        "description": "log text."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 673,
    "kind": "file",
    "name": "js/servers/metrics_server.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport Server from './server'\r\nimport MetricsHostCollector from '../metrics/host/metrics_host_collector'\r\nimport MetricsNodeJsCollector from '../metrics/nodejs/metrics_nodejs_collector'\r\nimport MetricsHttpCollector from '../metrics/http/metrics_http_collector'\r\nimport MetricsBusCollector from '../metrics/bus/metrics_bus_collector'\r\n\r\n\r\nconst context = 'server/servers/metrics_server'\r\n\r\n\r\n\r\n/**\r\n * @file Metrics server class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class MetricsServer extends Server\r\n{\r\n\t/**\r\n\t * Create MetricsServer instance to process metrics records.\r\n\t * @extends Server\r\n\t * \r\n\t * @param {string} arg_name - server instance name\r\n\t * @param {Immutable.Map} arg_settings - server instance settings\r\n\t * @param {string} arg_context - logging context\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tsuper(arg_name, 'MetricsServer', arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_metric_server = true\r\n        \r\n\t\tthis.metrics_collectors = {}\r\n\t\t\r\n\t\tthis.metrics_collectors['host'] = new MetricsHostCollector({}) // TODO find settings from parent settings\r\n\t\tthis.metrics_collectors['nodejs'] = new MetricsNodeJsCollector({}) // TODO find settings from parent settings\r\n\t\tthis.metrics_collectors['http'] = new MetricsHttpCollector({}) // TODO find settings from parent settings\r\n\t\tthis.metrics_collectors['bus'] = new MetricsBusCollector({}) // TODO find settings from parent settings\r\n\t\t\r\n\t\tthis.metrics_collectors['host'].init()\r\n\t\tthis.metrics_collectors['nodejs'].init()\r\n\t\tthis.metrics_collectors['http'].init()\r\n\t\tthis.metrics_collectors['bus'].init()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Build server.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tbuild_server()\r\n\t{\r\n\t\tthis.enter_group('build_server')\r\n\t\t\r\n\t\tassert( this.server_protocole == 'bus', context + ':bad protocole for metric server [' + this.server_protocole + ']')\r\n\t\t\r\n\t\tthis.leave_group('build_server')\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Process received metrics message (to override in sub classes).\r\n\t * \r\n\t * @param {DistributedMetrics} arg_msg - metrics message instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\treceive_metrics(arg_msg)\r\n\t{\r\n\t\tthis.enter_group('receive_metrics')\r\n\r\n\t\t// console.log(context + ':receive_metrics:from=%s type=%s', arg_msg.sender, arg_msg.payload.metric)\r\n\r\n\t\t// DO NOT PROCESS MESSAGES FROM SELF\r\n\t\tif (arg_msg.sender == this.get_name())\r\n\t\t{\r\n\t\t\tthis.leave_group('receive_metrics:ignore message from itself')\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.process_metric(arg_msg.get_metrics_type(), arg_msg.get_metrics_values())\r\n\r\n\t\tthis.leave_group('receive_metrics')\r\n\t}\r\n    \r\n\t\r\n    \r\n    /**\r\n     * Process metrics records.\r\n\t * \r\n\t * {string} arg_metric_type - metrics type (host, http...)\r\n     * {array} arg_metrics - Array of metrics plain objects\r\n\t * \r\n\t * @returns {nothing}\r\n     */\r\n\tprocess_metric(arg_metric_type, arg_metrics)\r\n\t{\r\n\t\tthis.enter_group('process_metric')\r\n\t\tthis.debug('metric type:' + arg_metric_type)\r\n\t\t\r\n\t\t// console.log(arg_metrics, context + ':process_metric:arg_metrics for ' + arg_metric_type)\r\n\t\t\r\n\t\tassert( T.isString(arg_metric_type), context + ':process_metric:bad metrics type')\r\n\t\tassert( T.isArray(arg_metrics) && arg_metrics.length > 0, context + ':process_metric:bad metrics array')\r\n\t\tassert( T.isObject(arg_metrics[0]) && T.isString(arg_metrics[0].metric) && arg_metrics[0].metric == arg_metric_type, context + ':process_metric:bad metrics[0] object')\r\n\t\t\r\n\t\tif (arg_metric_type in this.metrics_collectors)\r\n\t\t{\r\n\t\t\tthis.debug('metrics collector found for ' + arg_metric_type)\r\n\t\t\tthis.metrics_collectors[arg_metric_type].process_values(arg_metrics)\r\n\t\t}\r\n\r\n\t\tthis.leave_group('process_metric')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get metrics state values.\r\n\t * \r\n\t * @param {string} arg_type - metrics type.\r\n\t * \r\n\t * @returns {Object} - http state object.\r\n\t */\r\n\tget_metrics_state_values(arg_type)\r\n\t{\r\n\t\tif (arg_type in this.metrics_collectors)\r\n\t\t{\r\n\t\t\tconst metrics_collector = this.metrics_collectors[arg_type]\r\n\t\t\tassert( T.isObject(metrics_collector) && metrics_collector.is_metrics_collector, context + ':get_metrics_state_values:bad metrics collector object for ' + arg_type)\r\n\t\t\t\r\n\t\t\treturn metrics_collector.get_state_values()\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t// *************************************************** HTTP METRICS ***************************************************\r\n\t\r\n\t/**\r\n\t * Get http metrics state values.\r\n\t * \r\n\t * @returns {Object} - http state values object.\r\n\t */\r\n\tget_http_metrics_state_values()\r\n\t{\r\n\t\treturn this.get_metrics_state_values('http')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t// *************************************************** HOST METRICS ***************************************************\r\n\t\r\n\t/**\r\n\t * Get host metrics state values.\r\n\t * \r\n\t * @returns {Object} - host state values object.\r\n\t */\r\n\tget_host_metrics_state_values()\r\n\t{\r\n\t\treturn this.get_metrics_state_values('host')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get host metrics state values.\r\n\t * \r\n\t * @returns {Object} - host state values object.\r\n\t */\r\n\tget_host_metrics_state_values_items()\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('host')\r\n\t\tlet keys = Object.keys(state_values)\r\n\t\t\r\n\t\tconst metric_index = keys.indexOf('metric')\r\n\t\tkeys.splice(metric_index, 1)\r\n\t\t\r\n\t\treturn { items:keys }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get host metrics state values for an hostname.\r\n\t * \r\n\t * @param {string} arg_hostname - hostname.\r\n\t * \r\n\t * @returns {Object} - host state values object.\r\n\t */\r\n\tget_host_metrics_state_values_for(arg_hostname)\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('host')\r\n\t\treturn (arg_hostname in state_values) ? state_values[arg_hostname] : { hostname:arg_hostname }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t// *************************************************** BUS METRICS ***************************************************\r\n\t\r\n\t/**\r\n\t * Get bus metrics state values.\r\n\t * \r\n\t * @returns {Object} - bus state values object.\r\n\t */\r\n\tget_bus_metrics_state_values()\r\n\t{\r\n\t\treturn this.get_metrics_state_values('bus')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get bus metrics state values.\r\n\t * \r\n\t * @returns {Object} - bus state values object.\r\n\t */\r\n\tget_bus_metrics_state_values_items()\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('bus')\r\n\t\tlet keys = Object.keys(state_values)\r\n\t\t\r\n\t\tconst metric_index = keys.indexOf('metric')\r\n\t\tkeys.splice(metric_index, 1)\r\n\t\t\r\n\t\treturn { items:keys }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get bus metrics state values for a bus name.\r\n\t * \r\n\t * @param {string} arg_bus_name - bus name.\r\n\t * \r\n\t * @returns {Object} - bus state values object.\r\n\t */\r\n\tget_bus_metrics_state_values_for(arg_bus_name)\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('bus')\r\n\t\treturn (arg_bus_name in state_values) ? state_values[arg_bus_name] : { bus_name:arg_bus_name }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t// *************************************************** NODEJS METRICS ***************************************************\r\n\t\r\n\t/**\r\n\t * Get nodejs metrics state values.\r\n\t * \r\n\t * @returns {Object} - nodejs state values object.\r\n\t */\r\n\tget_nodejs_metrics_state_values()\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('nodejs')\r\n\t\t// console.log(state_values, 'get_nodejs_metrics_state_values')\r\n\t\treturn state_values\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get host metrics state values.\r\n\t * \r\n\t * @returns {Object} - host state values object.\r\n\t */\r\n\tget_nodejs_metrics_state_values_items()\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('nodejs')\r\n\t\tlet keys = Object.keys(state_values)\r\n\t\t\r\n\t\tconst metric_index = keys.indexOf('metric')\r\n\t\tkeys.splice(metric_index, 1)\r\n\t\t\r\n\t\treturn { items:keys }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get nodejs metrics state values for a nodejs instance.\r\n\t * \r\n\t * @param {string} arg_runtime_uid - nodejs runtime uid.\r\n\t * \r\n\t * @returns {Object} - nodejs state values object.\r\n\t */\r\n\tget_nodejs_metrics_state_values_for(arg_runtime_uid)\r\n\t{\r\n\t\tconst state_values = this.get_metrics_state_values('nodejs')\r\n\t\tconst state_rt_values = (arg_runtime_uid in state_values) ? state_values[arg_runtime_uid] : { runtime_uid:arg_runtime_uid }\r\n\t\t// console.log(state_rt_values, 'get_nodejs_metrics_state_values_for', arg_runtime_uid)\r\n\t\treturn state_rt_values\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/servers/metrics_server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 674,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/metrics_server.js",
    "static": true,
    "longname": "js/servers/metrics_server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/metrics_server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 15,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 675,
    "kind": "class",
    "name": "MetricsServer",
    "memberof": "js/servers/metrics_server.js",
    "static": true,
    "longname": "js/servers/metrics_server.js~MetricsServer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/metrics_server.js",
    "importStyle": "MetricsServer",
    "description": "",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Metrics server class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/servers/server.js~Server"
    ]
  },
  {
    "__docId__": 676,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#constructor",
    "access": null,
    "description": "Create MetricsServer instance to process metrics records.",
    "lineNumber": 36,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Server"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server instance name"
      },
      {
        "nullable": null,
        "types": [
          "Immutable.Map"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "server instance settings"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "logging context"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 677,
    "kind": "member",
    "name": "is_metric_server",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#is_metric_server",
    "access": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 678,
    "kind": "member",
    "name": "metrics_collectors",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#metrics_collectors",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "{}"
      ]
    }
  },
  {
    "__docId__": 679,
    "kind": "method",
    "name": "build_server",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#build_server",
    "access": null,
    "description": "Build server.",
    "lineNumber": 62,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 680,
    "kind": "method",
    "name": "receive_metrics",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#receive_metrics",
    "access": null,
    "description": "Process received metrics message (to override in sub classes).",
    "lineNumber": 80,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "DistributedMetrics"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_msg",
        "description": "metrics message instance."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 681,
    "kind": "method",
    "name": "process_metric",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#process_metric",
    "access": null,
    "description": "Process metrics records.\n\n{string} arg_metric_type - metrics type (host, http...)\n{array} arg_metrics - Array of metrics plain objects",
    "lineNumber": 108,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "name": "arg_metric_type",
        "types": [
          "*"
        ]
      },
      {
        "name": "arg_metrics",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 682,
    "kind": "method",
    "name": "get_metrics_state_values",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_metrics_state_values",
    "access": null,
    "description": "Get metrics state values.",
    "lineNumber": 137,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - http state object."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_type",
        "description": "metrics type."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "http state object."
    }
  },
  {
    "__docId__": 683,
    "kind": "method",
    "name": "get_http_metrics_state_values",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_http_metrics_state_values",
    "access": null,
    "description": "Get http metrics state values.",
    "lineNumber": 159,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - http state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "http state values object."
    }
  },
  {
    "__docId__": 684,
    "kind": "method",
    "name": "get_host_metrics_state_values",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_host_metrics_state_values",
    "access": null,
    "description": "Get host metrics state values.",
    "lineNumber": 173,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - host state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "host state values object."
    }
  },
  {
    "__docId__": 685,
    "kind": "method",
    "name": "get_host_metrics_state_values_items",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_host_metrics_state_values_items",
    "access": null,
    "description": "Get host metrics state values.",
    "lineNumber": 185,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - host state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "host state values object."
    }
  },
  {
    "__docId__": 686,
    "kind": "method",
    "name": "get_host_metrics_state_values_for",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_host_metrics_state_values_for",
    "access": null,
    "description": "Get host metrics state values for an hostname.",
    "lineNumber": 205,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - host state values object."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_hostname",
        "description": "hostname."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "host state values object."
    }
  },
  {
    "__docId__": 687,
    "kind": "method",
    "name": "get_bus_metrics_state_values",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_bus_metrics_state_values",
    "access": null,
    "description": "Get bus metrics state values.",
    "lineNumber": 220,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - bus state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "bus state values object."
    }
  },
  {
    "__docId__": 688,
    "kind": "method",
    "name": "get_bus_metrics_state_values_items",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_bus_metrics_state_values_items",
    "access": null,
    "description": "Get bus metrics state values.",
    "lineNumber": 232,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - bus state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "bus state values object."
    }
  },
  {
    "__docId__": 689,
    "kind": "method",
    "name": "get_bus_metrics_state_values_for",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_bus_metrics_state_values_for",
    "access": null,
    "description": "Get bus metrics state values for a bus name.",
    "lineNumber": 252,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - bus state values object."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_bus_name",
        "description": "bus name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "bus state values object."
    }
  },
  {
    "__docId__": 690,
    "kind": "method",
    "name": "get_nodejs_metrics_state_values",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_nodejs_metrics_state_values",
    "access": null,
    "description": "Get nodejs metrics state values.",
    "lineNumber": 267,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - nodejs state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "nodejs state values object."
    }
  },
  {
    "__docId__": 691,
    "kind": "method",
    "name": "get_nodejs_metrics_state_values_items",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_nodejs_metrics_state_values_items",
    "access": null,
    "description": "Get host metrics state values.",
    "lineNumber": 281,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - host state values object."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "host state values object."
    }
  },
  {
    "__docId__": 692,
    "kind": "method",
    "name": "get_nodejs_metrics_state_values_for",
    "memberof": "js/servers/metrics_server.js~MetricsServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/metrics_server.js~MetricsServer#get_nodejs_metrics_state_values_for",
    "access": null,
    "description": "Get nodejs metrics state values for a nodejs instance.",
    "lineNumber": 301,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Object} - nodejs state values object."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_runtime_uid",
        "description": "nodejs runtime uid."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Object"
      ],
      "spread": false,
      "description": "nodejs state values object."
    }
  },
  {
    "__docId__": 693,
    "kind": "file",
    "name": "js/servers/restify_server.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport restify from 'restify'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport RoutableServer from './routable_server'\r\nimport MetricsMiddleware from '../metrics/http/metrics_http_collector'\r\n\r\n\r\nlet context = 'server/servers/restify_server'\r\n\r\n\r\n\r\n/**\r\n * @file Restify server class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class RestifyServer extends RoutableServer\r\n{\r\n\t/**\r\n\t * Create Restify server instance.\r\n\t * @extends RoutableServer\r\n\t * \r\n\t * @param {string} arg_name - server name\r\n\t * @param {object} arg_settings - plugin settings map\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tsuper(arg_name, 'RestifyServer', arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_restify_server = true\r\n\t}\r\n\t\r\n\r\n\t\r\n\t/**\r\n\t * Build private server instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tbuild_server()\r\n\t{\r\n\t\tthis.enter_group('build_server')\r\n\t\t\r\n\t\tassert( this.server_protocole == 'http' || this.server_protocole == 'https', context + ':bad protocole for restify [' + this.server_protocole + ']')\r\n\t\t\r\n\t\t// CREATE REST SERVER\r\n\t\tconst server_settings = {}\r\n\t\tthis.server = restify.createServer(server_settings)\r\n\t\tlet server = this.server\r\n\r\n\t\t\r\n\t\t// METRICS MIDDLEWARE\r\n\t\tserver.use( MetricsMiddleware.create_middleware(this) )\r\n\r\n\r\n\t\t// USE ALL MIDDLEWARES WITHOUT SECURITY\r\n\t\tthis.services_without_security.forEach(\r\n\t\t\t(arg_record) => {\r\n\t\t\t\targ_record.svc.activate_on_server(arg_record.app, this, arg_record.cfg)\r\n\t\t\t}\r\n\t\t)\r\n\r\n\r\n\t\t// USE AUTHENTICATION MIDDLEWARES\r\n\t\tthis.authentication.apply_middlewares(this)\r\n\t\t\r\n\t\t\r\n\t\t// TODO: USE AUTHORIZATION MIDDLEWARE\r\n\t\t// this.server.use( this.authorization.create_middleware() )\r\n\t\t\r\n\r\n\t\t// USE ALL MIDDLEWARES WITH SECURITY\r\n\t\tthis.services_with_security.forEach(\r\n\t\t\t(arg_record) => {\r\n\t\t\t\targ_record.svc.activate_on_server(arg_record.app, this, arg_record.cfg)\r\n\t\t\t}\r\n\t\t)\r\n        \r\n\t\t\r\n\t\t// TODO: LOAD MIDDLEWARES FROM SETTINGS\r\n\t\t\r\n\t\t\r\n\t\t// SET MIDDLEWARES\r\n\t\tconst throttle_settings = {\r\n\t\t\tburst: 100,\r\n\t\t\trate: 50,\r\n\t\t\tip: true,\r\n\t\t\toverrides: {\r\n\t\t\t\t'192.168.1.1': {\r\n\t\t\t\t\trate: 0,        // unlimited\r\n\t\t\t\t\tburst: 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// var acceptable = server.acceptable.concat(['application/x-es-module */*', 'application/x-es-module']);\r\n\t\t// console.log(acceptable, 'acceptable');\r\n\t\t// server.use(restify.acceptParser(acceptable));\r\n\t\tserver.use( restify.acceptParser(server.acceptable) )\r\n\t\t\r\n\t\tserver.use( restify.authorizationParser()) \r\n\t\tserver.use( restify.queryParser() )\r\n\t\tserver.use( restify.jsonp() )\r\n\t\tserver.use( restify.gzipResponse() )\r\n\t\tserver.use( restify.bodyParser() )\r\n\t\tserver.use( restify.requestLogger() )\r\n\t\tserver.use( restify.throttle(throttle_settings) )\r\n\t\t\r\n        \r\n\t\t// ERROR HANDLING\r\n\t\tserver.on('InternalServerError',\r\n\t\t\tfunction (req, res, err, cb)\r\n\t\t\t{\r\n\t\t\t\tconsole.error(err, 'Internal server error');\r\n\t\t\t\terr._customContent = 'something is wrong!';\r\n\t\t\t\treturn cb();\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n        \r\n\t\t// ENABLE / DISABLE AUDIT LOGS\r\n\t\t// const audit_settings = {\r\n\t\t// \tlog: bunyan.createLogger(\r\n\t\t// \t\t{\r\n\t\t// \t\t\tname: 'audit',\r\n\t\t// \t\t\tstream: process.stdout\r\n\t\t// \t\t}\r\n\t\t// \t)\r\n\t\t// }\r\n\t\t// server.on('after', restify.auditLogger(audit_settings) )\r\n\t\t\r\n\t\t\r\n\t\t// SET URL\r\n\t\tthis.server_url = this.server_protocole + '//' + this.server_host + ':' + this.server_port\r\n\t\t\r\n\t\t\r\n\t\tthis.leave_group('build_server')\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for static route.\r\n\t * \r\n     * @param {object} arg_cfg_route - plain object route configuration.\r\n\t * \r\n\t * @returns {middleware} - middleware function as f(req, res, next)\r\n\t */\r\n\tget_middleware_for_static_route(arg_cfg_route)\r\n\t{\r\n\t\t// DEBUG\r\n\t\tconsole.log(context + ':get_middleware_for_static_route:express static route', arg_cfg_route)\r\n\r\n\t\tconst cb_arg = {\r\n\t\t\tdirectory: arg_cfg_route.directory\r\n\t\t}\r\n\r\n\t\tif ( T.isString(arg_cfg_route.default_file) )\r\n\t\t{\r\n\t\t\tcb_arg.default = arg_cfg_route.default_file\r\n\t\t}\r\n\r\n\t\t// DEBUG\r\n\t\t// console.log(cb_arg, 'restify route cfg')\r\n\t\t// console.log('restify static route', arg_cfg_route.directory)\r\n\t\t\r\n\t\treturn restify.serveStatic(cb_arg)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for directory route.\r\n\t * \r\n     * @param {object}   arg_cfg_route - plain object route configuration.\r\n\t * @param {function} arg_callback - route handler callback.\r\n\t * \r\n\t * @returns {boolean} - success or failure.\r\n\t */\r\n\tadd_get_route(arg_cfg_route, arg_callback)\r\n\t{\r\n\t\tthis.enter_group('add_get_route')\r\n\r\n\t\tassert( T.isObject(arg_cfg_route), this.get_context() + '::bad route config object')\r\n\t\tassert( T.isString(arg_cfg_route.full_route), this.get_context() + '::bad route config full_route string')\r\n\t\tassert( T.isFunction(arg_callback), this.get_context() + '::bad string')\r\n\r\n\t\t// CHECK EXPRESS SERVER\r\n\t\tif ( ! this.server || ! T.isFunction(this.server.use) )\r\n\t\t{\r\n\t\t\tthis.leave_group('add_get_route:bad server error')\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tthis.server.get(arg_cfg_route.full_route, arg_callback)\r\n\t\t\r\n\t\tthis.leave_group('add_get_route')\r\n\t\treturn true\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/servers/restify_server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 694,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/restify_server.js",
    "static": true,
    "longname": "js/servers/restify_server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/restify_server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 695,
    "kind": "class",
    "name": "RestifyServer",
    "memberof": "js/servers/restify_server.js",
    "static": true,
    "longname": "js/servers/restify_server.js~RestifyServer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/restify_server.js",
    "importStyle": "RestifyServer",
    "description": "",
    "lineNumber": 22,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Restify server class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/servers/routable_server.js~RoutableServer"
    ]
  },
  {
    "__docId__": 696,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#constructor",
    "access": null,
    "description": "Create Restify server instance.",
    "lineNumber": 34,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "RoutableServer"
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server name"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "plugin settings map"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 697,
    "kind": "member",
    "name": "is_restify_server",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#is_restify_server",
    "access": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 698,
    "kind": "method",
    "name": "build_server",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#build_server",
    "access": null,
    "description": "Build private server instance.",
    "lineNumber": 48,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 699,
    "kind": "member",
    "name": "server",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#server",
    "access": null,
    "description": null,
    "lineNumber": 56,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 700,
    "kind": "member",
    "name": "server_url",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#server_url",
    "access": null,
    "description": null,
    "lineNumber": 142,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 701,
    "kind": "method",
    "name": "get_middleware_for_static_route",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#get_middleware_for_static_route",
    "access": null,
    "description": "Get server middleware for static route.",
    "lineNumber": 157,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{middleware} - middleware function as f(req, res, next)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "middleware"
      ],
      "spread": false,
      "description": "middleware function as f(req, res, next)"
    }
  },
  {
    "__docId__": 702,
    "kind": "method",
    "name": "add_get_route",
    "memberof": "js/servers/restify_server.js~RestifyServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/restify_server.js~RestifyServer#add_get_route",
    "access": null,
    "description": "Get server middleware for directory route.",
    "lineNumber": 188,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - success or failure."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      },
      {
        "nullable": null,
        "types": [
          "function"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_callback",
        "description": "route handler callback."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "success or failure."
    }
  },
  {
    "__docId__": 703,
    "kind": "file",
    "name": "js/servers/routable_server.js",
    "content": "// NPM IMPORTS\r\n// import assert from 'assert'\r\n// import { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\n// import T           from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport Server from './server'\r\n\r\n\r\nconst context = 'server/servers/routable_server'\r\n\r\n\r\n\r\n/**\r\n * @file Server base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class RoutableServer extends Server\r\n{\r\n\t/**\r\n\t * Base class for a routable server instance.\r\n\t * @extends Server\r\n\t * \r\n\t * \tAPI:\r\n\t * \t\t->constructor(arg_name, arg_class, arg_settings, arg_log_context=context)\r\n\t * \r\n\t * \t\t->load():nothing - Load server settings.\r\n\t * \r\n\t * \t\t->enable():nothing - Enable server (start it).\r\n\t * \t\t->disable():nothing - Disable server (stop it).\r\n\t * \r\n\t * \t\t->get_middleware_for_static_route():middleware - Get server middleware for static route.\r\n\t * \r\n\t * \t\t->add_get_route(arg_cfg_route, arg_callback):boolean - Get server middleware for directory route.\r\n\t * \r\n\t * @param {string} arg_name - server name.\r\n\t * @param {string} arg_class - server class name.\r\n\t * @param {object} arg_settings - plugin settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_class, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\tsuper(arg_name, arg_class, arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_routable_server = true\r\n\t}\r\n\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Enable server (start it).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tenable()\r\n\t{\r\n\t\tsuper.enable()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Disable server (stop it).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tdisable()\r\n\t{\r\n\t\tsuper.disable()\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for static route.\r\n\t * \r\n     * @param {object} arg_cfg_route - plain object route configuration.\r\n\t * \r\n\t * @returns {middleware} - middleware function as f(req, res, next)\r\n\t */\r\n\tget_middleware_for_static_route()\r\n\t{\r\n\t\treturn (req, res, next)=>{ return next ? next() :undefined }\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get server middleware for directory route.\r\n\t * \r\n     * @param {object}   arg_cfg_route - plain object route configuration.\r\n\t * @param {function} arg_callback - route handler callback.\r\n\t * \r\n\t * @returns {boolean} - success or failure.\r\n\t */\r\n\tadd_get_route(/*arg_cfg_route, arg_callback*/)\r\n\t{\r\n\t\treturn false\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/servers/routable_server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 704,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/routable_server.js",
    "static": true,
    "longname": "js/servers/routable_server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/routable_server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 705,
    "kind": "class",
    "name": "RoutableServer",
    "memberof": "js/servers/routable_server.js",
    "static": true,
    "longname": "js/servers/routable_server.js~RoutableServer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/routable_server.js",
    "importStyle": "RoutableServer",
    "description": "",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Server base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/servers/server.js~Server"
    ]
  },
  {
    "__docId__": 706,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#constructor",
    "access": null,
    "description": "Base class for a routable server instance.",
    "lineNumber": 46,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "Server\n\n\tAPI:\n\t\t->constructor(arg_name, arg_class, arg_settings, arg_log_context=context)\n\n\t\t->load():nothing - Load server settings.\n\n\t\t->enable():nothing - Enable server (start it).\n\t\t->disable():nothing - Disable server (stop it).\n\n\t\t->get_middleware_for_static_route():middleware - Get server middleware for static route.\n\n\t\t->add_get_route(arg_cfg_route, arg_callback):boolean - Get server middleware for directory route."
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class",
        "description": "server class name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "plugin settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 707,
    "kind": "member",
    "name": "is_routable_server",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#is_routable_server",
    "access": null,
    "description": null,
    "lineNumber": 50,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 708,
    "kind": "method",
    "name": "enable",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#enable",
    "access": null,
    "description": "Enable server (start it).",
    "lineNumber": 61,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 709,
    "kind": "method",
    "name": "disable",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#disable",
    "access": null,
    "description": "Disable server (stop it).",
    "lineNumber": 73,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 710,
    "kind": "method",
    "name": "get_middleware_for_static_route",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#get_middleware_for_static_route",
    "access": null,
    "description": "Get server middleware for static route.",
    "lineNumber": 87,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{middleware} - middleware function as f(req, res, next)"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "middleware"
      ],
      "spread": false,
      "description": "middleware function as f(req, res, next)"
    }
  },
  {
    "__docId__": 711,
    "kind": "method",
    "name": "add_get_route",
    "memberof": "js/servers/routable_server.js~RoutableServer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/routable_server.js~RoutableServer#add_get_route",
    "access": null,
    "description": "Get server middleware for directory route.",
    "lineNumber": 102,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{boolean} - success or failure."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_cfg_route",
        "description": "plain object route configuration."
      },
      {
        "nullable": null,
        "types": [
          "function"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_callback",
        "description": "route handler callback."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "boolean"
      ],
      "spread": false,
      "description": "success or failure."
    }
  },
  {
    "__docId__": 712,
    "kind": "file",
    "name": "js/servers/server.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport { fromJS } from 'immutable'\r\n\r\n// COMMON IMPORTS\r\nimport T                   from 'devapt-core-common/dist/js/utils/types'\r\nimport DistributedInstance from 'devapt-core-common/dist/js/base/distributed_instance'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../base/runtime'\r\nimport AuthenticationWrapper from '../security/authentication_wrapper'\r\n\r\n\r\nconst context = 'server/servers/server'\r\n\r\n\r\n\r\n/**\r\n * Type of servers.\r\n * @public\r\n */\r\nexport const ServerTypes = {\r\n\tSERVER_TYPE_EXPRESS : 'express',\r\n\tSERVER_TYPE_RESTIFY : 'restify',\r\n\tSERVER_TYPE_SOCKETIO : 'socketio',\r\n\tSERVER_TYPE_FEATHER : 'feather',\r\n\tSERVER_TYPE_CLUSTER : 'cluster',\r\n\tSERVER_TYPE_LOGS : 'logs',\r\n\tSERVER_TYPE_METRICS : 'metrics'\r\n}\r\n\r\n\r\n/**\r\n * @file Server base class.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class Server extends DistributedInstance\r\n{\r\n\t/**\r\n\t * Create a server instance.\r\n\t * @extends DistributedInstance\r\n\t * \r\n\t * \tAPI:\r\n\t * \t\t->constructor(arg_name, arg_class, arg_settings, arg_log_context=context)\r\n\t * \r\n\t * \t\t->use_service_on_loading(arg_application, arg_service, arg_app_svc_cfg = {}):nothing - Add a service to use before or after security check.\r\n\t * \t\t\r\n\t * \t\t->get_server_security_settings():object - Get security settings object into the server.\r\n\t * \t\t->get_security_settings():Immutable.Map - Get security settings from server or runtime.\r\n\t * \r\n\t * \t\t->load():nothing - Load server settings.\r\n\t * \r\n\t * \t\t->enable():nothing - Enable server (start it).\r\n\t * \t\t->disable():nothing - Disable server (stop it).\r\n\t * \r\n\t * \t\t->get_topology_info(arg_deep=true, arg_visited={}):object - Get topology item informations.\r\n\t * \r\n\t * @param {string} arg_name - server name.\r\n\t * @param {string} arg_class - server class name.\r\n\t * @param {object} arg_settings - plugin settings map.\r\n\t * @param {string} arg_log_context - trace context string.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_name, arg_class, arg_settings, arg_log_context=context)\r\n\t{\r\n\t\t\r\n\t\t// DEBUG STORE\r\n\t\t// console.log(store, 'store')\r\n\t\t// console.log(config, 'config')\r\n\t\t\r\n\t\tif (! T.isObject(arg_settings))\r\n\t\t{\r\n\t\t\tconsole.error(arg_class, arg_name, arg_settings, arg_log_context, 'arg_class, arg_name, arg_settings, arg_context')\r\n\t\t}\r\n\t\tsuper('servers', arg_name, (arg_class ? arg_class.toString() : 'Server'), arg_settings, arg_log_context)\r\n\t\t\r\n\t\tthis.is_server = true\r\n\t\tthis.is_build = false\r\n\t\t\r\n\t\tthis.server_host = undefined\r\n\t\tthis.server_port = undefined\r\n\t\tthis.server_protocole = undefined\r\n\t\tthis.server_type = undefined\r\n\t\t\r\n\t\tthis.server = undefined\r\n\t\tthis.server_http = undefined\r\n\t\tthis.serverio = undefined\r\n\t\t\r\n\t\tthis.services_without_security = [] // STORE PLAIN OBJECTS WITH THIS FORMAT: { app:application instance, svc:service instance, cfg:application service config }\r\n\t\tthis.services_with_security = [] // STORE PLAIN OBJECTS WITH THIS FORMAT: { app:application instance, svc:service instance, cfg:application service config }\r\n\t\t\r\n\t\tthis.authentication = new AuthenticationWrapper(arg_log_context, this.get_logger_manager())\r\n\t\t// this.authorization = new AuthorizationWrapper(arg_log_context ? arg_log_context : context)\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Add a service to use before or after security check.\r\n\t * \r\n\t * @param {Application}\targ_application\r\n\t * @param {Service}\t\targ_service\r\n\t * @param {object}\t\targ_app_svc_cfg (default:{})\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tuse_service_on_loading(arg_application, arg_service, arg_app_svc_cfg = {})\r\n\t{\r\n\t\tassert( T.isObject(arg_application) && arg_application.is_topology_define_application, context + ':bad application object')\r\n\t\tassert( T.isObject(arg_service) && arg_service.is_service, context + ':bad service object')\r\n\t\tassert( T.isObject(arg_app_svc_cfg) , context + ':bad application service config object')\r\n\r\n\t\tthis.info('use_service_on_loading:service=' + arg_service.get_name())\r\n\r\n\t\tconst security_enabled = arg_service.get_setting(['security', 'enabled'], true)\r\n\t\tconst authentication_enabled = arg_service.get_setting(['security', 'authentication', 'enabled'], true)\r\n\t\tconst authorization_enabled = arg_service.get_setting(['security', 'authorization', 'enabled'], true)\r\n\t\tconst use_security_check = security_enabled ? (authentication_enabled || authorization_enabled) : false\r\n\r\n\t\tconst record = {\r\n\t\t\tapp:arg_application,\r\n\t\t\tsvc:arg_service,\r\n\t\t\tcfg:arg_app_svc_cfg\r\n\t\t}\r\n\r\n\t\tif (use_security_check)\r\n\t\t{\r\n\t\t\tthis.services_with_security.push(record)\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.services_without_security.push(record)\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Get security settings object into the server.\r\n\t * \r\n\t * @returns {object} - security settings.\r\n\t */\r\n\tget_server_security_settings()\r\n\t{\r\n\t\tthis.enter_group('get_server_security_settings')\r\n\t\t\r\n\t\tconst security_settings = this.get_setting('security', null)\r\n\t\t\r\n\t\tthis.leave_group('get_server_security_settings')\r\n\t\treturn security_settings\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get security settings from server or runtime.\r\n\t * \r\n\t * @returns {Immutable.Map} - security settings.\r\n\t */\r\n\tget_security_settings()\r\n\t{\r\n\t\tconst self = this\r\n\t\tself.enter_group('get_security_settings')\r\n\t\t\r\n\t\t// DEFAULT SECURITY SETTINGS\r\n\t\tconst default_security = {\r\n\t\t\t'authentication': {\r\n\t\t\t\t'enabled': true,\r\n\t\t\t\t'plugins': []\r\n\t\t\t},\r\n\t\t\t'authorization': {\r\n\t\t\t\t'enabled': true,\r\n\t\t\t\t'plugins': []\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// TARGET SECURITY SETTINGS\r\n\t\tlet security_settings = fromJS(default_security)\r\n\t\t\r\n\t\t// GET SERVER SECURITY SETTINGS\r\n\t\t// console.log(context + '.get_security_settings', this.get_name(), this.$settings)\r\n\t\tlet srv_security_settings = self.get_setting('security', null)\r\n\t\t// console.log(context + '.get_security_settings:srv_security_settings', srv_security_settings)\r\n\t\t// assert( T.isObject(srv_security_settings), context + ':bad srv_security_settings object')\r\n\t\t\r\n\t\tif ( srv_security_settings && ! T.isFunction(srv_security_settings.has) )\r\n\t\t{\r\n\t\t\tsrv_security_settings = fromJS(srv_security_settings)\r\n\t\t}\r\n\t\t\r\n\t\tif ( srv_security_settings && srv_security_settings.has('authentication') )\r\n\t\t{\r\n\t\t\t// AUTHENTICATION IS ENABLED ?\r\n\t\t\tconst auth_is_enabled = srv_security_settings.getIn(['authentication', 'enabled'], false)\r\n\t\t\tif (! auth_is_enabled)\r\n\t\t\t{\r\n\t\t\t\t// self.error('get_security_settings:bad server.settings.security.authentication.enabled')\r\n\t\t\t\t// self.leave_group('get_security_settings:from server with error')\r\n\t\t\t\tself.leave_group('get_security_settings:from server with disabled authentication')\r\n\t\t\t\treturn security_settings\r\n\t\t\t}\r\n\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'enabled'], auth_is_enabled)\r\n\t\t\t\r\n\t\t\t/*if ( srv_security_settings.hasIn(['authentication', 'enabled']) )\r\n\t\t\t{\r\n\t\t\t\tconst enabled = srv_security_settings.getIn(['authentication', 'enabled'])\r\n\t\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'enabled'], enabled)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// self.error('get_security_settings:bad server.settings.security.authentication.enabled')\r\n\t\t\t\t// self.leave_group('get_security_settings:from server with error')\r\n\t\t\t\tself.leave_group('get_security_settings:from server with disabled authentication')\r\n\t\t\t\treturn security_settings\r\n\t\t\t}*/\r\n\t\t\t\r\n\t\t\t// AUTHENTICATION PLUGINS\r\n\t\t\tif ( srv_security_settings.hasIn(['authentication', 'plugins']) )\r\n\t\t\t{\r\n\t\t\t\tconst plugins = srv_security_settings.getIn(['authentication', 'plugins'])\r\n\t\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'plugins'], plugins.toArray())\r\n\t\t\t\tif (plugins.size == 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.error('bad server.settings.security.authentication.plugins.size')\r\n\t\t\t\t\tself.leave_group('get_security_settings:from server with error')\r\n\t\t\t\t\treturn security_settings\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tself.error('get_security_settings:bad server.settings.security.authentication.plugins')\r\n\t\t\t\tself.leave_group('get_security_settings:from server with error')\r\n\t\t\t\treturn security_settings\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// console.log(context + '.get_security_settings:from server:security_settings', security_settings)\r\n\t\t\tself.leave_group('get_security_settings:from server')\r\n\t\t\treturn security_settings\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t// GET RUNTIME SECURITY SETTINGS\r\n\t\tconst rt_security_settings = runtime.get_registry().root.get('security')\r\n\t\tassert( T.isObject(rt_security_settings) && rt_security_settings.has, context + ':bad rt_security_settings object')\r\n\t\t\r\n\t\tif ( rt_security_settings.has('enabled') )\r\n\t\t{\r\n\t\t\tconst enabled = rt_security_settings.get('enabled')\r\n\t\t\tsecurity_settings = security_settings.set('enabled', enabled)\r\n\t\t} else {\r\n\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'enabled'], false)\r\n\t\t\tself.warn('get_security_settings:security is disabled')\r\n\t\t\tself.leave_group('get_security_settings:security is disabled')\r\n\t\t\treturn security_settings\r\n\t\t}\r\n\t\t// else\r\n\t\t// {\r\n\t\t// \tself.error('get_security_settings:bad runtime.settings.security.enabled')\r\n\t\t// \tself.leave_group('get_security_settings:from runtime with error')\r\n\t\t// \treturn security_settings\r\n\t\t// }\r\n\t\t\r\n\t\t// GET RUNTIME AUTHENTICATION SECURITY SETTINGS\r\n\t\tif ( rt_security_settings && rt_security_settings.has('authentication') )\r\n\t\t{\r\n\t\t\t// AUTHENTICATION IS ENABLED ?\r\n\t\t\tif ( rt_security_settings.hasIn(['authentication', 'enabled']) )\r\n\t\t\t{\r\n\t\t\t\tconst enabled = rt_security_settings.getIn(['authentication', 'enabled'])\r\n\t\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'enabled'], enabled)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tself.error('get_security_settings:bad runtime.settings.security.authentication.enabled')\r\n\t\t\t\tself.leave_group('get_security_settings:from runtime with error')\r\n\t\t\t\treturn security_settings\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// AUTHENTICATION PLUGINS\r\n\t\t\tif ( rt_security_settings.hasIn(['authentication', 'default_plugins']) )\r\n\t\t\t{\r\n\t\t\t\tconst plugins = rt_security_settings.getIn(['authentication', 'default_plugins'])\r\n\t\t\t\tsecurity_settings = security_settings.setIn(['authentication', 'plugins'], plugins.toArray())\r\n\t\t\t\tif (plugins.size == 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.error('bad runtime.settings.security.authentication.plugins.size')\r\n\t\t\t\t\tself.leave_group('get_security_settings:from runtime with error')\r\n\t\t\t\t\treturn security_settings\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tself.error('get_security_settings:bad runtime.settings.security.authentication.default_plugins')\r\n\t\t\t\tself.leave_group('get_security_settings:from runtime with error')\r\n\t\t\t\treturn security_settings\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tself.leave_group('get_security_settings:from runtime')\r\n\t\t\treturn security_settings\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// console.error(context + ':no security settings found')\r\n\t\tself.error(context + ':no security settings found')\r\n\t\tself.leave_group('get_security_settings:not found')\r\n\t\treturn null\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Load server settings.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tload()\r\n\t{\r\n\t\tthis.enter_group('load')\r\n\t\t\r\n\t\tassert( T.isObject(this.$settings) && T.isFunction(this.$settings.has), context + ':bad settings object')\r\n\t\t\r\n\t\tconst cfg = runtime.get_registry().root\r\n\t\t\r\n\t\t// SET SERVER HOST\r\n\t\tthis.server_host = this.$settings.has('host') ? this.$settings.get('host') : null\r\n\t\tif ( ! this.server_host && cfg.hasIn(['servers', 'default', 'host']) )\r\n\t\t{\r\n\t\t\tthis.server_host = cfg.getIn(['servers', 'default', 'host'])\r\n\t\t}\r\n\t\tassert( T.isString(this.server_host), context + ':bad server host string:[' + this.server_host + ']')\r\n\t\t\r\n\t\t// SET SERVER PORT\r\n\t\tthis.server_port = this.$settings.has('port') ? this.$settings.get('port') : null\r\n\t\tif ( ! this.server_port && cfg.hasIn(['servers', 'default', 'port']) )\r\n\t\t{\r\n\t\t\tthis.server_port = cfg.getIn(['servers', 'default', 'port'])\r\n\t\t}\r\n\t\tassert( T.isString(this.server_port) || T.isNumber(this.server_port), context + ':bad server port string|number:[' + this.server_port + ']')\r\n\t\t\r\n\t\t// SET SERVER PROTOCOLE\r\n\t\tthis.server_protocole = this.$settings.has('protocole') ? this.$settings.get('protocole') : null\r\n\t\tif ( ! this.server_protocole && cfg.hasIn(['servers', 'default', 'protocole']) )\r\n\t\t{\r\n\t\t\tthis.server_protocole = cfg.getIn(['servers', 'default', 'protocole'])\r\n\t\t}\r\n\t\tassert( T.isString(this.server_protocole), context + ':bad server protocole string:[' + this.server_protocole + ']')\r\n\t\t\r\n\t\t// SET SERVER TYPE\r\n\t\tthis.server_type = this.$settings.has('type') ? this.$settings.get('type') : null\r\n\t\tif ( ! this.server_type && cfg.hasIn(['servers', 'default', 'type']) )\r\n\t\t{\r\n\t\t\tthis.server_type = cfg.getIn(['servers', 'default', 'type'])\r\n\t\t}\r\n\t\tassert( T.isString(this.server_type), context + ':bad server type string:[' + this.server_type + ']')\r\n\t\t\r\n\t\t// SECURITY (could be null for Bus Server...)\r\n\t\tconst security_settings = this.get_security_settings()\r\n\t\t// console.log(context + '.load:security_settings', security_settings)\r\n\t\t\r\n\t\t// AUTHENTICATION\r\n\t\tif ( security_settings && security_settings.hasIn(['authentication', 'enabled']) && security_settings.hasIn(['authentication', 'plugins']) )\r\n\t\t{\r\n\t\t\tlet auth_settings = security_settings.get('authentication')\r\n\t\t\tauth_settings = auth_settings.set('runtime', this.get_runtime())\r\n\t\t\tauth_settings = auth_settings.set('logger_manager', this.get_logger_manager())\r\n\t\t\tthis.authentication.load(auth_settings)\r\n\t\t}\r\n\t\t\r\n\t\t// AUTHORIZATION\r\n\t\t// TODO\r\n\t\t\r\n\t\t// PARENT CLASS LOADING\r\n\t\tsuper.load()\r\n\t\t\r\n\t\t// SUBSCRIBE TO MESSAGES BUS\r\n\t\tthis.enable_msg()\r\n\r\n\t\tthis.leave_group('load')\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Build private server instance.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tbuild_server()\r\n\t{\r\n\t\t// NOTHING TO DO HERE\r\n\t}\r\n\r\n\t\r\n\t\r\n\t/**\r\n\t * Enable server (start it).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tenable()\r\n\t{\r\n\t\t// BUILD SERVER\r\n\t\tif ( ! this.is_build)\r\n\t\t{\r\n\t\t\tassert( T.isFunction(this.build_server), context + ':bad build_server function')\r\n\t\t\tthis.build_server()\r\n\t\t\tthis.is_build = true\r\n\t\t}\r\n\r\n\t\t// ENABLE LISTENER\r\n\t\tconst name = this.$name\r\n\t\tconst host = this.server_host\r\n\t\tconst port = this.server_port\r\n\t\t\r\n\t\tlet should_listen = true\r\n\t\t\r\n\t\t// ENABLE LAST LOADING/ACTIONS: ERROR HANDLING...\r\n\t\tif ( T.isFunction(this.finaly) )\r\n\t\t{\r\n\t\t\tthis.finaly()\r\n\t\t}\r\n\t\t\r\n\t\t// ENABLE LISTENER TRACE\r\n\t\tif (should_listen)\r\n\t\t{\r\n\t\t\tconst srv = this.server_http ? this.server_http : this.server\r\n\t\t\tif ( srv && T.isFunction(srv.listen) )\r\n\t\t\t{\r\n\t\t\t\tsrv.listen(this.server_port,\r\n\t\t\t\t\tfunction()\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.info('%s listening at %s : %s', name, host, port)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Disable server (stop it).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tdisable()\r\n\t{\r\n\t\t// NOTHING TO DO HERE\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Get topology item informations.\r\n\t * \r\n\t * @param {boolean} arg_deep - get deep sub items information on true (default:false).\r\n\t * @param {object} arg_visited - visited items plain object map.\r\n\t * \r\n\t * @returns {object} - topology informations (plain object).\r\n\t */\r\n\tget_topology_info(arg_deep=true, arg_visited={})\r\n\t{\r\n\t\tconst info = {\r\n\t\t\tname:this.get_name(),\r\n\t\t\tuid_desc:'N/A',\r\n\t\t\tuid:'N/A',\r\n\r\n\t\t\ttenant:'N/A',\r\n\t\t\tpackage:'N/A',\r\n\t\t\tversion:'N/A',\r\n\t\t\t\r\n\t\t\ttype:'server',\r\n\t\t\tsecurity:'N/A',\r\n\t\t\t\r\n\t\t\tchildren:['N/A']\r\n\t\t}\r\n\r\n\t\tif ( arg_visited && (this.topology_uid in arg_visited) )\r\n\t\t{\r\n\t\t\treturn Object.assign(info, { note:'already dumped' } )\r\n\t\t}\r\n\r\n\t\targ_visited[this.topology_uid] = info\r\n\r\n\t\treturn info\r\n\t}\r\n}\r\n\r\n/*\r\nhttps://engineering.gosquared.com/making-dashboard-faster\r\nfunction parallel(middlewares) {\r\n  return function (req, res, next) {\r\n    async.each(middlewares, function (mw, cb) {\r\n      mw(req, res, cb);\r\n    }, next);\r\n  };\r\n}\r\n\r\napp.use(parallel([\r\n  getUser,\r\n  getSiteList,\r\n  getCurrentSite,\r\n  getSubscription\r\n]));\r\n\r\n\r\n\t\tconst has_cluster = this.$settings.has('workers')\r\n\t\t\r\n\t\t// CLUSTER\r\n\t\tif (has_cluster)\r\n\t\t{\r\n\t\t\tvar cluster = require('cluster');\r\n\t\t\tvar numCPUs = require('os').cpus().length;\r\n\t\t\t\r\n\t\t\t// const workers = this.$settings.get('workers')\r\n\t\t\t// const min_workers = this.workers.min || 1;\r\n\t\t\t// const max_workers = this.workers.max || 3;\r\n\t\t\t// const method_workers = this.workers.method || 'roundrobin';\r\n\t\t\t\r\n\t\t\tshould_listen = ! cluster.isMaster\r\n\t\t\t\r\n\t\t\tif (cluster.isMaster)\r\n\t\t\t{\r\n\t\t\t\t// Fork workers.\r\n\t\t\t\tfor(var i = 0; i < numCPUs; i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tcluster.fork()\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tcluster.on('exit',\r\n\t\t\t\t\tfunction(worker, code, signal)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconsole.log('worker ' + worker.process.pid + ' died')\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n*/",
    "static": true,
    "longname": "js/servers/server.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 713,
    "kind": "variable",
    "name": "context",
    "memberof": "js/servers/server.js",
    "static": true,
    "longname": "js/servers/server.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/servers/server.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 714,
    "kind": "variable",
    "name": "ServerTypes",
    "memberof": "js/servers/server.js",
    "static": true,
    "longname": "js/servers/server.js~ServerTypes",
    "access": "public",
    "export": true,
    "importPath": "devapt-core-doc/js/servers/server.js",
    "importStyle": "{ServerTypes}",
    "description": "Type of servers.",
    "lineNumber": 22,
    "type": {
      "types": [
        "{\"SERVER_TYPE_EXPRESS\": string, \"SERVER_TYPE_RESTIFY\": string, \"SERVER_TYPE_SOCKETIO\": string, \"SERVER_TYPE_FEATHER\": string, \"SERVER_TYPE_CLUSTER\": string, \"SERVER_TYPE_LOGS\": string, \"SERVER_TYPE_METRICS\": string}"
      ]
    }
  },
  {
    "__docId__": 715,
    "kind": "class",
    "name": "Server",
    "memberof": "js/servers/server.js",
    "static": true,
    "longname": "js/servers/server.js~Server",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/servers/server.js",
    "importStyle": "Server",
    "description": "",
    "lineNumber": 38,
    "unknown": [
      {
        "tagName": "@file",
        "tagValue": "Server base class."
      },
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/base/distributed_instance~DistributedInstance"
    ]
  },
  {
    "__docId__": 716,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#constructor",
    "access": null,
    "description": "Create a server instance.",
    "lineNumber": 66,
    "unknown": [
      {
        "tagName": "@extends",
        "tagValue": "DistributedInstance\n\n\tAPI:\n\t\t->constructor(arg_name, arg_class, arg_settings, arg_log_context=context)\n\n\t\t->use_service_on_loading(arg_application, arg_service, arg_app_svc_cfg = {}):nothing - Add a service to use before or after security check.\n\t\t\n\t\t->get_server_security_settings():object - Get security settings object into the server.\n\t\t->get_security_settings():Immutable.Map - Get security settings from server or runtime.\n\n\t\t->load():nothing - Load server settings.\n\n\t\t->enable():nothing - Enable server (start it).\n\t\t->disable():nothing - Disable server (stop it).\n\n\t\t->get_topology_info(arg_deep=true, arg_visited={}):object - Get topology item informations."
      },
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_name",
        "description": "server name."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_class",
        "description": "server class name."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_settings",
        "description": "plugin settings map."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_log_context",
        "description": "trace context string."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 717,
    "kind": "member",
    "name": "is_server",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#is_server",
    "access": null,
    "description": null,
    "lineNumber": 79,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 718,
    "kind": "member",
    "name": "is_build",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#is_build",
    "access": null,
    "description": null,
    "lineNumber": 80,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 719,
    "kind": "member",
    "name": "server_host",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_host",
    "access": null,
    "description": null,
    "lineNumber": 82,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 720,
    "kind": "member",
    "name": "server_port",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_port",
    "access": null,
    "description": null,
    "lineNumber": 83,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 721,
    "kind": "member",
    "name": "server_protocole",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_protocole",
    "access": null,
    "description": null,
    "lineNumber": 84,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 722,
    "kind": "member",
    "name": "server_type",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_type",
    "access": null,
    "description": null,
    "lineNumber": 85,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 723,
    "kind": "member",
    "name": "server",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server",
    "access": null,
    "description": null,
    "lineNumber": 87,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 724,
    "kind": "member",
    "name": "server_http",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_http",
    "access": null,
    "description": null,
    "lineNumber": 88,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 725,
    "kind": "member",
    "name": "serverio",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#serverio",
    "access": null,
    "description": null,
    "lineNumber": 89,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 726,
    "kind": "member",
    "name": "services_without_security",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#services_without_security",
    "access": null,
    "description": null,
    "lineNumber": 91,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 727,
    "kind": "member",
    "name": "services_with_security",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#services_with_security",
    "access": null,
    "description": null,
    "lineNumber": 92,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 728,
    "kind": "member",
    "name": "authentication",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#authentication",
    "access": null,
    "description": null,
    "lineNumber": 94,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 729,
    "kind": "method",
    "name": "use_service_on_loading",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#use_service_on_loading",
    "access": null,
    "description": "Add a service to use before or after security check.",
    "lineNumber": 109,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Application"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_application",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "Service"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_service",
        "description": ""
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_app_svc_cfg",
        "description": "(default:{})"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 730,
    "kind": "method",
    "name": "get_server_security_settings",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#get_server_security_settings",
    "access": null,
    "description": "Get security settings object into the server.",
    "lineNumber": 144,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - security settings."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "security settings."
    }
  },
  {
    "__docId__": 731,
    "kind": "method",
    "name": "get_security_settings",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#get_security_settings",
    "access": null,
    "description": "Get security settings from server or runtime.",
    "lineNumber": 161,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Immutable.Map} - security settings."
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "Immutable.Map"
      ],
      "spread": false,
      "description": "security settings."
    }
  },
  {
    "__docId__": 732,
    "kind": "method",
    "name": "load",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#load",
    "access": null,
    "description": "Load server settings.",
    "lineNumber": 318,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 733,
    "kind": "member",
    "name": "server_host",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_host",
    "access": null,
    "description": null,
    "lineNumber": 327,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 734,
    "kind": "member",
    "name": "server_host",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_host",
    "access": null,
    "description": null,
    "lineNumber": 330,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 735,
    "kind": "member",
    "name": "server_port",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_port",
    "access": null,
    "description": null,
    "lineNumber": 335,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 736,
    "kind": "member",
    "name": "server_port",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_port",
    "access": null,
    "description": null,
    "lineNumber": 338,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 737,
    "kind": "member",
    "name": "server_protocole",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_protocole",
    "access": null,
    "description": null,
    "lineNumber": 343,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 738,
    "kind": "member",
    "name": "server_protocole",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_protocole",
    "access": null,
    "description": null,
    "lineNumber": 346,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 739,
    "kind": "member",
    "name": "server_type",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_type",
    "access": null,
    "description": null,
    "lineNumber": 351,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 740,
    "kind": "member",
    "name": "server_type",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#server_type",
    "access": null,
    "description": null,
    "lineNumber": 354,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 741,
    "kind": "method",
    "name": "build_server",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#build_server",
    "access": null,
    "description": "Build private server instance.",
    "lineNumber": 390,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 742,
    "kind": "method",
    "name": "enable",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#enable",
    "access": null,
    "description": "Enable server (start it).",
    "lineNumber": 402,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 743,
    "kind": "member",
    "name": "is_build",
    "memberof": "js/servers/server.js~Server",
    "static": false,
    "longname": "js/servers/server.js~Server#is_build",
    "access": null,
    "description": null,
    "lineNumber": 409,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 744,
    "kind": "method",
    "name": "disable",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#disable",
    "access": null,
    "description": "Disable server (stop it).",
    "lineNumber": 448,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 745,
    "kind": "method",
    "name": "get_topology_info",
    "memberof": "js/servers/server.js~Server",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/servers/server.js~Server#get_topology_info",
    "access": null,
    "description": "Get topology item informations.",
    "lineNumber": 463,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - topology informations (plain object)."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "boolean"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_deep",
        "description": "get deep sub items information on true (default:false)."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_visited",
        "description": "visited items plain object map."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "topology informations (plain object)."
    }
  },
  {
    "__docId__": 746,
    "kind": "file",
    "name": "js/services/routes_svc_consumer.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport restify from 'restify'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\nimport ServiceConsumer from 'devapt-core-common/dist/js/services/service_consumer'\r\n\r\n// SERVER IMPORTS\r\n\r\n\r\nlet context = 'server/services/base/routes_svc_consumer'\r\n\r\n\r\n\r\n/**\r\n * Routes service consumer class for middleware routes.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class RoutesSvcConsumer extends ServiceConsumer\r\n{\r\n\t/**\r\n\t * Create a service consumer for routes.\r\n\t * @param {string} arg_consumer_name - consumer name\r\n\t * @param {Service} arg_service_instance - service instance\r\n\t * @param {string} arg_context - logging context label\r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_consumer_name, arg_service_instance, arg_context)\r\n\t{\r\n\t\tsuper(arg_consumer_name, arg_service_instance, arg_context ? arg_context : context)\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Enhance operands if needed\r\n\t * @params {array} arg_operands - Variable list of operands\r\n\t * @returns {array} - array of routes to consume\r\n\t */\r\n\tprepare_args(arg_operands)\r\n\t{\r\n\t\tthis.enter_group('prepare_args')\r\n\t\t\r\n\t\t// GET ARGS ROUTES\r\n\t\tlet routes = []\r\n\t\tif (arg_operands.length > 0)\r\n\t\t{\r\n\t\t\tfor(let key in arg_operands)\r\n\t\t\t{\r\n\t\t\t\t// console.log(key, context + ':consume.args.key')\r\n\t\t\t\tconst arg_item = arg_operands[key]\r\n\t\t\t\t// console.log(arg_item, context + ':consume.args.item')\r\n\t\t\t\tif ( T.isObject(arg_item) && T.isString(arg_item.route) )\r\n\t\t\t\t{\r\n\t\t\t\t\troutes.push(arg_item.route)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// GET DEFAULT ROUTES IF NO ARGS\r\n\t\tif (routes.length == 0)\r\n\t\t{\r\n\t\t\tconst routes_cfg = this.service.get_setting('routes').toJS()\r\n\t\t\tfor(let key in routes_cfg)\r\n\t\t\t{\r\n\t\t\t\t// console.log(key, context + ':consume.args.key')\r\n\t\t\t\tconst route_cfg = routes_cfg[key]\r\n\t\t\t\t// console.log(route_cfg, context + ':consume.args.route_cfg')\r\n\t\t\t\tif ( T.isObject(route_cfg) && T.isString(route_cfg.route) )\r\n\t\t\t\t{\r\n\t\t\t\t\troutes.push(route_cfg.route)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.info(routes, 'routes')\r\n\t\t\r\n\t\tthis.leave_group('prepare_args')\r\n\t\treturn routes\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Consume a service on the same host.\r\n\t * @param {object} arg_provider - service provider\r\n\t * @param {array} arg_routes - Routes to request\r\n\t * @return {object} a promise of results\r\n\t */\r\n\tconsume_local(arg_provider, arg_routes)\r\n\t{\r\n\t\treturn Promise.resolve(undefined)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Consume a service on a remote host.\r\n\t * \r\n\t * @param {object} arg_provider - service provider\r\n\t * @param {array} arg_routes - Routes to request\r\n\t * \r\n\t * @return {Promise} - Promise of ServiceResponse instance.\r\n\t */\r\n\tconsume_remote(arg_provider, arg_routes)\r\n\t{\r\n\t\tthis.enter_group('consume_remote')\r\n\t\t\r\n\t\t\r\n\t\tassert( T.isObject(arg_provider) && arg_provider.is_service_provider, context + ':consume_remote:bad service provider')\r\n\t\tassert( T.isArray(arg_routes), context + ':consume_remote:bad routes array')\r\n\t\t\r\n\t\tconst app_url = arg_provider.application.url\r\n\t\tconst provider_url = this.get_server_url_for(arg_provider)\r\n\t\t\r\n\t\tlet self = this\r\n\t\tlet promises = []\r\n\t\t\r\n\t\tlet get_cb = function()\r\n\t\t{\r\n\t\t\tlet client = restify.createJsonClient(\r\n\t\t\t\t{\r\n\t\t\t\t\turl: provider_url,\r\n\t\t\t\t\tversion: '~1.0'\r\n\t\t\t\t}\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\tfor(let key of arg_routes)\r\n\t\t\t{\r\n\t\t\t\tconst route = arg_routes[key]\r\n\t\t\t\tassert( T.isString(route) && route != '', context + ':consume_remote:bad route string')\r\n\t\t\t\t\r\n\t\t\t\tconst route_app_url = app_url + (route[0] == '/' ? '' : '/') + route\r\n\t\t\t\tself.info('svc consume route', route_app_url)\r\n\t\t\t\t\r\n\t\t\t\tlet route_promise = client.get(route_app_url,\r\n\t\t\t\t\tfunction (err, req, res, obj)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tassert.ifError(err)\r\n\t\t\t\t\t\tconsole.log('Server returned: %j', obj)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t\r\n\t\t\t\tpromises.push(route_promise)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn Promise.all(promises)\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tlet promise = new Promise(get_cb)\r\n\t\tthis.leave_group('consume_remote')\r\n\t\treturn promise\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/services/routes_svc_consumer.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 747,
    "kind": "variable",
    "name": "context",
    "memberof": "js/services/routes_svc_consumer.js",
    "static": true,
    "longname": "js/services/routes_svc_consumer.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/services/routes_svc_consumer.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 748,
    "kind": "class",
    "name": "RoutesSvcConsumer",
    "memberof": "js/services/routes_svc_consumer.js",
    "static": true,
    "longname": "js/services/routes_svc_consumer.js~RoutesSvcConsumer",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/services/routes_svc_consumer.js",
    "importStyle": "RoutesSvcConsumer",
    "description": "Routes service consumer class for middleware routes.",
    "lineNumber": 21,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/services/service_consumer~ServiceConsumer"
    ]
  },
  {
    "__docId__": 749,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/services/routes_svc_consumer.js~RoutesSvcConsumer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/routes_svc_consumer.js~RoutesSvcConsumer#constructor",
    "access": null,
    "description": "Create a service consumer for routes.",
    "lineNumber": 30,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_consumer_name",
        "description": "consumer name"
      },
      {
        "nullable": null,
        "types": [
          "Service"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_service_instance",
        "description": "service instance"
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "logging context label"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 750,
    "kind": "method",
    "name": "prepare_args",
    "memberof": "js/services/routes_svc_consumer.js~RoutesSvcConsumer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/routes_svc_consumer.js~RoutesSvcConsumer#prepare_args",
    "access": null,
    "description": "Enhance operands if needed",
    "lineNumber": 41,
    "unknown": [
      {
        "tagName": "@params",
        "tagValue": "{array} arg_operands - Variable list of operands"
      },
      {
        "tagName": "@returns",
        "tagValue": "{array} - array of routes to consume"
      }
    ],
    "params": [
      {
        "name": "arg_operands",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "array"
      ],
      "spread": false,
      "description": "array of routes to consume"
    }
  },
  {
    "__docId__": 751,
    "kind": "method",
    "name": "consume_local",
    "memberof": "js/services/routes_svc_consumer.js~RoutesSvcConsumer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/routes_svc_consumer.js~RoutesSvcConsumer#consume_local",
    "access": null,
    "description": "Consume a service on the same host.",
    "lineNumber": 89,
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_provider",
        "description": "service provider"
      },
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_routes",
        "description": "Routes to request"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "a promise of results"
    }
  },
  {
    "__docId__": 752,
    "kind": "method",
    "name": "consume_remote",
    "memberof": "js/services/routes_svc_consumer.js~RoutesSvcConsumer",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/routes_svc_consumer.js~RoutesSvcConsumer#consume_remote",
    "access": null,
    "description": "Consume a service on a remote host.",
    "lineNumber": 104,
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_provider",
        "description": "service provider"
      },
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_routes",
        "description": "Routes to request"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": "Promise of ServiceResponse instance."
    }
  },
  {
    "__docId__": 753,
    "kind": "file",
    "name": "js/services/uused_base/unused_service_exec_provider.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport SocketIOServiceProvider from './socketio_service_provider'\r\n\r\n\r\nlet context = 'server/services/base/service_exec_provider'\r\n\r\n\r\n\r\n/**\r\n * Service provider class for executable provider.\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class ServiceExecProvider extends SocketIOServiceProvider\r\n{\r\n\t/**\r\n\t * Create a service provider.\r\n\t * \r\n\t * @param {string} arg_provider_name - consumer name.\r\n\t * @param {Service} arg_service_instance - service instance.\r\n\t * @param {string} arg_context - logging context label.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_provider_name, arg_service_instance, arg_context)\r\n\t{\r\n\t\tsuper(arg_provider_name, arg_service_instance, arg_context ? arg_context : context)\r\n\t\t\r\n\t\tthis.is_service_exec_provider = true\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Activate a service feature for an application for a specific provider.\r\n\t * \r\n\t * @param {Application} arg_application - application instance.\r\n\t * @param {Server} arg_server - server instance to bind the service.\r\n\t * @param {object} arg_app_svc_cfg - service configuration for activation on application (unused).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tactivate_self(arg_application, arg_server, arg_app_svc_cfg)\r\n\t{\r\n\t\tassert( T.isObject(this.exec), context + ':activate_self:bad exec object')\r\n\t\t\r\n\t\tconst exec_cfg = {\r\n\t\t\t'routes':this.get_setting_js('routes'),\r\n\t\t\t'server': arg_server,\r\n\t\t\t'unused':arg_app_svc_cfg\r\n\t\t}\r\n\t\tthis.exec.prepare(exec_cfg)\r\n\t\tthis.exec.execute(arg_application)\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/services/uused_base/unused_service_exec_provider.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 754,
    "kind": "variable",
    "name": "context",
    "memberof": "js/services/uused_base/unused_service_exec_provider.js",
    "static": true,
    "longname": "js/services/uused_base/unused_service_exec_provider.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/services/uused_base/unused_service_exec_provider.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 755,
    "kind": "class",
    "name": "ServiceExecProvider",
    "memberof": "js/services/uused_base/unused_service_exec_provider.js",
    "static": true,
    "longname": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/services/uused_base/unused_service_exec_provider.js",
    "importStyle": "ServiceExecProvider",
    "description": "Service provider class for executable provider.",
    "lineNumber": 20,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "interface": false,
    "extends": [
      "js/services/uused_base/socketio_service_provider.js~SocketIOServiceProvider"
    ]
  },
  {
    "__docId__": 756,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider#constructor",
    "access": null,
    "description": "Create a service provider.",
    "lineNumber": 31,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_provider_name",
        "description": "consumer name."
      },
      {
        "nullable": null,
        "types": [
          "Service"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_service_instance",
        "description": "service instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "logging context label."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 757,
    "kind": "member",
    "name": "is_service_exec_provider",
    "memberof": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider",
    "static": false,
    "longname": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider#is_service_exec_provider",
    "access": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 758,
    "kind": "method",
    "name": "activate_self",
    "memberof": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_service_exec_provider.js~ServiceExecProvider#activate_self",
    "access": null,
    "description": "Activate a service feature for an application for a specific provider.",
    "lineNumber": 49,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "Application"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_application",
        "description": "application instance."
      },
      {
        "nullable": null,
        "types": [
          "Server"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_server",
        "description": "server instance to bind the service."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_app_svc_cfg",
        "description": "service configuration for activation on application (unused)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 759,
    "kind": "file",
    "name": "js/services/uused_base/unused_socketio_service_provider.js",
    "content": "// NPM IMPORTS\r\nimport assert from 'assert'\r\nimport Baconjs from 'baconjs'\r\n\r\n// COMMON IMPORTS\r\nimport T           from 'devapt-core-common/dist/js/utils/types'\r\nimport Credentials from 'devapt-core-common/dist/js/base/credentials'\r\nimport ServiceProvider from 'devapt-core-common/dist/js/services/service_provider'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from '../../base/runtime'\r\n\r\n\r\nlet context = 'server/services/base/socketio_service_provider'\r\n\r\n\r\n\r\n/**\r\n * Service provider base class with SocketIO provider features.\r\n * @abstract\r\n * @author Luc BORIES\r\n * @license Apache-2.0\r\n */\r\nexport default class SocketIOServiceProvider extends ServiceProvider\r\n{\r\n\t/**\r\n\t * Create a service provider.\r\n\t * \r\n\t * @param {string} arg_provider_name - consumer name.\r\n\t * @param {Service} arg_service_instance - service instance.\r\n\t * @param {string} arg_context - logging context label.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tconstructor(arg_provider_name, arg_service_instance, arg_context)\r\n\t{\r\n\t\tassert( T.isString(arg_provider_name), context + ':bad provider name string')\r\n\t\tassert( T.isObject(arg_service_instance) && arg_service_instance.is_service, context + ':bad service object')\r\n\t\t\r\n\t\tsuper(arg_provider_name, arg_service_instance, arg_context ? arg_context : context)\r\n\t\t\r\n\t\tthis.is_socketio_service_provider = true\r\n\t\t\r\n\t\tthis.subscribers_sockets = []\r\n\t\tthis.runtime = runtime\r\n\t\t\r\n\t\t// TRACE\r\n\t\t// this.enable_trace()\r\n\t\t\r\n\t\t// ACTIVATE SERVICE ON SOCKETIO SERVER FOR BROWSER REQUEST\r\n\t\tthis.activate_on_socketio_servers()\r\n\t\t\r\n\t\t\r\n\t\t// CREATE AN OUTPUT STREAM AND A TRANSFORMED OUTPUT STREAM\r\n\t\tconst self = this\r\n\t\tself.provided_values_stream = new Baconjs.Bus()\r\n\t\tif ( T.isFunction(this.init_provided_values_stream) )\r\n\t\t{\r\n\t\t\tthis.init_provided_values_stream()\r\n\t\t}\r\n\t\tconst post_cb = (v) => {\r\n\t\t\t// console.log(context + ':on stream value for provider %s',  arg_provider_name)\r\n\t\t\tself.post_provided_values_to_subscribers(v)\r\n\t\t}\r\n\t\tself.provided_values_stream.onValue(post_cb)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Post a message on the bus.\r\n\t * \r\n\t * @param {object} arg_msg - message payload.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tpost_provided_values_to_subscribers(arg_datas)\r\n\t{\r\n\t\tconst svc_name = this.service.get_name()\r\n\t\t// console.log(context + ':post:emit datas for ' + svc_name + ' with subscribers:' + this.subscribers_sockets.length)\r\n\t\tthis.subscribers_sockets.forEach(\r\n\t\t\t(socket) => {\r\n\t\t\t\t// console.log(context + ':post:emit datas for ' + svc_name)\r\n\t\t\t\tsocket.emit('post', { service:svc_name, operation:'post', result:'done', datas:arg_datas })\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Get service provider operations.\r\n\t * \r\n\t * @param {object} arg_socket - client socket.\r\n\t * \r\n\t * @returns {object} - plain object of operations as name:callback\r\n\t */\r\n\tget_io_operations(arg_socket)\r\n\t{\r\n\t\tconst self = this\r\n\t\tconst svc_name = self.service.get_name()\r\n\t\t\r\n\t\treturn {\r\n\t\t\t// SETTINGS\r\n\t\t\t'request_settings':\r\n\t\t\t\t(data, credentials) => {\r\n\t\t\t\t\tconst defined_topology = runtime.get_defined_topology()\r\n\t\t\t\t\tconst defined_svc = defined_topology.find_service_with_credentials(credentials, svc_name, 'services')\r\n\t\t\t\t\tconst svc_settings_js = defined_svc ? defined_svc.export_settings() : {}\r\n\t\t\t\t\tconst svc_browser_settings_js = svc_settings_js.browser ? svc_settings_js.browser : {}\r\n\t\t\t\t\targ_socket.emit('reply_settings', { svc: svc_name, settings:svc_browser_settings_js })\r\n\t\t\t\t},\r\n\t\t\t\r\n\t\t\t// SOCKET OPERATIONS\r\n\t\t\t'disconnect':\r\n\t\t\t\t() => {\r\n\t\t\t\t\tself.info('activate_on_socketio_server:socket disconnected from /' + svc_name)\r\n\t\t\t\t\targ_socket.emit('bye bye from /' + svc_name, { from: 'world' })\r\n\t\t\t\t},\r\n\t\t\t'end':\r\n\t\t\t\t() => {\r\n\t\t\t\t\targ_socket.disconnect(0)\r\n\t\t\t\t},\r\n\t\t\t'ping':\r\n\t\t\t\t() => {\r\n\t\t\t\t\t// console.info(context + ':activate_on_socketio_server:socket get on /' + svc_name, socket.id, data)\r\n\t\t\t\t\targ_socket.emit('pong', '/' + svc_name + '/ping response')\r\n\t\t\t\t},\r\n\t\t\t\r\n\t\t\t// SECURITY OPERATIONS\r\n\t\t\t'login':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('login', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'signup':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('signup', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'logout':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('logout', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'renew':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('renew', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'change_password':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('change_password', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'reset_password':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('reset_password', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t// SUBSCRIPTION OPERATIONS\r\n\t\t\t'subscribe':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.subscribe(arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'unsubscribe':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.unsubscribe(arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t\r\n\t\t\t// OTHERS OPERATIONS\r\n\t\t\t'get':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('get', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'render':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('render', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'list':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('list', arg_socket, data, arg_credentials)\r\n\t\t\t\t},\r\n\t\t\t'push':\r\n\t\t\t\t(data, arg_credentials) => {\r\n\t\t\t\t\tself.on_method('push', arg_socket, data, arg_credentials)\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Activate service on socketio server for browser request with messages.\r\n\t * @returns {nothing}\r\n\t */\r\n\tactivate_on_socketio_servers()\r\n\t{\r\n\t\tconst self = this\r\n\t\tconst svc_name = self.service.get_name()\r\n\t\t\r\n\t\tself.debug('activate_on_socketio_servers:svc=' + svc_name)\r\n\t\t\r\n\t\tObject.keys(runtime.socketio_servers).forEach(\r\n\t\t\t(server_name) => {\r\n\t\t\t\tconst socketio_server = runtime.socketio_servers[server_name]\r\n\t\t\t\t\r\n\t\t\t\tself.debug('activate_on_socketio_servers:svc=' + svc_name + ':server=' + server_name)\r\n\t\t\t\t\r\n\t\t\t\tself.activate_on_socketio_server(socketio_server)\r\n\t\t\t}\r\n\t\t)\r\n\t\t\r\n\t\tif ( T.isFunction(self.activate_on_socketio_servers_self) )\r\n\t\t{\r\n\t\t\tself.activate_on_socketio_servers_self()\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Activate service on one socketio server for browser request with messages.\r\n\t * \r\n\t * @param {object} arg_socketio - socketio server.\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tactivate_on_socketio_server(arg_socketio)\r\n\t{\r\n\t\tconst self = this\r\n\t\tconst svc_name = self.service.get_name()\r\n\t\tconst serverio_svc = arg_socketio.of(svc_name)\r\n\t\t\r\n\t\t// console.log(context + ':activate_on_socketio_server:svc=' + svc_name + ':socket.id=' + serverio_svc.id)\r\n\t\t\r\n\t\tserverio_svc.on('connection',\r\n\t\t\t(socket) => {\r\n\t\t\t\tself.info('activate_on_socketio_server:new connection on /' + svc_name, socket.id)\r\n\t\t\t\t\r\n\t\t\t\tconst ops = self.get_io_operations(socket)\r\n\t\t\t\tObject.keys(ops).forEach(\r\n\t\t\t\t\t(key) => {\r\n\t\t\t\t\t\tconst callback = ops[key]\r\n\t\t\t\t\t\tconst check_cb = (data) => {\r\n\t\t\t\t\t\t\t// LOGIN SPECIAL CASE: NO CREDENTIALS YET!\r\n\t\t\t\t\t\t\tconst no_credentials_ops = ['login', 'disconnect', 'end', 'ping']\r\n\t\t\t\t\t\t\tif ( no_credentials_ops.indexOf(key) > -1 )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// console.info(context + ':activate_on_socketio_server:operation %s of svc %s without credentials with data:', key, svc_name, data)\r\n\t\t\t\t\t\t\t\tcallback(data, undefined)\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// console.info(context + ':activate_on_socketio_server:operation %s indexOf:', key, no_credentials_ops.indexOf(key))\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// CHECK CREDENTIALS\r\n\t\t\t\t\t\t\tif ( ! data || ! data.credentials )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tsocket.emit(key, { service:svc_name, operation:key, result:'authorization failure' })\r\n\t\t\t\t\t\t\t\tself.error('bad credentials')\r\n\t\t\t\t\t\t\t\tconsole.error(context + ':activate_on_socketio_server:bad credentials for method %s of svc %s with data:', key, svc_name, data)\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// console.log(context + ':on: svc=%s op=%s :arg_credentials', svc_name, key, data.credentials.username)\r\n\t\t\t\t\t\t\tconst credentials = new Credentials(data.credentials)\r\n\t\t\t\t\t\t\truntime.security().authenticate(credentials)\r\n\t\t\t\t\t\t\t.then(\r\n\t\t\t\t\t\t\t\t(authenticate_result) => {\r\n\t\t\t\t\t\t\t\t\tif (authenticate_result)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tself.debug('authentication success')\r\n\t\t\t\t\t\t\t\t\t\t// console.log(context + 'authentication success')\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tconst permission = { resource:svc_name, operation:key }\r\n\t\t\t\t\t\t\t\t\t\tlet authorization_promise = runtime.security().authorize(permission, credentials)\r\n\t\t\t\t\t\t\t\t\t\treturn authorization_promise.then(\r\n\t\t\t\t\t\t\t\t\t\t\t(authorize_result) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// console.log(context + ':authorize_result', authorize_result)\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (authorize_result)\r\n\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tself.debug('authorization success')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(context + ':authorization success')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcallback(data, credentials)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tself.debug('authorization failure')\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(context + ':authorization failure')\r\n\t\t\t\t\t\t\t\t\t\t\t\tsocket.emit(key, { service:svc_name, operation:key, result:'authorization failure' })\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t.catch(\r\n\t\t\t\t\t\t\t\t\t\t\t(reason) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tself.debug('authorization error:' + reason)\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(context + ':authorization error:' + reason)\r\n\t\t\t\t\t\t\t\t\t\t\t\tsocket.emit(key, { service:svc_name, operation:key, result:'authorization error'} )\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tself.debug('authentication failure')\r\n\t\t\t\t\t\t\t\t\tconsole.log(context + 'authentication failure')\r\n\t\t\t\t\t\t\t\t\tsocket.emit(key, { service:svc_name, operation:key, result:'authentication failure' })\r\n\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.catch(\r\n\t\t\t\t\t\t\t\t(reason) => {\r\n\t\t\t\t\t\t\t\t\tself.debug('authentication error:' + reason) // TODO NOT ONLY AUTHORIZ. ERROR\r\n\t\t\t\t\t\t\t\t\tconsole.log(context + 'authentication error:' + reason)\r\n\t\t\t\t\t\t\t\t\tsocket.emit(key, { service:svc_name, operation:key, result:'authentication error'} )\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsocket.on(key, check_cb)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t\r\n\t\t\t\tif ( T.isFunction(self.activate_on_socketio_server_self) )\r\n\t\t\t\t{\r\n\t\t\t\t\tself.activate_on_socketio_server_self(arg_socketio, socket)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Add a subscriber socket.\r\n\t * \r\n\t * @param {object} arg_socket - subscribing socket.\r\n\t * @param {object} arg_data - subscribing filter or datas (optional).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tsubscribe(arg_socket/*, arg_data*/)\r\n\t{\r\n\t\tconst svc_name = this.service.get_name()\r\n\t\t// console.info(context + ':subscribe:socket subscribe on /' + svc_name, arg_socket.id)\r\n\t\t\r\n\t\tthis.subscribers_sockets.push(arg_socket)\r\n\t\targ_socket.emit('subscribe', { service:svc_name, operation:'subscribe', result:'done' })\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Remove a subscriber socket.\r\n\t * \r\n\t * @param {object} arg_socket - subscribing socket.\r\n\t * @param {object} arg_data - subscribing filter or datas (optional).\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\tunsubscribe(arg_socket, arg_data)\r\n\t{\r\n\t\tconst svc_name = this.service.get_name()\r\n\t\tself.error(context + ':unsubscribe:not yet implemented on /' + svc_name, arg_socket.id, arg_data)\r\n\t\t\r\n\t\targ_socket.emit('unsubscribe', { service:svc_name, operation:'unsubscribe', result:'not implemented' })\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Get operation handler on socket.\r\n\t * \r\n\t * @param {string} arg_method - method name\r\n\t * @param {object} arg_socket - subscribing socket.\r\n\t * @param {object} arg_data - query filter or datas (optional).\r\n\t * @param {Credentials} arg_credentials - request credentials\r\n\t * \r\n\t * @returns {nothing}\r\n\t */\r\n\ton_method(arg_method, arg_socket, arg_data, arg_credentials)\r\n\t{\r\n\t\tconst svc_name = this.service.get_name()\r\n\t\t// console.info(context + ':on_get:socket get on /' + svc_name, arg_socket.id, arg_data)\r\n\t\t\r\n\t\t// CHECK REQUEST\r\n\t\tif ( ! T.isObject(arg_data) || ! T.isObject(arg_data.request) || ! T.isArray(arg_data.request.operands))\r\n\t\t{\r\n\t\t\treturn Promise.reject('bad data request')\r\n\t\t}\r\n\t\t\r\n\t\t// PROCESS REQUEST\r\n\t\tconst datas_promise = this.process(arg_method, arg_data.request.operands, arg_credentials)\r\n\t\tdatas_promise.then(\r\n\t\t\t(produced_datas) => {\r\n\t\t\t\targ_socket.emit(arg_method, { 'service':svc_name, 'operation':arg_method, 'result':'done', 'datas':produced_datas })\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t(reason) => {\r\n\t\t\t\targ_socket.emit(arg_method, { 'service':svc_name, 'operation':arg_method, 'result':'error', 'datas':reason })\r\n\t\t\t}\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t/**\r\n\t * Process request and returns datas.\r\n\t * @abstract\r\n\t * \r\n\t * @param {string} arg_method - method name\r\n\t * @param {array} arg_operands - request operands\r\n\t * @param {Credentials} arg_credentials - request credentials\r\n\t * \r\n\t * @returns {Promise}\r\n\t */\r\n\tprocess(/*arg_method, arg_operands, arg_credentials*/)\r\n\t{\r\n\t\treturn Promise.reject('not yet implemented')\r\n\t}\r\n}\r\n",
    "static": true,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 760,
    "kind": "variable",
    "name": "context",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js",
    "static": true,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~context",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/services/uused_base/unused_socketio_service_provider.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "string"
      ]
    }
  },
  {
    "__docId__": 761,
    "kind": "class",
    "name": "SocketIOServiceProvider",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js",
    "static": true,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "access": null,
    "export": true,
    "importPath": "devapt-core-doc/js/services/uused_base/unused_socketio_service_provider.js",
    "importStyle": "SocketIOServiceProvider",
    "description": "Service provider base class with SocketIO provider features.",
    "lineNumber": 24,
    "unknown": [
      {
        "tagName": "@author",
        "tagValue": "Luc BORIES"
      },
      {
        "tagName": "@license",
        "tagValue": "Apache-2.0"
      }
    ],
    "abstract": true,
    "interface": false,
    "extends": [
      "devapt-core-common/dist/js/services/service_provider~ServiceProvider"
    ]
  },
  {
    "__docId__": 762,
    "kind": "constructor",
    "name": "constructor",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#constructor",
    "access": null,
    "description": "Create a service provider.",
    "lineNumber": 35,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_provider_name",
        "description": "consumer name."
      },
      {
        "nullable": null,
        "types": [
          "Service"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_service_instance",
        "description": "service instance."
      },
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_context",
        "description": "logging context label."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 763,
    "kind": "member",
    "name": "is_socketio_service_provider",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#is_socketio_service_provider",
    "access": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 764,
    "kind": "member",
    "name": "subscribers_sockets",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#subscribers_sockets",
    "access": null,
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*[]"
      ]
    }
  },
  {
    "__docId__": 765,
    "kind": "member",
    "name": "runtime",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#runtime",
    "access": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 766,
    "kind": "method",
    "name": "post_provided_values_to_subscribers",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#post_provided_values_to_subscribers",
    "access": null,
    "description": "Post a message on the bus.",
    "lineNumber": 77,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_msg",
        "description": "message payload."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 767,
    "kind": "method",
    "name": "get_io_operations",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#get_io_operations",
    "access": null,
    "description": "Get service provider operations.",
    "lineNumber": 98,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - plain object of operations as name:callback"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socket",
        "description": "client socket."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "plain object of operations as name:callback"
    }
  },
  {
    "__docId__": 768,
    "kind": "method",
    "name": "activate_on_socketio_servers",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#activate_on_socketio_servers",
    "access": null,
    "description": "Activate service on socketio server for browser request with messages.",
    "lineNumber": 191,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 769,
    "kind": "method",
    "name": "activate_on_socketio_server",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#activate_on_socketio_server",
    "access": null,
    "description": "Activate service on one socketio server for browser request with messages.",
    "lineNumber": 222,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socketio",
        "description": "socketio server."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 770,
    "kind": "method",
    "name": "subscribe",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#subscribe",
    "access": null,
    "description": "Add a subscriber socket.",
    "lineNumber": 334,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socket",
        "description": "subscribing socket."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "subscribing filter or datas (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 771,
    "kind": "method",
    "name": "unsubscribe",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#unsubscribe",
    "access": null,
    "description": "Remove a subscriber socket.",
    "lineNumber": 353,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socket",
        "description": "subscribing socket."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "subscribing filter or datas (optional)."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 772,
    "kind": "method",
    "name": "on_method",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#on_method",
    "access": null,
    "description": "Get operation handler on socket.",
    "lineNumber": 373,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_method",
        "description": "method name"
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_socket",
        "description": "subscribing socket."
      },
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_data",
        "description": "query filter or datas (optional)."
      },
      {
        "nullable": null,
        "types": [
          "Credentials"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 773,
    "kind": "method",
    "name": "process",
    "memberof": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider",
    "generator": false,
    "async": false,
    "static": false,
    "longname": "js/services/uused_base/unused_socketio_service_provider.js~SocketIOServiceProvider#process",
    "access": null,
    "description": "Process request and returns datas.",
    "lineNumber": 409,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{Promise}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_method",
        "description": "method name"
      },
      {
        "nullable": null,
        "types": [
          "array"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_operands",
        "description": "request operands"
      },
      {
        "nullable": null,
        "types": [
          "Credentials"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_credentials",
        "description": "request credentials"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "Promise"
      ],
      "spread": false,
      "description": ""
    },
    "abstract": true
  },
  {
    "__docId__": 774,
    "kind": "file",
    "name": "js/start_node.js",
    "content": "\r\n// NPM IMPORTS\r\nimport path from 'path'\r\nimport chokidar from 'chokidar'\r\nimport commander from 'commander'\r\n\r\n// COMMON IMPORTS\r\nimport T from 'devapt-core-common/dist/js/utils/types'\r\n\r\n// SERVER IMPORTS\r\nimport runtime from './base/runtime'\r\n\r\n\r\n// POLYFILLS FOR NODE 0.10\r\n// require('../common/utils/es5-compat.js')\r\n\r\n\r\n\r\nfunction parse_files_list(list)\r\n{\r\n\treturn list.split(',')\r\n}\r\n\r\ncommander\r\n\t.version('1.0.0')\r\n\t.option('-n --node-name <node name>', 'topology node name')\r\n\t.option('-w --watch-files [files]', 'files list to watch:file1,../abc/file2,...', parse_files_list)\r\n\t.option('-b --base-directory [application base directory]', 'topology startup resources directory', path.join(__dirname, '..'))\r\n\t.option('-t --topology-directory [topology resources directory]', 'topology startup resources directory', '../')\r\n\t.option('-s --servers-bindings [servers bindings string]', 'Bindings between real ip/port and a node server. node:server:ip:port|node:server:ip:port...')\r\n\t.parse(process.argv)\r\n\r\n\r\n\r\nconst root_dir = process.env.OPENSHIFT_REPO_DIR ? process.env.OPENSHIFT_REPO_DIR : process.cwd()\r\nconst topology_dir = root_dir ? path.join(root_dir, commander.topologyDirectory) : commander.topologyDirectory\r\n\r\n\r\nconst DEVAPT_NODE_NAME = commander.nodeName\r\nconst DEVAPT_NODE_CFG = path.join(topology_dir, '../nodes', DEVAPT_NODE_NAME + '.json')\r\n\r\n\r\n// DEBUG\r\n// console.log(process.env, 'process.env')\r\n// console.log(process.env.OPENSHIFT_HOMEDIR, 'process.env.OPENSHIFT_HOMEDIR')\r\n// console.log(root_dir, 'root_dir')\r\n// console.log(process.env.OPENSHIFT_NODEJS_IP, 'process.env.OPENSHIFT_NODEJS_IP')\r\n// console.log(process.env.OPENSHIFT_NODEJS_PORT, 'process.env.OPENSHIFT_NODEJS_PORT')\r\n// console.log(commander.nodeName, 'commander.nodeName')\r\n// console.log(commander.resourcesDirectory, 'commander.resourcesDirectory')\r\n// console.log(DEVAPT_NODE_CFG, 'DEVAPT_NODE_CFG')\r\n\r\n\r\n// CHECK NODE NAME\r\nif (!DEVAPT_NODE_NAME)\r\n{\r\n\tconsole.log('no given node name!')\r\n\tprocess.exit()\r\n}\r\n\r\n\r\nconst runtime_settings = require(DEVAPT_NODE_CFG)\r\nruntime_settings.base_dir = root_dir ? path.join(root_dir, commander.baseDirectory) : commander.baseDirectory\r\nruntime_settings.world_dir = topology_dir\r\nruntime_settings.is_master = true\r\nruntime_settings.servers_bindings = undefined\r\nif (commander.serversBindings)\r\n{\r\n\truntime_settings.servers_bindings = []\r\n\tconst bindings = commander.serversBindings.split('|')\r\n\tbindings.forEach(\r\n\t\t(binding) => {\r\n\t\t\tlet parts = binding.split(':')\r\n\t\t\tif (parts.length == 2 && process.env.OPENSHIFT_NODEJS_IP && process.env.OPENSHIFT_NODEJS_PORT)\r\n\t\t\t{\r\n\t\t\t\tparts.push(process.env.OPENSHIFT_NODEJS_IP)\r\n\t\t\t\tparts.push(process.env.OPENSHIFT_NODEJS_PORT)\r\n\t\t\t}\r\n\t\t\tif (parts.length == 3 && process.env.OPENSHIFT_NODEJS_PORT)\r\n\t\t\t{\r\n\t\t\t\tparts.push(process.env.OPENSHIFT_NODEJS_PORT)\r\n\t\t\t}\r\n\t\t\tif (parts.length == 4)\r\n\t\t\t{\r\n\t\t\t\tconst binding_record = {\r\n\t\t\t\t\tnode:parts[0],\r\n\t\t\t\t\tserver:parts[1],\r\n\t\t\t\t\thost:parts[2],\r\n\t\t\t\t\tport:parts[3]\r\n\t\t\t\t}\r\n\t\t\t\truntime_settings.servers_bindings.push(binding_record)\r\n\t\t\t}\r\n\t\t}\r\n\t)\r\n}\r\n\r\n\r\nconst DEBUG = false\r\n\r\n\r\n// LOAD RUNTIME AND PLUGINS\r\nruntime.load(runtime_settings)\r\n.then(\r\n\t(result) => {\r\n\t\tif (result)\r\n\t\t{\r\n\t\t\tif ( DEBUG && T.isArray(commander.watchFiles) && commander.watchFiles.length > 0 )\r\n\t\t\t{\r\n\t\t\t\t// WATCH SRC FILES AND RELOAD\r\n\t\t\t\tcommander.watchFiles.forEach(\r\n\t\t\t\t\tfunction(file)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tconst path_file = path.join(__dirname, file)\r\n\t\t\t\t\t\twatch(path_file)\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log('runtime.load failure', result)\r\n\t},\r\n\t\r\n\t(reason) => {\r\n\t\tconsole.log('runtime.load failure for ', reason)\r\n\t}\r\n)\r\n.catch(\r\n\t(e) => {\r\n\t\tconsole.log('runtime.load exception with ', e)\r\n\t}\r\n)\r\n\r\n\r\n\t\r\n/**\r\n * Reload a file.\r\n * \r\n * @param {string} arg_file_path - file path name.\r\n * \r\n * @returns {nothing}\r\n */\r\nfunction reload_file(arg_file_path)\r\n{\r\n\tconst file_name = path.basename(arg_file_path)\r\n\tconst this_file_name = path.basename(__filename)\r\n\tif (file_name == this_file_name)\r\n\t{\r\n\t\tconsole.info('Need to reload after change on ' + this_file_name)\r\n\t\treturn\r\n\t}\r\n\t\r\n\tconst exts = ['.js', '.json']\r\n\tconst ext = path.extname(arg_file_path)\r\n\tconst full_path = path.resolve(arg_file_path)\r\n\t\r\n\tif ((exts.indexOf(ext) > -1) && (full_path in require.cache))\r\n\t{\r\n\t\tconsole.info('Reloading: ' + full_path)\r\n\t\t// console.log(require.cache[full_path].parent.children[0])\r\n\t\t\r\n\t\tdelete require.cache[full_path]\r\n\t\trequire(full_path)\r\n\t}\r\n}\r\n\r\n\r\n\r\n/**\r\n * Watch directory files.\r\n * \r\n * @param {string} arg_src_dir - source directory.\r\n * \r\n * @returns {object} - watcher object.\r\n */\r\nfunction watch(arg_src_dir)\r\n{\r\n\tconsole.info('Watching for change on: ' + arg_src_dir)\r\n\t\r\n\tconst watch_settings = { ignored: /[\\/\\\\]\\./, persistent: true }\r\n\tvar watcher = chokidar.watch(arg_src_dir, watch_settings)\r\n\twatcher.on('change', reload_file)\r\n\t\r\n\treturn watcher\r\n}\r\n\r\n\r\n\r\n/**\r\n * Stop watching files.\r\n * @param {object} - watcher object\r\n * @returns {nothing}\r\n */\r\nfunction unwatch(arg_watcher)\r\n{\r\n\targ_watcher.close()\r\n}\r\n\r\n\r\n\r\nprocess.on('exit',\r\n\t(code) => {\r\n\t\tconsole.log('About to exit with code:', code)\r\n\t}\r\n)\r\n\r\n\r\n\r\nprocess.on('SIGTERM',\r\n\tfunction()\r\n\t{\r\n\t\tunwatch()\r\n\t\tprocess.exit()\r\n\t}\r\n)\r\n\r\n\r\n\r\nprocess.on('unhandledRejection',\r\n\t(reason, p) => {\r\n\t\tconsole.log('Unhandled Rejection at: Promise ', p, ' reason: ', reason)\r\n\t}\r\n)\r\n\r\n\r\n\r\nprocess.on('uncaughtException',\r\n\t(err) => {\r\n\t\tconsole.log(`Caught exception: ${err}`)\r\n\t}\r\n)",
    "static": true,
    "longname": "js/start_node.js",
    "access": null,
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 775,
    "kind": "function",
    "name": "parse_files_list",
    "memberof": "js/start_node.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "js/start_node.js~parse_files_list",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 19,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "params": [
      {
        "name": "list",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 776,
    "kind": "variable",
    "name": "root_dir",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~root_dir",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 777,
    "kind": "variable",
    "name": "topology_dir",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~topology_dir",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 778,
    "kind": "variable",
    "name": "DEVAPT_NODE_NAME",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~DEVAPT_NODE_NAME",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 779,
    "kind": "variable",
    "name": "DEVAPT_NODE_CFG",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~DEVAPT_NODE_CFG",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 780,
    "kind": "variable",
    "name": "runtime_settings",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~runtime_settings",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 62,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 781,
    "kind": "variable",
    "name": "DEBUG",
    "memberof": "js/start_node.js",
    "static": true,
    "longname": "js/start_node.js~DEBUG",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 98,
    "undocument": true,
    "unknown": [
      {
        "tagName": "@_undocument",
        "tagValue": ""
      }
    ],
    "type": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 782,
    "kind": "function",
    "name": "reload_file",
    "memberof": "js/start_node.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "js/start_node.js~reload_file",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": "Reload a file.",
    "lineNumber": 144,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_file_path",
        "description": "file path name."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 783,
    "kind": "function",
    "name": "watch",
    "memberof": "js/start_node.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "js/start_node.js~watch",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": "Watch directory files.",
    "lineNumber": 177,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{object} - watcher object."
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "string"
        ],
        "spread": false,
        "optional": false,
        "name": "arg_src_dir",
        "description": "source directory."
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "object"
      ],
      "spread": false,
      "description": "watcher object."
    }
  },
  {
    "__docId__": 784,
    "kind": "function",
    "name": "unwatch",
    "memberof": "js/start_node.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "js/start_node.js~unwatch",
    "access": null,
    "export": false,
    "importPath": "devapt-core-doc/js/start_node.js",
    "importStyle": null,
    "description": "Stop watching files.",
    "lineNumber": 195,
    "unknown": [
      {
        "tagName": "@returns",
        "tagValue": "{nothing}"
      }
    ],
    "params": [
      {
        "nullable": null,
        "types": [
          "object"
        ],
        "spread": false,
        "optional": false,
        "name": "-",
        "description": "watcher object"
      }
    ],
    "return": {
      "nullable": null,
      "types": [
        "nothing"
      ],
      "spread": false,
      "description": ""
    }
  },
  {
    "__docId__": 786,
    "kind": "external",
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Infinity",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 787,
    "kind": "external",
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~NaN",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 788,
    "kind": "external",
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~undefined",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 789,
    "kind": "external",
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~null",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 790,
    "kind": "external",
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Object",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 791,
    "kind": "external",
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~object",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 792,
    "kind": "external",
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Function",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 793,
    "kind": "external",
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~function",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 794,
    "kind": "external",
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Boolean",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 795,
    "kind": "external",
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~boolean",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 796,
    "kind": "external",
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Symbol",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 797,
    "kind": "external",
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Error",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 798,
    "kind": "external",
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~EvalError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 799,
    "kind": "external",
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~InternalError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 800,
    "kind": "external",
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RangeError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 801,
    "kind": "external",
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ReferenceError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 802,
    "kind": "external",
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~SyntaxError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 803,
    "kind": "external",
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~TypeError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 804,
    "kind": "external",
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~URIError",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 805,
    "kind": "external",
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Number",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 806,
    "kind": "external",
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~number",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 807,
    "kind": "external",
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Date",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 808,
    "kind": "external",
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~String",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 809,
    "kind": "external",
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~string",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 810,
    "kind": "external",
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~RegExp",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 811,
    "kind": "external",
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 812,
    "kind": "external",
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int8Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 813,
    "kind": "external",
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 814,
    "kind": "external",
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint8ClampedArray",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 815,
    "kind": "external",
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int16Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 816,
    "kind": "external",
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint16Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 817,
    "kind": "external",
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Int32Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 818,
    "kind": "external",
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Uint32Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 819,
    "kind": "external",
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float32Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 820,
    "kind": "external",
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Float64Array",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 821,
    "kind": "external",
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Map",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 822,
    "kind": "external",
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Set",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 823,
    "kind": "external",
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakMap",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 824,
    "kind": "external",
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~WeakSet",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 825,
    "kind": "external",
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~ArrayBuffer",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 826,
    "kind": "external",
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~DataView",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 827,
    "kind": "external",
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~JSON",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 828,
    "kind": "external",
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Promise",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 829,
    "kind": "external",
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Generator",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 830,
    "kind": "external",
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~GeneratorFunction",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 831,
    "kind": "external",
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Reflect",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 832,
    "kind": "external",
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "BuiltinExternal/ECMAScriptExternal.js",
    "static": true,
    "longname": "BuiltinExternal/ECMAScriptExternal.js~Proxy",
    "access": null,
    "description": "",
    "lineNumber": 193,
    "builtinExternal": true
  },
  {
    "__docId__": 834,
    "kind": "external",
    "name": "CanvasRenderingContext2D",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~CanvasRenderingContext2D",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 835,
    "kind": "external",
    "name": "DocumentFragment",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~DocumentFragment",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 836,
    "kind": "external",
    "name": "Element",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Element",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~Element",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 837,
    "kind": "external",
    "name": "Event",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Event",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~Event",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 838,
    "kind": "external",
    "name": "Node",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/Node",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~Node",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 839,
    "kind": "external",
    "name": "NodeList",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/API/NodeList",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~NodeList",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 840,
    "kind": "external",
    "name": "XMLHttpRequest",
    "externalLink": "https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~XMLHttpRequest",
    "access": null,
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 841,
    "kind": "external",
    "name": "AudioContext",
    "externalLink": "https://developer.mozilla.org/en/docs/Web/API/AudioContext",
    "memberof": "BuiltinExternal/WebAPIExternal.js",
    "static": true,
    "longname": "BuiltinExternal/WebAPIExternal.js~AudioContext",
    "access": null,
    "description": "",
    "lineNumber": 34,
    "builtinExternal": true
  }
]